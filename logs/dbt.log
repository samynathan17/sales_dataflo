2020-12-30 17:59:41.570002 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 36 at position 12 unexpected 'UNION'.
  syntax error line 39 at position 0 unexpected 'WITH'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 36 at position 12 unexpected 'UNION'.
syntax error line 39 at position 0 unexpected 'WITH'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 36 at position 12 unexpected 'UNION'.
  syntax error line 39 at position 0 unexpected 'WITH'.
2020-12-30 17:59:41.571470 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 36 at position 12 unexpected 'UNION'.\n  syntax error line 39 at position 0 unexpected 'WITH'.", 'raw_sql': '{% set results = dbt_utils.get_column_values(ref(\'Dim_Entity\'),\'entity_name\') %}\r\n\r\n{% if not var("enable_SF_source") %}\r\n{{\r\n    config(\r\n        enabled=false\r\n    )\r\n}}\r\n{% endif %}\r\n\r\n{{\r\n    config(\r\n        materialized=\'incremental\',\r\n        unique_key= \'Account_ID\'\r\n      )\r\n}}\r\n\r\n{% for V_SF_Schema in results %}\r\n      {% if not loop.first %}\r\n            UNION ALL\r\n        {% endif %}\r\n\r\nWITH source AS\r\n (\r\n select * from {{ V_SF_Schema }}.Account\r\n  ),\r\nDIM_ACCOUNT as (\r\n      select\r\n        {{ dbt_utils.surrogate_key(\'id\') }}  AS Account_ID,\r\n        NAME AS Account_Name,\r\n        TYPE AS Account_Type,\r\n        ID AS Source_ID,\r\n        IS_DELETED AS Active_Flag,\r\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\r\n        INDUSTRY AS INDUSTRY,\r\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\r\n        OWNER_ID AS Employee_ID,\r\n        CREATED_DATE as INITIAL_CREATE_DT,\r\n        {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n        \'D_ACCOUNT_DIM_LOAD\' AS DW_SESSION_NM,\r\n        {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n    FROM source\r\n    )\r\n    {% endfor %}\r\n\r\nselect * from DIM_ACCOUNT\r\n\r\n\nlimit 100', 'compiled_sql': "\n\n\n\n\n\n\n      \n\nWITH source AS\n (\n select * from DBT_TEST_LIVEDATA_RK.Account\n  ),\nDIM_ACCOUNT as (\n      select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n    )\n    \n      \n            UNION ALL\n        \n\nWITH source AS\n (\n select * from SALESFORCE_FREETRAILS.Account\n  ),\nDIM_ACCOUNT as (\n      select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n    )\n    \n\nselect * from DIM_ACCOUNT\n\n\nlimit 100", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 36 at position 12 unexpected 'UNION'.\n  syntax error line 39 at position 0 unexpected 'WITH'.", 'raw_sql': '{% set results = dbt_utils.get_column_values(ref(\'Dim_Entity\'),\'entity_name\') %}\r\n\r\n{% if not var("enable_SF_source") %}\r\n{{\r\n    config(\r\n        enabled=false\r\n    )\r\n}}\r\n{% endif %}\r\n\r\n{{\r\n    config(\r\n        materialized=\'incremental\',\r\n        unique_key= \'Account_ID\'\r\n      )\r\n}}\r\n\r\n{% for V_SF_Schema in results %}\r\n      {% if not loop.first %}\r\n            UNION ALL\r\n        {% endif %}\r\n\r\nWITH source AS\r\n (\r\n select * from {{ V_SF_Schema }}.Account\r\n  ),\r\nDIM_ACCOUNT as (\r\n      select\r\n        {{ dbt_utils.surrogate_key(\'id\') }}  AS Account_ID,\r\n        NAME AS Account_Name,\r\n        TYPE AS Account_Type,\r\n        ID AS Source_ID,\r\n        IS_DELETED AS Active_Flag,\r\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\r\n        INDUSTRY AS INDUSTRY,\r\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\r\n        OWNER_ID AS Employee_ID,\r\n        CREATED_DATE as INITIAL_CREATE_DT,\r\n        {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n        \'D_ACCOUNT_DIM_LOAD\' AS DW_SESSION_NM,\r\n        {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n    FROM source\r\n    )\r\n    {% endfor %}\r\n\r\nselect * from DIM_ACCOUNT\r\n\r\n\nlimit 100', 'compiled_sql': "\n\n\n\n\n\n\n      \n\nWITH source AS\n (\n select * from DBT_TEST_LIVEDATA_RK.Account\n  ),\nDIM_ACCOUNT as (\n      select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n    )\n    \n      \n            UNION ALL\n        \n\nWITH source AS\n (\n select * from SALESFORCE_FREETRAILS.Account\n  ),\nDIM_ACCOUNT as (\n      select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n    )\n    \n\nselect * from DIM_ACCOUNT\n\n\nlimit 100", 'tags': None}, None)
2020-12-30 17:59:42.114741 (Thread-1103): handling poll request
2020-12-30 17:59:42.115169 (Thread-1103): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5ef4310>]}
2020-12-30 17:59:42.116201 (Thread-1103): sending response (<Response 26323 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:00:47.588944 (Thread-1104): handling status request
2020-12-30 18:00:47.591268 (Thread-1104): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5ef4eb0>]}
2020-12-30 18:00:47.592212 (Thread-1104): sending response (<Response 931 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:00:48.093939 (Thread-1105): handling compile_sql request
2020-12-30 18:00:48.094368 (Thread-1105): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5ef4a00>]}
2020-12-30 18:00:49.138640 (Thread-1105): sending response (<Response 137 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:00:49.159318 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:00:49.195555 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:00:49.196031 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:00:49.196143 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:00:49.213909 (Thread-1): On "rpc.sales_dataflo.request": cache miss for schema "DATAFLOTEST_DATABASE.dbt_salesdataflo", this is inefficient
2020-12-30 18:00:49.648509 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:00:49.648633 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:00:49.648695 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:00:49.720097 (Thread-1106): handling poll request
2020-12-30 18:00:49.720553 (Thread-1106): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5efb430>]}
2020-12-30 18:00:49.722690 (Thread-1106): sending response (<Response 2985 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:00:50.332975 (Thread-1): SQL status: SUCCESS 26 in 0.68 seconds
2020-12-30 18:00:50.356124 (Thread-1): with database=DATAFLOTEST_DATABASE, schema=dbt_salesdataflo, relations=[<SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CALENDAR">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS_CATEGORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_TIMEFRAME">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_TIMEFRAME">]
2020-12-30 18:00:50.357018 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:00:50.357229 (Thread-1): On rpc.sales_dataflo.request: BEGIN
2020-12-30 18:00:50.429914 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:00:50.430048 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:00:50.430098 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:00:50.550300 (Thread-1): SQL status: SUCCESS 2 in 0.12 seconds
2020-12-30 18:00:50.557709 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:00:50.573411 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:00:50.575710 (Thread-1): finished collecting timing info
2020-12-30 18:00:50.575970 (Thread-1): finished collecting timing info
2020-12-30 18:00:50.576139 (Thread-1): On rpc.sales_dataflo.request: ROLLBACK
2020-12-30 18:00:50.705004 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-30 18:00:51.203816 (Thread-1107): handling poll request
2020-12-30 18:00:51.204241 (Thread-1107): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5efb370>]}
2020-12-30 18:00:51.209374 (Thread-1107): sending response (<Response 16321 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:04:01.847612 (Thread-1108): handling status request
2020-12-30 18:04:01.849763 (Thread-1108): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5efbe20>]}
2020-12-30 18:04:01.851209 (Thread-1108): sending response (<Response 931 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:04:02.346103 (Thread-1109): handling run_sql request
2020-12-30 18:04:02.346695 (Thread-1109): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5efb4f0>]}
2020-12-30 18:04:04.059069 (Thread-1109): sending response (<Response 137 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:04:04.088673 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:04:04.155805 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:04:04.156451 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:04:04.156584 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:04:04.186892 (Thread-1): On "rpc.sales_dataflo.request": cache miss for schema "DATAFLOTEST_DATABASE.dbt_salesdataflo", this is inefficient
2020-12-30 18:04:04.681629 (Thread-1110): handling poll request
2020-12-30 18:04:04.682274 (Thread-1110): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5ef5550>]}
2020-12-30 18:04:04.684994 (Thread-1110): sending response (<Response 1935 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:04:04.683595 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:04:04.683771 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:04:04.683870 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:04:05.584554 (Thread-1): SQL status: SUCCESS 26 in 0.90 seconds
2020-12-30 18:04:05.626840 (Thread-1): with database=DATAFLOTEST_DATABASE, schema=dbt_salesdataflo, relations=[<SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CALENDAR">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS_CATEGORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_TIMEFRAME">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_TIMEFRAME">]
2020-12-30 18:04:05.628169 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:04:05.628300 (Thread-1): On rpc.sales_dataflo.request: BEGIN
2020-12-30 18:04:05.715660 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2020-12-30 18:04:05.715807 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:04:05.715856 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:04:05.990241 (Thread-1): SQL status: SUCCESS 2 in 0.27 seconds
2020-12-30 18:04:06.002285 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:04:06.024542 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:04:06.028198 (Thread-1): finished collecting timing info
2020-12-30 18:04:06.031041 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:04:06.031186 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */







      

WITH source AS
 (
 select * from DBT_TEST_LIVEDATA_RK.Account
  ),
DIM_ACCOUNT as (
      select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
          'SF'  as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM source
    )
    select * from DIM_ACCOUNT
    
      
            UNION ALL
        

WITH source AS
 (
 select * from SALESFORCE_FREETRAILS.Account
  ),
DIM_ACCOUNT as (
      select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
          'SF'  as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM source
    )
    select * from DIM_ACCOUNT
    

select * from DIM_ACCOUNT


limit 100
2020-12-30 18:04:06.116337 (Thread-1): Snowflake query id: 0199477c-007c-68da-0000-5eb10010440a
2020-12-30 18:04:06.116495 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 40 at position 0 unexpected 'WITH'.
2020-12-30 18:04:06.116626 (Thread-1): finished collecting timing info
2020-12-30 18:04:06.116979 (Thread-1): On rpc.sales_dataflo.request: ROLLBACK
2020-12-30 18:04:06.246352 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-30 18:04:06.256793 (Thread-1111): handling poll request
2020-12-30 18:04:06.257353 (Thread-1111): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5ef5910>]}
2020-12-30 18:04:06.261290 (Thread-1111): sending response (<Response 11500 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:04:06.324284 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 0 unexpected 'WITH'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 40 at position 0 unexpected 'WITH'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 0 unexpected 'WITH'.
2020-12-30 18:04:06.326567 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 40 at position 0 unexpected 'WITH'.", 'raw_sql': '{% set results = dbt_utils.get_column_values(ref(\'Dim_Entity\'),\'entity_name\') %}\r\n\r\n{% if not var("enable_SF_source") %}\r\n{{\r\n    config(\r\n        enabled=false\r\n    )\r\n}}\r\n{% endif %}\r\n\r\n{{\r\n    config(\r\n        materialized=\'incremental\',\r\n        unique_key= \'Account_ID\'\r\n      )\r\n}}\r\n\r\n{% for V_SF_Schema in results %}\r\n      {% if not loop.first %}\r\n            UNION ALL\r\n        {% endif %}\r\n\r\nWITH source AS\r\n (\r\n select * from {{ V_SF_Schema }}.Account\r\n  ),\r\nDIM_ACCOUNT as (\r\n      select\r\n        {{ dbt_utils.surrogate_key(\'id\') }}  AS Account_ID,\r\n        NAME AS Account_Name,\r\n        TYPE AS Account_Type,\r\n        ID AS Source_ID,\r\n        IS_DELETED AS Active_Flag,\r\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\r\n        INDUSTRY AS INDUSTRY,\r\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\r\n        OWNER_ID AS Employee_ID,\r\n        CREATED_DATE as INITIAL_CREATE_DT,\r\n        {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n        \'D_ACCOUNT_DIM_LOAD\' AS DW_SESSION_NM,\r\n        {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n    FROM source\r\n    )\r\n    select * from DIM_ACCOUNT\r\n    {% endfor %}\r\n\r\nselect * from DIM_ACCOUNT\r\n\r\n\nlimit 100', 'compiled_sql': "\n\n\n\n\n\n\n      \n\nWITH source AS\n (\n select * from DBT_TEST_LIVEDATA_RK.Account\n  ),\nDIM_ACCOUNT as (\n      select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n    )\n    select * from DIM_ACCOUNT\n    \n      \n            UNION ALL\n        \n\nWITH source AS\n (\n select * from SALESFORCE_FREETRAILS.Account\n  ),\nDIM_ACCOUNT as (\n      select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n    )\n    select * from DIM_ACCOUNT\n    \n\nselect * from DIM_ACCOUNT\n\n\nlimit 100", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 40 at position 0 unexpected 'WITH'.", 'raw_sql': '{% set results = dbt_utils.get_column_values(ref(\'Dim_Entity\'),\'entity_name\') %}\r\n\r\n{% if not var("enable_SF_source") %}\r\n{{\r\n    config(\r\n        enabled=false\r\n    )\r\n}}\r\n{% endif %}\r\n\r\n{{\r\n    config(\r\n        materialized=\'incremental\',\r\n        unique_key= \'Account_ID\'\r\n      )\r\n}}\r\n\r\n{% for V_SF_Schema in results %}\r\n      {% if not loop.first %}\r\n            UNION ALL\r\n        {% endif %}\r\n\r\nWITH source AS\r\n (\r\n select * from {{ V_SF_Schema }}.Account\r\n  ),\r\nDIM_ACCOUNT as (\r\n      select\r\n        {{ dbt_utils.surrogate_key(\'id\') }}  AS Account_ID,\r\n        NAME AS Account_Name,\r\n        TYPE AS Account_Type,\r\n        ID AS Source_ID,\r\n        IS_DELETED AS Active_Flag,\r\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\r\n        INDUSTRY AS INDUSTRY,\r\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\r\n        OWNER_ID AS Employee_ID,\r\n        CREATED_DATE as INITIAL_CREATE_DT,\r\n        {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n        \'D_ACCOUNT_DIM_LOAD\' AS DW_SESSION_NM,\r\n        {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n    FROM source\r\n    )\r\n    select * from DIM_ACCOUNT\r\n    {% endfor %}\r\n\r\nselect * from DIM_ACCOUNT\r\n\r\n\nlimit 100', 'compiled_sql': "\n\n\n\n\n\n\n      \n\nWITH source AS\n (\n select * from DBT_TEST_LIVEDATA_RK.Account\n  ),\nDIM_ACCOUNT as (\n      select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n    )\n    select * from DIM_ACCOUNT\n    \n      \n            UNION ALL\n        \n\nWITH source AS\n (\n select * from SALESFORCE_FREETRAILS.Account\n  ),\nDIM_ACCOUNT as (\n      select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n    )\n    select * from DIM_ACCOUNT\n    \n\nselect * from DIM_ACCOUNT\n\n\nlimit 100", 'tags': None}, None)
2020-12-30 18:04:07.734004 (Thread-1112): handling poll request
2020-12-30 18:04:07.734597 (Thread-1112): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ecf633a0>]}
2020-12-30 18:04:07.736078 (Thread-1112): sending response (<Response 26267 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:06:18.562740 (Thread-1113): handling status request
2020-12-30 18:06:18.564933 (Thread-1113): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ecf63820>]}
2020-12-30 18:06:18.565947 (Thread-1113): sending response (<Response 931 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:06:19.060698 (Thread-1114): handling run_sql request
2020-12-30 18:06:19.061341 (Thread-1114): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ecf63a90>]}
2020-12-30 18:06:20.247436 (Thread-1114): sending response (<Response 137 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:06:20.270307 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:06:20.317307 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:06:20.317831 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:06:20.317941 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:06:20.340043 (Thread-1): On "rpc.sales_dataflo.request": cache miss for schema "DATAFLOTEST_DATABASE.dbt_salesdataflo", this is inefficient
2020-12-30 18:06:20.693381 (Thread-1115): handling poll request
2020-12-30 18:06:20.693866 (Thread-1115): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ecf631f0>]}
2020-12-30 18:06:20.695698 (Thread-1115): sending response (<Response 1935 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:06:20.759265 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:06:20.759377 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:06:20.759436 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:06:21.575440 (Thread-1): SQL status: SUCCESS 26 in 0.82 seconds
2020-12-30 18:06:21.605141 (Thread-1): with database=DATAFLOTEST_DATABASE, schema=dbt_salesdataflo, relations=[<SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CALENDAR">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS_CATEGORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_TIMEFRAME">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_TIMEFRAME">]
2020-12-30 18:06:21.606422 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:06:21.606551 (Thread-1): On rpc.sales_dataflo.request: BEGIN
2020-12-30 18:06:21.683790 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2020-12-30 18:06:21.683970 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:06:21.684042 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:06:21.768206 (Thread-1): SQL status: SUCCESS 2 in 0.08 seconds
2020-12-30 18:06:21.777936 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:06:21.801402 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:06:21.805451 (Thread-1): finished collecting timing info
2020-12-30 18:06:21.807930 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:06:21.808055 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */







      

WITH source AS
 (
 select * from DBT_TEST_LIVEDATA_RK.Account
  ),
  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
          'SF'  as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM source

    
      
            UNION ALL
        

WITH source AS
 (
 select * from SALESFORCE_FREETRAILS.Account
  ),
  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
          'SF'  as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM source

    



limit 100
2020-12-30 18:06:21.878022 (Thread-1): Snowflake query id: 0199477e-00ac-5c5c-0000-5eb10010528a
2020-12-30 18:06:21.878247 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 2 unexpected 'select'.
syntax error line 6 at position 12 unexpected 'cast'.
syntax error line 10 at position 1 unexpected ','.
2020-12-30 18:06:21.878400 (Thread-1): finished collecting timing info
2020-12-30 18:06:21.878793 (Thread-1): On rpc.sales_dataflo.request: ROLLBACK
2020-12-30 18:06:22.000085 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-30 18:06:22.083054 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected 'select'.
  syntax error line 6 at position 12 unexpected 'cast'.
  syntax error line 10 at position 1 unexpected ','.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 5 at position 2 unexpected 'select'.
syntax error line 6 at position 12 unexpected 'cast'.
syntax error line 10 at position 1 unexpected ','.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected 'select'.
  syntax error line 6 at position 12 unexpected 'cast'.
  syntax error line 10 at position 1 unexpected ','.
2020-12-30 18:06:22.085177 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 5 at position 2 unexpected 'select'.\n  syntax error line 6 at position 12 unexpected 'cast'.\n  syntax error line 10 at position 1 unexpected ','.", 'raw_sql': '{% set results = dbt_utils.get_column_values(ref(\'Dim_Entity\'),\'entity_name\') %}\r\n\r\n{% if not var("enable_SF_source") %}\r\n{{\r\n    config(\r\n        enabled=false\r\n    )\r\n}}\r\n{% endif %}\r\n\r\n{{\r\n    config(\r\n        materialized=\'incremental\',\r\n        unique_key= \'Account_ID\'\r\n      )\r\n}}\r\n\r\n{% for V_SF_Schema in results %}\r\n      {% if not loop.first %}\r\n            UNION ALL\r\n        {% endif %}\r\n\r\nWITH source AS\r\n (\r\n select * from {{ V_SF_Schema }}.Account\r\n  ),\r\n  select\r\n        {{ dbt_utils.surrogate_key(\'id\') }}  AS Account_ID,\r\n        NAME AS Account_Name,\r\n        TYPE AS Account_Type,\r\n        ID AS Source_ID,\r\n        IS_DELETED AS Active_Flag,\r\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\r\n        INDUSTRY AS INDUSTRY,\r\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\r\n        OWNER_ID AS Employee_ID,\r\n        CREATED_DATE as INITIAL_CREATE_DT,\r\n        {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n        \'D_ACCOUNT_DIM_LOAD\' AS DW_SESSION_NM,\r\n        {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n    FROM source\r\n\r\n    {% endfor %}\r\n\r\n\r\n\nlimit 100', 'compiled_sql': "\n\n\n\n\n\n\n      \n\nWITH source AS\n (\n select * from DBT_TEST_LIVEDATA_RK.Account\n  ),\n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n\n    \n      \n            UNION ALL\n        \n\nWITH source AS\n (\n select * from SALESFORCE_FREETRAILS.Account\n  ),\n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n\n    \n\n\n\nlimit 100", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 5 at position 2 unexpected 'select'.\n  syntax error line 6 at position 12 unexpected 'cast'.\n  syntax error line 10 at position 1 unexpected ','.", 'raw_sql': '{% set results = dbt_utils.get_column_values(ref(\'Dim_Entity\'),\'entity_name\') %}\r\n\r\n{% if not var("enable_SF_source") %}\r\n{{\r\n    config(\r\n        enabled=false\r\n    )\r\n}}\r\n{% endif %}\r\n\r\n{{\r\n    config(\r\n        materialized=\'incremental\',\r\n        unique_key= \'Account_ID\'\r\n      )\r\n}}\r\n\r\n{% for V_SF_Schema in results %}\r\n      {% if not loop.first %}\r\n            UNION ALL\r\n        {% endif %}\r\n\r\nWITH source AS\r\n (\r\n select * from {{ V_SF_Schema }}.Account\r\n  ),\r\n  select\r\n        {{ dbt_utils.surrogate_key(\'id\') }}  AS Account_ID,\r\n        NAME AS Account_Name,\r\n        TYPE AS Account_Type,\r\n        ID AS Source_ID,\r\n        IS_DELETED AS Active_Flag,\r\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\r\n        INDUSTRY AS INDUSTRY,\r\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\r\n        OWNER_ID AS Employee_ID,\r\n        CREATED_DATE as INITIAL_CREATE_DT,\r\n        {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n        \'D_ACCOUNT_DIM_LOAD\' AS DW_SESSION_NM,\r\n        {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n    FROM source\r\n\r\n    {% endfor %}\r\n\r\n\r\n\nlimit 100', 'compiled_sql': "\n\n\n\n\n\n\n      \n\nWITH source AS\n (\n select * from DBT_TEST_LIVEDATA_RK.Account\n  ),\n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n\n    \n      \n            UNION ALL\n        \n\nWITH source AS\n (\n select * from SALESFORCE_FREETRAILS.Account\n  ),\n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n          'SF'  as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM source\n\n    \n\n\n\nlimit 100", 'tags': None}, None)
2020-12-30 18:06:22.216223 (Thread-1116): handling poll request
2020-12-30 18:06:22.216730 (Thread-1116): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ecf6f280>]}
2020-12-30 18:06:22.220932 (Thread-1116): sending response (<Response 22110 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:06:23.690515 (Thread-1117): handling poll request
2020-12-30 18:06:23.691026 (Thread-1117): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36ecf6fe20>]}
2020-12-30 18:06:23.692110 (Thread-1117): sending response (<Response 26180 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:09:44.480504 (Thread-1118): Got an acceptable cached parse result
2020-12-30 18:09:44.598209 (Thread-1118): Acquiring new snowflake connection "model.sales_dataflo.test".
2020-12-30 18:09:45.079396 (Thread-1119): handling status request
2020-12-30 18:09:45.080298 (Thread-1119): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d61d1580>]}
2020-12-30 18:09:45.081895 (Thread-1119): sending response (<Response 184 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:09:45.276467 (Thread-1118): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:09:46.661685 (Thread-1120): handling status request
2020-12-30 18:09:46.662177 (Thread-1120): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5b9a9a0>]}
2020-12-30 18:09:46.663219 (Thread-1120): sending response (<Response 1228 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:09:48.872049 (Thread-1121): handling status request
2020-12-30 18:09:48.872462 (Thread-1121): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dd208310>]}
2020-12-30 18:09:48.873441 (Thread-1121): sending response (<Response 1228 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:09:49.306807 (Thread-1122): handling run_sql request
2020-12-30 18:09:49.307250 (Thread-1122): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6680dc0>]}
2020-12-30 18:09:49.308456 (Thread-1122): Connection 'model.sales_dataflo.test' was properly closed.
2020-12-30 18:09:50.335075 (Thread-1122): sending response (<Response 137 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:09:50.353780 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:09:50.384428 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:09:50.384900 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:09:50.385011 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:09:50.402217 (Thread-1): On "rpc.sales_dataflo.request": cache miss for schema "DATAFLOTEST_DATABASE.dbt_salesdataflo", this is inefficient
2020-12-30 18:09:50.437950 (Thread-1): Parsing macros/Segmented_Calc.sql
2020-12-30 18:09:50.450573 (Thread-1): Parsing macros/NS_Calc.sql
2020-12-30 18:09:50.852287 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:09:50.852402 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:09:50.852462 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:09:50.871000 (Thread-1123): handling poll request
2020-12-30 18:09:50.871871 (Thread-1123): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6680dc0>]}
2020-12-30 18:09:50.874097 (Thread-1123): sending response (<Response 3504 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:09:51.506967 (Thread-1): SQL status: SUCCESS 26 in 0.65 seconds
2020-12-30 18:09:51.528874 (Thread-1): with database=DATAFLOTEST_DATABASE, schema=dbt_salesdataflo, relations=[<SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CALENDAR">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS_CATEGORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_TIMEFRAME">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_TIMEFRAME">]
2020-12-30 18:09:51.529965 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:09:51.530037 (Thread-1): On rpc.sales_dataflo.request: BEGIN
2020-12-30 18:09:51.732407 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-12-30 18:09:51.732542 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:09:51.732592 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:09:51.834092 (Thread-1): SQL status: SUCCESS 2 in 0.10 seconds
2020-12-30 18:09:51.841822 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:09:51.856466 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:09:51.858758 (Thread-1): finished collecting timing info
2020-12-30 18:09:51.859907 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:09:51.859962 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */







  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        DBT_TEST_LIVEDATA_RK as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM DBT_TEST_LIVEDATA_RK.Account


  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        SALESFORCE_FREETRAILS as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM SALESFORCE_FREETRAILS.Account

            UNION ALL
        

limit 100
2020-12-30 18:09:51.949735 (Thread-1): Snowflake query id: 01994781-001b-c8d7-0000-5eb10010341a
2020-12-30 18:09:51.949858 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 30 at position 2 unexpected 'select'.
syntax error line 35 at position 5 unexpected ')'.
2020-12-30 18:09:51.949950 (Thread-1): finished collecting timing info
2020-12-30 18:09:51.950192 (Thread-1): On rpc.sales_dataflo.request: ROLLBACK
2020-12-30 18:09:52.062314 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-30 18:09:52.215960 (Thread-1): Got an exception: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 2 unexpected 'select'.
  syntax error line 35 at position 5 unexpected ')'.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 30 at position 2 unexpected 'select'.
syntax error line 35 at position 5 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 30 at position 2 unexpected 'select'.
  syntax error line 35 at position 5 unexpected ')'.
2020-12-30 18:09:52.217657 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 30 at position 2 unexpected 'select'.\n  syntax error line 35 at position 5 unexpected ')'.", 'raw_sql': '{% set results = dbt_utils.get_column_values(ref(\'Dim_Entity\'),\'entity_name\') %}\r\n\r\n{% if not var("enable_SF_source") %}\r\n{{\r\n    config(\r\n        enabled=false\r\n    )\r\n}}\r\n{% endif %}\r\n\r\n{{\r\n    config(\r\n        materialized=\'incremental\',\r\n        unique_key= \'Account_ID\'\r\n      )\r\n}}\r\n\r\n{% for V_SF_Schema in results %}\r\n  select\r\n        {{ dbt_utils.surrogate_key(\'id\') }}  AS Account_ID,\r\n        NAME AS Account_Name,\r\n        TYPE AS Account_Type,\r\n        ID AS Source_ID,\r\n        IS_DELETED AS Active_Flag,\r\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\r\n        INDUSTRY AS INDUSTRY,\r\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\r\n        OWNER_ID AS Employee_ID,\r\n        CREATED_DATE as INITIAL_CREATE_DT,\r\n        {{ V_SF_Schema }} as Source_type,\r\n        \'D_ACCOUNT_DIM_LOAD\' AS DW_SESSION_NM,\r\n        {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n    FROM {{ V_SF_Schema }}.Account\r\n{% if not loop.first %}\r\n            UNION ALL\r\n        {% endif %}\r\n{% endfor %}\nlimit 100', 'compiled_sql': "\n\n\n\n\n\n\n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n        DBT_TEST_LIVEDATA_RK as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM DBT_TEST_LIVEDATA_RK.Account\n\n\n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n        SALESFORCE_FREETRAILS as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM SALESFORCE_FREETRAILS.Account\n\n            UNION ALL\n        \n\nlimit 100", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  001003 (42000): SQL compilation error:\n  syntax error line 30 at position 2 unexpected 'select'.\n  syntax error line 35 at position 5 unexpected ')'.", 'raw_sql': '{% set results = dbt_utils.get_column_values(ref(\'Dim_Entity\'),\'entity_name\') %}\r\n\r\n{% if not var("enable_SF_source") %}\r\n{{\r\n    config(\r\n        enabled=false\r\n    )\r\n}}\r\n{% endif %}\r\n\r\n{{\r\n    config(\r\n        materialized=\'incremental\',\r\n        unique_key= \'Account_ID\'\r\n      )\r\n}}\r\n\r\n{% for V_SF_Schema in results %}\r\n  select\r\n        {{ dbt_utils.surrogate_key(\'id\') }}  AS Account_ID,\r\n        NAME AS Account_Name,\r\n        TYPE AS Account_Type,\r\n        ID AS Source_ID,\r\n        IS_DELETED AS Active_Flag,\r\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\r\n        INDUSTRY AS INDUSTRY,\r\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\r\n        OWNER_ID AS Employee_ID,\r\n        CREATED_DATE as INITIAL_CREATE_DT,\r\n        {{ V_SF_Schema }} as Source_type,\r\n        \'D_ACCOUNT_DIM_LOAD\' AS DW_SESSION_NM,\r\n        {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n    FROM {{ V_SF_Schema }}.Account\r\n{% if not loop.first %}\r\n            UNION ALL\r\n        {% endif %}\r\n{% endfor %}\nlimit 100', 'compiled_sql': "\n\n\n\n\n\n\n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n        DBT_TEST_LIVEDATA_RK as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM DBT_TEST_LIVEDATA_RK.Account\n\n\n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n        SALESFORCE_FREETRAILS as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM SALESFORCE_FREETRAILS.Account\n\n            UNION ALL\n        \n\nlimit 100", 'tags': None}, None)
2020-12-30 18:09:52.388868 (Thread-1124): handling poll request
2020-12-30 18:09:52.389285 (Thread-1124): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6907070>]}
2020-12-30 18:09:52.390348 (Thread-1124): sending response (<Response 25370 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:11:31.687112 (Thread-1125): handling status request
2020-12-30 18:11:31.688964 (Thread-1125): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d657b310>]}
2020-12-30 18:11:31.689990 (Thread-1125): sending response (<Response 1228 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:11:32.156306 (Thread-1126): handling compile_sql request
2020-12-30 18:11:32.156720 (Thread-1126): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d657bfd0>]}
2020-12-30 18:11:33.388254 (Thread-1126): sending response (<Response 137 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:11:33.413265 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:11:33.489102 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:11:33.489725 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:11:33.489876 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:11:33.508360 (Thread-1): On "rpc.sales_dataflo.request": cache miss for schema "DATAFLOTEST_DATABASE.dbt_salesdataflo", this is inefficient
2020-12-30 18:11:33.543119 (Thread-1): Parsing macros/Segmented_Calc.sql
2020-12-30 18:11:33.554541 (Thread-1): Parsing macros/NS_Calc.sql
2020-12-30 18:11:33.829530 (Thread-1127): handling poll request
2020-12-30 18:11:33.829984 (Thread-1127): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5b532b0>]}
2020-12-30 18:11:33.832012 (Thread-1127): sending response (<Response 2462 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:11:33.942678 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:11:33.942793 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:11:33.942854 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:11:34.576014 (Thread-1): SQL status: SUCCESS 26 in 0.63 seconds
2020-12-30 18:11:34.598591 (Thread-1): with database=DATAFLOTEST_DATABASE, schema=dbt_salesdataflo, relations=[<SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CALENDAR">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS_CATEGORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_TIMEFRAME">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_TIMEFRAME">]
2020-12-30 18:11:34.599465 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:11:34.599546 (Thread-1): On rpc.sales_dataflo.request: BEGIN
2020-12-30 18:11:34.687989 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2020-12-30 18:11:34.688111 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:11:34.688158 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:11:34.772706 (Thread-1): SQL status: SUCCESS 2 in 0.08 seconds
2020-12-30 18:11:34.780370 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:11:34.794699 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:11:34.797019 (Thread-1): finished collecting timing info
2020-12-30 18:11:34.797291 (Thread-1): finished collecting timing info
2020-12-30 18:11:34.797461 (Thread-1): On rpc.sales_dataflo.request: ROLLBACK
2020-12-30 18:11:34.905191 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-30 18:11:35.394336 (Thread-1128): handling poll request
2020-12-30 18:11:35.394753 (Thread-1128): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5c7ef10>]}
2020-12-30 18:11:35.399973 (Thread-1128): sending response (<Response 16423 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:12:29.816505 (Thread-1129): handling status request
2020-12-30 18:12:29.816925 (Thread-1129): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5c7ed00>]}
2020-12-30 18:12:29.817986 (Thread-1129): sending response (<Response 1228 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:12:30.457621 (Thread-1130): handling run_sql request
2020-12-30 18:12:30.458041 (Thread-1130): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5c7e0a0>]}
2020-12-30 18:12:31.577294 (Thread-1130): sending response (<Response 137 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:12:31.597646 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:31.628723 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:12:31.629212 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:31.629323 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:12:31.645820 (Thread-1): On "rpc.sales_dataflo.request": cache miss for schema "DATAFLOTEST_DATABASE.dbt_salesdataflo", this is inefficient
2020-12-30 18:12:31.678679 (Thread-1): Parsing macros/Segmented_Calc.sql
2020-12-30 18:12:31.689658 (Thread-1): Parsing macros/NS_Calc.sql
2020-12-30 18:12:32.035434 (Thread-1131): handling poll request
2020-12-30 18:12:32.035988 (Thread-1131): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc448220>]}
2020-12-30 18:12:32.038028 (Thread-1131): sending response (<Response 2458 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:12:32.099019 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:32.099144 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:12:32.099204 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:12:32.765113 (Thread-1): SQL status: SUCCESS 26 in 0.67 seconds
2020-12-30 18:12:32.789148 (Thread-1): with database=DATAFLOTEST_DATABASE, schema=dbt_salesdataflo, relations=[<SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CALENDAR">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS_CATEGORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_TIMEFRAME">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_TIMEFRAME">]
2020-12-30 18:12:32.790305 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:32.790418 (Thread-1): On rpc.sales_dataflo.request: BEGIN
2020-12-30 18:12:32.862972 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:12:32.863089 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:32.863136 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:12:32.949213 (Thread-1): SQL status: SUCCESS 2 in 0.09 seconds
2020-12-30 18:12:32.956928 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:12:32.971283 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:12:32.973546 (Thread-1): finished collecting timing info
2020-12-30 18:12:32.974689 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:32.974745 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */








  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        DBT_TEST_LIVEDATA_RK as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM DBT_TEST_LIVEDATA_RK.Account


            UNION ALL
        
  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        SALESFORCE_FREETRAILS as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM SALESFORCE_FREETRAILS.Account

limit 100
2020-12-30 18:12:33.115726 (Thread-1): Snowflake query id: 01994784-00ba-9fc8-0000-5eb100104442
2020-12-30 18:12:33.115849 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 8
invalid identifier 'DBT_TEST_LIVEDATA_RK'
2020-12-30 18:12:33.115939 (Thread-1): finished collecting timing info
2020-12-30 18:12:33.116202 (Thread-1): On rpc.sales_dataflo.request: ROLLBACK
2020-12-30 18:12:33.222979 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-30 18:12:33.302736 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'DBT_TEST_LIVEDATA_RK'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 20 at position 8
invalid identifier 'DBT_TEST_LIVEDATA_RK'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'DBT_TEST_LIVEDATA_RK'
2020-12-30 18:12:33.304290 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 20 at position 8\n  invalid identifier 'DBT_TEST_LIVEDATA_RK'", 'raw_sql': '{% set results = dbt_utils.get_column_values(ref(\'Dim_Entity\'),\'entity_name\') %}\r\n\r\n{% if not var("enable_SF_source") %}\r\n{{\r\n    config(\r\n        enabled=false\r\n    )\r\n}}\r\n{% endif %}\r\n\r\n{{\r\n    config(\r\n        materialized=\'incremental\',\r\n        unique_key= \'Account_ID\'\r\n      )\r\n}}\r\n\r\n{% for V_SF_Schema in results %}\r\n{% if not loop.first %}\r\n            UNION ALL\r\n        {% endif %}\r\n  select\r\n        {{ dbt_utils.surrogate_key(\'id\') }}  AS Account_ID,\r\n        NAME AS Account_Name,\r\n        TYPE AS Account_Type,\r\n        ID AS Source_ID,\r\n        IS_DELETED AS Active_Flag,\r\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\r\n        INDUSTRY AS INDUSTRY,\r\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\r\n        OWNER_ID AS Employee_ID,\r\n        CREATED_DATE as INITIAL_CREATE_DT,\r\n        {{ V_SF_Schema }} as Source_type,\r\n        \'D_ACCOUNT_DIM_LOAD\' AS DW_SESSION_NM,\r\n        {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n    FROM {{ V_SF_Schema }}.Account\r\n{% endfor %}\nlimit 100', 'compiled_sql': "\n\n\n\n\n\n\n\n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n        DBT_TEST_LIVEDATA_RK as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM DBT_TEST_LIVEDATA_RK.Account\n\n\n            UNION ALL\n        \n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n        SALESFORCE_FREETRAILS as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM SALESFORCE_FREETRAILS.Account\n\nlimit 100", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 20 at position 8\n  invalid identifier 'DBT_TEST_LIVEDATA_RK'", 'raw_sql': '{% set results = dbt_utils.get_column_values(ref(\'Dim_Entity\'),\'entity_name\') %}\r\n\r\n{% if not var("enable_SF_source") %}\r\n{{\r\n    config(\r\n        enabled=false\r\n    )\r\n}}\r\n{% endif %}\r\n\r\n{{\r\n    config(\r\n        materialized=\'incremental\',\r\n        unique_key= \'Account_ID\'\r\n      )\r\n}}\r\n\r\n{% for V_SF_Schema in results %}\r\n{% if not loop.first %}\r\n            UNION ALL\r\n        {% endif %}\r\n  select\r\n        {{ dbt_utils.surrogate_key(\'id\') }}  AS Account_ID,\r\n        NAME AS Account_Name,\r\n        TYPE AS Account_Type,\r\n        ID AS Source_ID,\r\n        IS_DELETED AS Active_Flag,\r\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\r\n        INDUSTRY AS INDUSTRY,\r\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\r\n        OWNER_ID AS Employee_ID,\r\n        CREATED_DATE as INITIAL_CREATE_DT,\r\n        {{ V_SF_Schema }} as Source_type,\r\n        \'D_ACCOUNT_DIM_LOAD\' AS DW_SESSION_NM,\r\n        {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n    FROM {{ V_SF_Schema }}.Account\r\n{% endfor %}\nlimit 100', 'compiled_sql': "\n\n\n\n\n\n\n\n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n        DBT_TEST_LIVEDATA_RK as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM DBT_TEST_LIVEDATA_RK.Account\n\n\n            UNION ALL\n        \n  select\n        md5(cast(\n    \n    coalesce(cast(id as \n    varchar\n), '')\n\n as \n    varchar\n))  AS Account_ID,\n        NAME AS Account_Name,\n        TYPE AS Account_Type,\n        ID AS Source_ID,\n        IS_DELETED AS Active_Flag,\n        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,\n        INDUSTRY AS INDUSTRY,\n        ANNUAL_REVENUE AS ANNUAL_REVENUE,\n        OWNER_ID AS Employee_ID,\n        CREATED_DATE as INITIAL_CREATE_DT,\n        SALESFORCE_FREETRAILS as Source_type,\n        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,\n        \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n    FROM SALESFORCE_FREETRAILS.Account\n\nlimit 100", 'tags': None}, None)
2020-12-30 18:12:33.480061 (Thread-1132): handling poll request
2020-12-30 18:12:33.480525 (Thread-1132): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc22b670>]}
2020-12-30 18:12:33.485199 (Thread-1132): sending response (<Response 20871 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:12:36.045919 (Thread-1133): handling poll request
2020-12-30 18:12:36.046359 (Thread-1133): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d63706d0>]}
2020-12-30 18:12:36.167552 (Thread-1133): sending response (<Response 25092 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:12:55.996528 (Thread-1134): handling status request
2020-12-30 18:12:55.996943 (Thread-1134): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d652f6a0>]}
2020-12-30 18:12:55.997981 (Thread-1134): sending response (<Response 1228 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:12:56.473346 (Thread-1135): handling compile_sql request
2020-12-30 18:12:56.473765 (Thread-1135): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6370460>]}
2020-12-30 18:12:57.549933 (Thread-1135): sending response (<Response 137 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:12:57.570410 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:57.610811 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:12:57.611322 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:57.611432 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:12:57.628425 (Thread-1): On "rpc.sales_dataflo.request": cache miss for schema "DATAFLOTEST_DATABASE.dbt_salesdataflo", this is inefficient
2020-12-30 18:12:57.663763 (Thread-1): Parsing macros/Segmented_Calc.sql
2020-12-30 18:12:57.676476 (Thread-1): Parsing macros/NS_Calc.sql
2020-12-30 18:12:58.012918 (Thread-1136): handling poll request
2020-12-30 18:12:58.013417 (Thread-1136): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d68ea940>]}
2020-12-30 18:12:58.015426 (Thread-1136): sending response (<Response 2462 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:12:58.075777 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:58.075943 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:12:58.076045 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:12:58.700071 (Thread-1): SQL status: SUCCESS 26 in 0.62 seconds
2020-12-30 18:12:58.724078 (Thread-1): with database=DATAFLOTEST_DATABASE, schema=dbt_salesdataflo, relations=[<SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CALENDAR">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS_CATEGORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_TIMEFRAME">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_TIMEFRAME">]
2020-12-30 18:12:58.724917 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:58.724987 (Thread-1): On rpc.sales_dataflo.request: BEGIN
2020-12-30 18:12:58.806248 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2020-12-30 18:12:58.806382 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:12:58.806429 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:12:58.890096 (Thread-1): SQL status: SUCCESS 2 in 0.08 seconds
2020-12-30 18:12:58.898246 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:12:58.913007 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:12:58.915389 (Thread-1): finished collecting timing info
2020-12-30 18:12:58.915656 (Thread-1): finished collecting timing info
2020-12-30 18:12:58.915830 (Thread-1): On rpc.sales_dataflo.request: ROLLBACK
2020-12-30 18:12:59.027502 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-30 18:12:59.515562 (Thread-1137): handling poll request
2020-12-30 18:12:59.516069 (Thread-1137): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d68eaac0>]}
2020-12-30 18:12:59.521082 (Thread-1137): sending response (<Response 16423 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:14:26.756064 (Thread-1138): Parsing macros/Segmented_Calc.sql
2020-12-30 18:14:26.768742 (Thread-1138): Parsing macros/NS_Calc.sql
2020-12-30 18:14:27.143013 (Thread-1138): Got an acceptable cached parse result
2020-12-30 18:14:27.257157 (Thread-1138): Acquiring new snowflake connection "model.sales_dataflo.test".
2020-12-30 18:14:27.621534 (Thread-1138): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:14:27.697339 (Thread-1139): handling status request
2020-12-30 18:14:27.697731 (Thread-1139): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d71cda30>]}
2020-12-30 18:14:27.698886 (Thread-1139): sending response (<Response 1753 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:14:30.296489 (Thread-1140): handling status request
2020-12-30 18:14:30.296918 (Thread-1140): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dd190550>]}
2020-12-30 18:14:30.298074 (Thread-1140): sending response (<Response 1753 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:14:30.784476 (Thread-1141): handling run_sql request
2020-12-30 18:14:30.784915 (Thread-1141): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc107eb0>]}
2020-12-30 18:14:30.786251 (Thread-1141): Connection 'model.sales_dataflo.test' was properly closed.
2020-12-30 18:14:31.831491 (Thread-1141): sending response (<Response 137 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:14:31.849889 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:14:31.880176 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:14:31.880587 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:14:31.880692 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:14:31.897170 (Thread-1): On "rpc.sales_dataflo.request": cache miss for schema "DATAFLOTEST_DATABASE.dbt_salesdataflo", this is inefficient
2020-12-30 18:14:32.235021 (Thread-1142): handling poll request
2020-12-30 18:14:32.235480 (Thread-1142): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d64522b0>]}
2020-12-30 18:14:32.237511 (Thread-1142): sending response (<Response 1935 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:14:32.307375 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:14:32.307492 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:14:32.307552 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:14:32.926980 (Thread-1): SQL status: SUCCESS 26 in 0.62 seconds
2020-12-30 18:14:32.950241 (Thread-1): with database=DATAFLOTEST_DATABASE, schema=dbt_salesdataflo, relations=[<SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CALENDAR">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS_CATEGORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_TIMEFRAME">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_TIMEFRAME">]
2020-12-30 18:14:32.951032 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:14:32.951098 (Thread-1): On rpc.sales_dataflo.request: BEGIN
2020-12-30 18:14:33.029996 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2020-12-30 18:14:33.030128 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:14:33.030179 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:14:33.118614 (Thread-1): SQL status: SUCCESS 2 in 0.09 seconds
2020-12-30 18:14:33.125370 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:14:33.139854 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:14:33.142177 (Thread-1): finished collecting timing info
2020-12-30 18:14:33.143312 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:14:33.143372 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */








  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        'DBT_TEST_LIVEDATA_RK' as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM DBT_TEST_LIVEDATA_RK.Account


            UNION ALL
        
  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        'SALESFORCE_FREETRAILS' as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM SALESFORCE_FREETRAILS.Account

limit 100
2020-12-30 18:14:33.753253 (Thread-1143): handling poll request
2020-12-30 18:14:33.753701 (Thread-1143): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6452a30>]}
2020-12-30 18:14:33.755957 (Thread-1143): sending response (<Response 9675 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:14:33.983885 (Thread-1): SQL status: SUCCESS 100 in 0.84 seconds
2020-12-30 18:14:33.988134 (Thread-1): finished collecting timing info
2020-12-30 18:14:33.988408 (Thread-1): On rpc.sales_dataflo.request: ROLLBACK
2020-12-30 18:14:34.101843 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-30 18:14:35.256724 (Thread-1144): handling poll request
2020-12-30 18:14:35.257221 (Thread-1144): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d62f96d0>]}
2020-12-30 18:14:35.262714 (Thread-1144): sending response (<Response 34959 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:15:01.130905 (Thread-1145): handling status request
2020-12-30 18:15:01.131378 (Thread-1145): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d62eb580>]}
2020-12-30 18:15:01.132550 (Thread-1145): sending response (<Response 1753 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:15:01.562835 (Thread-1146): handling run_sql request
2020-12-30 18:15:01.563244 (Thread-1146): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d64527f0>]}
2020-12-30 18:15:02.669308 (Thread-1146): sending response (<Response 137 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:15:02.688485 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:15:02.718720 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:15:02.719172 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:15:02.719281 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:15:02.735706 (Thread-1): On "rpc.sales_dataflo.request": cache miss for schema "DATAFLOTEST_DATABASE.dbt_salesdataflo", this is inefficient
2020-12-30 18:15:03.132594 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:15:03.132716 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:15:03.132776 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:15:03.203597 (Thread-1147): handling poll request
2020-12-30 18:15:03.204122 (Thread-1147): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5fb0a00>]}
2020-12-30 18:15:03.206273 (Thread-1147): sending response (<Response 2981 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:15:03.710772 (Thread-1): SQL status: SUCCESS 26 in 0.58 seconds
2020-12-30 18:15:03.732729 (Thread-1): with database=DATAFLOTEST_DATABASE, schema=dbt_salesdataflo, relations=[<SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CALENDAR">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_METRICS_CATEGORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_TIMEFRAME">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."FACT_SALES_SEGMENTED_HISTORY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ACCOUNT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_ADDRESS">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CAMPAIGN">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_CONTACT">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_EMPLOYEE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_LEAD">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_OPPORTUNITY_STAGE">, <SnowflakeRelation "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."VW_TIMEFRAME">]
2020-12-30 18:15:03.733561 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:15:03.733628 (Thread-1): On rpc.sales_dataflo.request: BEGIN
2020-12-30 18:15:03.815869 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2020-12-30 18:15:03.815985 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:15:03.816035 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:15:03.906890 (Thread-1): SQL status: SUCCESS 2 in 0.09 seconds
2020-12-30 18:15:03.914465 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:15:03.928885 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:15:03.931198 (Thread-1): finished collecting timing info
2020-12-30 18:15:03.932316 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:15:03.932374 (Thread-1): On rpc.sales_dataflo.request: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "master"} */








  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        'DBT_TEST_LIVEDATA_RK' as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM DBT_TEST_LIVEDATA_RK.Account


            UNION ALL
        
  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        'SALESFORCE_FREETRAILS' as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM SALESFORCE_FREETRAILS.Account
2020-12-30 18:15:04.541934 (Thread-1): SQL status: SUCCESS 16248 in 0.61 seconds
2020-12-30 18:15:04.659292 (Thread-1148): handling poll request
2020-12-30 18:15:04.659718 (Thread-1148): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d605f670>]}
2020-12-30 18:15:04.661772 (Thread-1148): sending response (<Response 8890 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:15:05.919500 (Thread-1): finished collecting timing info
2020-12-30 18:15:05.919830 (Thread-1): On rpc.sales_dataflo.request: ROLLBACK
2020-12-30 18:15:06.023479 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-30 18:15:06.086086 (Thread-1149): handling poll request
2020-12-30 18:15:06.086514 (Thread-1149): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d60df3a0>]}
2020-12-30 18:15:06.087641 (Thread-1149): sending response (<Response 1334 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:15:07.496245 (Thread-1150): handling poll request
2020-12-30 18:15:07.496664 (Thread-1150): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d649b250>]}
2020-12-30 18:15:07.626701 (Thread-1150): sending response (<Response 4155382 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:15:48.558136 (Thread-1151): handling status request
2020-12-30 18:15:48.558605 (Thread-1151): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc3a6eb0>]}
2020-12-30 18:15:48.559705 (Thread-1151): sending response (<Response 1753 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:15:48.565173 (Thread-1152): handling status request
2020-12-30 18:15:48.565490 (Thread-1152): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc3a6ee0>]}
2020-12-30 18:15:48.566427 (Thread-1152): sending response (<Response 1753 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:15:49.111326 (Thread-1153): handling cli_args request
2020-12-30 18:15:49.111782 (Thread-1153): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d649b910>]}
2020-12-30 18:15:50.310761 (Thread-1153): sending response (<Response 137 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:15:50.432726 (MainThread): Partial parsing not enabled
2020-12-30 18:15:50.440831 (MainThread): Parsing macros/Segmented_Calc.sql
2020-12-30 18:15:50.444918 (MainThread): Parsing macros/NS_History_Calc.sql
2020-12-30 18:15:50.453446 (MainThread): Parsing macros/Get_Variables.sql
2020-12-30 18:15:50.459286 (MainThread): Parsing macros/NS_Calc.sql
2020-12-30 18:15:50.463084 (MainThread): Parsing macros/Segmented_History_Calc.sql
2020-12-30 18:15:50.472623 (MainThread): Parsing macros/Archive/NS_Opportunity_History.sql
2020-12-30 18:15:50.478974 (MainThread): Parsing macros/Archive/NS_Account_History.sql
2020-12-30 18:15:50.486036 (MainThread): Parsing macros/Archive/NS_Lead_History.sql
2020-12-30 18:15:50.492331 (MainThread): Parsing macros/Archive/NS_Contact_History.sql
2020-12-30 18:15:50.495414 (MainThread): Parsing macros/adapters.sql
2020-12-30 18:15:50.538017 (MainThread): Parsing macros/catalog.sql
2020-12-30 18:15:50.540537 (MainThread): Parsing macros/materializations/table.sql
2020-12-30 18:15:50.545377 (MainThread): Parsing macros/materializations/merge.sql
2020-12-30 18:15:50.547378 (MainThread): Parsing macros/materializations/view.sql
2020-12-30 18:15:50.548888 (MainThread): Parsing macros/materializations/incremental.sql
2020-12-30 18:15:50.559860 (MainThread): Parsing macros/core.sql
2020-12-30 18:15:50.564277 (MainThread): Parsing macros/adapters/common.sql
2020-12-30 18:15:50.624712 (MainThread): Parsing macros/materializations/helpers.sql
2020-12-30 18:15:50.634106 (MainThread): Parsing macros/materializations/table/table.sql
2020-12-30 18:15:50.640938 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-12-30 18:15:50.661486 (MainThread): Parsing macros/materializations/view/view.sql
2020-12-30 18:15:50.667663 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-12-30 18:15:50.672506 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-12-30 18:15:50.674382 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-12-30 18:15:50.680344 (MainThread): Parsing macros/materializations/common/merge.sql
2020-12-30 18:15:50.694064 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-12-30 18:15:50.710549 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-12-30 18:15:50.712412 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-12-30 18:15:50.743335 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-12-30 18:15:50.745350 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-12-30 18:15:50.746925 (MainThread): Parsing macros/schema_tests/unique.sql
2020-12-30 18:15:50.748703 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-12-30 18:15:50.751498 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-12-30 18:15:50.753286 (MainThread): Parsing macros/etc/query.sql
2020-12-30 18:15:50.754451 (MainThread): Parsing macros/etc/datetime.sql
2020-12-30 18:15:50.763259 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-12-30 18:15:50.764294 (MainThread): Parsing macros/etc/is_incremental.sql
2020-12-30 18:15:50.766104 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-12-30 18:15:50.787094 (MainThread): Parsing macros/logger/pretty_time.sql
2020-12-30 18:15:50.791681 (MainThread): Parsing macros/logger/log_info.sql
2020-12-30 18:15:50.796222 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-12-30 18:15:50.800646 (MainThread): Parsing macros/sql/pivot.sql
2020-12-30 18:15:50.808075 (MainThread): Parsing macros/sql/star.sql
2020-12-30 18:15:50.815164 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-12-30 18:15:50.822039 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-12-30 18:15:50.827584 (MainThread): Parsing macros/sql/get_column_values.sql
2020-12-30 18:15:50.835234 (MainThread): Parsing macros/sql/groupby.sql
2020-12-30 18:15:50.839645 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2020-12-30 18:15:50.849870 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-12-30 18:15:50.854933 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-12-30 18:15:50.859991 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2020-12-30 18:15:50.868730 (Thread-1154): handling poll request
2020-12-30 18:15:50.866169 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-12-30 18:15:50.869412 (Thread-1154): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc45ad00>]}
2020-12-30 18:15:50.875195 (Thread-1154): sending response (<Response 14845 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:15:50.872246 (MainThread): Parsing macros/sql/safe_add.sql
2020-12-30 18:15:50.877226 (MainThread): Parsing macros/sql/unpivot.sql
2020-12-30 18:15:50.887756 (MainThread): Parsing macros/sql/generate_series.sql
2020-12-30 18:15:50.894756 (MainThread): Parsing macros/sql/nullcheck.sql
2020-12-30 18:15:50.899861 (MainThread): Parsing macros/sql/union.sql
2020-12-30 18:15:50.911230 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-12-30 18:15:50.937509 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-12-30 18:15:50.942305 (MainThread): Parsing macros/web/get_url_path.sql
2020-12-30 18:15:50.948705 (MainThread): Parsing macros/web/get_url_host.sql
2020-12-30 18:15:50.953951 (MainThread): Parsing macros/datetime/date_spine.sql
2020-12-30 18:15:50.961175 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-12-30 18:15:50.965828 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-12-30 18:15:50.970707 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-12-30 18:15:50.975555 (MainThread): Parsing macros/schema_tests/equality.sql
2020-12-30 18:15:50.984412 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2020-12-30 18:15:50.989951 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-12-30 18:15:50.994919 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2020-12-30 18:15:51.001367 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-12-30 18:15:51.011417 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-12-30 18:15:51.017344 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-12-30 18:15:51.024456 (MainThread): Parsing macros/schema_tests/recency.sql
2020-12-30 18:15:51.029893 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-12-30 18:15:51.035185 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-12-30 18:15:51.040204 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-12-30 18:15:51.046060 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-12-30 18:15:51.051364 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-12-30 18:15:51.059413 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2020-12-30 18:15:51.064899 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-12-30 18:15:51.071521 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-12-30 18:15:51.076721 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-12-30 18:15:51.082161 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-12-30 18:15:51.088346 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-12-30 18:15:51.093613 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-12-30 18:15:51.099122 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-12-30 18:15:51.112955 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-12-30 18:15:51.119578 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-12-30 18:15:51.130423 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-12-30 18:15:51.135921 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-12-30 18:15:51.140488 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2020-12-30 18:15:51.146252 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-12-30 18:15:51.155457 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-12-30 18:15:51.160990 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-12-30 18:15:51.166096 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-12-30 18:15:51.172485 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-12-30 18:15:51.179659 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-12-30 18:15:51.189770 (MainThread): Parsing macros/get_date_dimension.sql
2020-12-30 18:15:51.210351 (MainThread): Parsing macros/get_base_dates.sql
2020-12-30 18:15:51.216613 (MainThread): Parsing macros/calendar_date/n_weeks_ago.sql
2020-12-30 18:15:51.221427 (MainThread): Parsing macros/calendar_date/to_unixtimestamp.sql
2020-12-30 18:15:51.226756 (MainThread): Parsing macros/calendar_date/yesterday.sql
2020-12-30 18:15:51.232029 (MainThread): Parsing macros/calendar_date/month_name.sql
2020-12-30 18:15:51.239331 (MainThread): Parsing macros/calendar_date/day_name.sql
2020-12-30 18:15:51.246288 (MainThread): Parsing macros/calendar_date/_get_utils_namespaces.sql
2020-12-30 18:15:51.251166 (MainThread): Parsing macros/calendar_date/date_part.sql
2020-12-30 18:15:51.257928 (MainThread): Parsing macros/calendar_date/n_days_ago.sql
2020-12-30 18:15:51.263725 (MainThread): Parsing macros/calendar_date/now.sql
2020-12-30 18:15:51.268971 (MainThread): Parsing macros/calendar_date/n_months_ago.sql
2020-12-30 18:15:51.274966 (MainThread): Parsing macros/calendar_date/this_week.sql
2020-12-30 18:15:51.279579 (MainThread): Parsing macros/calendar_date/convert_timezone.sql
2020-12-30 18:15:51.286390 (MainThread): Parsing macros/calendar_date/periods_since.sql
2020-12-30 18:15:51.290941 (MainThread): Parsing macros/calendar_date/n_months_away.sql
2020-12-30 18:15:51.295873 (MainThread): Parsing macros/calendar_date/n_days_away.sql
2020-12-30 18:15:51.300879 (MainThread): Parsing macros/calendar_date/last_week.sql
2020-12-30 18:15:51.305450 (MainThread): Parsing macros/calendar_date/n_weeks_away.sql
2020-12-30 18:15:51.310353 (MainThread): Parsing macros/calendar_date/tomorrow.sql
2020-12-30 18:15:51.314849 (MainThread): Parsing macros/calendar_date/today.sql
2020-12-30 18:15:51.319959 (MainThread): Parsing macros/fiscal_date/get_fiscal_periods.sql
2020-12-30 18:15:51.326682 (MainThread): Parsing macros/fiscal_date/get_fiscal_year_dates.sql
2020-12-30 18:15:51.348779 (MainThread): Partial parsing not enabled
2020-12-30 18:15:51.417737 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-30 18:15:51.443882 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-30 18:15:51.460413 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-30 18:15:51.475529 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Address".
2020-12-30 18:15:51.490067 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-30 18:15:51.505018 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-30 18:15:51.519687 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-30 18:15:51.534103 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-30 18:15:51.551097 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Employee".
2020-12-30 18:15:51.572771 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-30 18:15:51.595283 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-30 18:15:51.617271 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Account".
2020-12-30 18:15:51.641018 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Product".
2020-12-30 18:15:51.651832 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Product model triggered this warning. 
2020-12-30 18:15:51.678654 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:15:51.685142 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity model triggered this warning. 
2020-12-30 18:15:51.697426 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:15:51.702448 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Account model triggered this warning. 
2020-12-30 18:15:51.714476 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:15:51.776479 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Calc".
2020-12-30 18:15:51.789319 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2020-12-30 18:15:51.823392 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2020-12-30 18:15:51.840811 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.test".
2020-12-30 18:15:51.869268 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-30 18:15:51.887137 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:15:51.974001 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:15:51.980168 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Lead model triggered this warning. 
2020-12-30 18:15:51.995194 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-30 18:15:52.001349 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-30 18:15:52.002400 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-30 18:15:52.014612 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales".
2020-12-30 18:15:52.033900 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:15:52.039380 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Contact model triggered this warning. 
2020-12-30 18:15:52.051430 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:15:52.057584 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Employee model triggered this warning. 
2020-12-30 18:15:52.071728 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:15:52.078938 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity_Stage model triggered this warning. 
2020-12-30 18:15:52.092783 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:15:52.098638 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Campaign model triggered this warning. 
2020-12-30 18:15:52.110819 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:15:52.316784 (Thread-1155): handling poll request
2020-12-30 18:15:52.317445 (Thread-1155): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dcf50cd0>]}
2020-12-30 18:15:52.331372 (Thread-1155): sending response (<Response 33593 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:15:52.401659 (MainThread): Acquiring new snowflake connection "model.dbt_date.dim_date_fiscal".
2020-12-30 18:15:52.445300 (MainThread): Acquiring new snowflake connection "model.dbt_date.dim_date".
2020-12-30 18:15:52.473918 (MainThread): Acquiring new snowflake connection "model.dbt_date.dates".
2020-12-30 18:15:52.739384 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Tables
- models.sales_dataflo.Views
- seeds.sales_dataflo

2020-12-30 18:15:52.800959 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 317 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:15:52.802610 (MainThread): 
2020-12-30 18:15:52.802905 (MainThread): Acquiring new snowflake connection "master".
2020-12-30 18:15:52.833906 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DATAFLOTEST_DATABASE".
2020-12-30 18:15:52.843935 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DATAFLOTEST_DATABASE".
2020-12-30 18:15:52.844081 (ThreadPoolExecutor-0_0): On list_DATAFLOTEST_DATABASE: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "list_DATAFLOTEST_DATABASE"} */

    show terse schemas in database DATAFLOTEST_DATABASE
    limit 10000
2020-12-30 18:15:52.844148 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-12-30 18:15:53.479168 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 18 in 0.63 seconds
2020-12-30 18:15:53.481454 (ThreadPoolExecutor-0_0): On list_DATAFLOTEST_DATABASE: Close
2020-12-30 18:15:53.584882 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DATAFLOTEST_DATABASE_dbt_salesdataflo".
2020-12-30 18:15:53.593168 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DATAFLOTEST_DATABASE_dbt_salesdataflo".
2020-12-30 18:15:53.593255 (ThreadPoolExecutor-1_0): On list_DATAFLOTEST_DATABASE_dbt_salesdataflo: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "list_DATAFLOTEST_DATABASE_dbt_salesdataflo"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:15:53.593314 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-12-30 18:15:53.762270 (Thread-1156): handling poll request
2020-12-30 18:15:53.762682 (Thread-1156): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6647e20>]}
2020-12-30 18:15:53.764868 (Thread-1156): sending response (<Response 6013 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:15:54.076848 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 26 in 0.48 seconds
2020-12-30 18:15:54.098233 (ThreadPoolExecutor-1_0): On list_DATAFLOTEST_DATABASE_dbt_salesdataflo: Close
2020-12-30 18:15:54.210332 (MainThread): Using snowflake connection "master".
2020-12-30 18:15:54.210490 (MainThread): On master: BEGIN
2020-12-30 18:15:54.210577 (MainThread): Opening a new connection, currently in state init
2020-12-30 18:15:54.562715 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2020-12-30 18:15:54.562867 (MainThread): On master: COMMIT
2020-12-30 18:15:54.562959 (MainThread): Using snowflake connection "master".
2020-12-30 18:15:54.563006 (MainThread): On master: COMMIT
2020-12-30 18:15:54.685562 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2020-12-30 18:15:54.685720 (MainThread): On master: Close
2020-12-30 18:15:54.765862 (MainThread): 18:15:54 | Concurrency: 1 threads (target='default')
2020-12-30 18:15:54.766015 (MainThread): 18:15:54 | 
2020-12-30 18:15:54.768103 (Thread-1): Began running node model.sales_dataflo.Dim_Calendar
2020-12-30 18:15:54.769957 (Thread-1): 18:15:54 | 1 of 29 START table model dbt_salesdataflo.Dim_Calendar.............. [RUN]
2020-12-30 18:15:54.770338 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:15:54.770487 (Thread-1): Compiling model.sales_dataflo.Dim_Calendar
2020-12-30 18:15:54.810444 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:15:54.810615 (Thread-1): On model.sales_dataflo.Dim_Calendar: BEGIN
2020-12-30 18:15:54.810721 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:15:55.120521 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-12-30 18:15:55.120675 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:15:55.120727 (Thread-1): On model.sales_dataflo.Dim_Calendar: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Calendar"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2015', 'dd/mm/yyyy'),
        dateadd(week, 53, current_date)
        )
2020-12-30 18:15:55.182608 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:15:55.190726 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Calendar"
2020-12-30 18:15:55.227782 (Thread-1): finished collecting timing info
2020-12-30 18:15:55.242825 (Thread-1157): handling poll request
2020-12-30 18:15:55.243401 (Thread-1157): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d71bdb20>]}
2020-12-30 18:15:55.246798 (Thread-1157): sending response (<Response 8935 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:15:55.266603 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Calendar"
2020-12-30 18:15:55.310407 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:15:55.310550 (Thread-1): On model.sales_dataflo.Dim_Calendar: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Calendar"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Calendar  as
      (



with source as 
(

    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
     + 
    
    p10.generated_number * pow(2, 10)
     + 
    
    p11.generated_number * pow(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2561
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2015', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= dateadd(week, 53, current_date)

)

select * from filtered


) ,Dim_Calendar as(
select
      d.date_day AS Calendar_ID,
      d.date_day as cldr_date,
      cast(
    date_trunc('month', d.date_day)
 as date) as cldr_mnth_strt_dt,    
       cast(
  cast(
        
  

    dateadd(
        day,
        -1,
        
  

    dateadd(
        month,
        1,
        
    date_trunc('month', d.date_day)

        )



        )



        as date)
 as date) as cldr_mnth_end_dt,
        cast(
    date_trunc('quarter', d.date_day)
 as date) as cldr_qtr_strt_dt,
        cast(
  cast(
        
  

    dateadd(
        day,
        -1,
        
  

    dateadd(
        quarter,
        1,
        
    date_trunc('quarter', d.date_day)

        )



        )



        as date)
 as date) as cldr_qtr_end_dt,
        cast(
    date_trunc('year', d.date_day)
 as date) as cldr_year_start_dt,
        cast(
  cast(
        
  

    dateadd(
        day,
        -1,
        
  

    dateadd(
        year,
        1,
        
    date_trunc('year', d.date_day)

        )



        )



        as date)
 as date) as cldr_year_end_dt,
        cast(
    date_trunc('week', d.date_day)
 as date) as week_start_date,
        cast(
  cast(
        
  

    dateadd(
        day,
        -1,
        
  

    dateadd(
        week,
        1,
        
    date_trunc('week', d.date_day)

        )



        )



        as date)
 as date) as week_end_date,
        to_char(d.date_day, 'Dy') as day_short_name,
      to_char(d.date_day, 'MON') as month_short_name,
        cast(to_char(d.date_day, 'MMMM') as varchar(20))as month_name,
        cast(date_part('day', d.date_day) as 
    int
) as cldr_day_num,
        cast(date_part('week', d.date_day) as 
    int
) as cldr_week_num,
        'Q' || cast(date_part('quarter', d.date_day) as 
    int
) as cldr_qtr,
        cast(date_part('year', d.date_day) as 
    int
) as year,
        cast(
            case
                when date_part('dayofweek', d.date_day) = 0 then 7
                else date_part('dayofweek', d.date_day)
            end as 
    int

            ) as day_of_week,
        case
            when date_part('dayofweek', d.date_day) = 0 then 'Y'
            else 'N'
        end as weekend_flag,   
      
    current_timestamp::
    timestamp_ntz

 as DW_INS_UPD_DTS,
      'D_CALENDAR_DIM_LOAD' as DW_SESSION_NM
from
    source  d
order by 2)

select * from Dim_Calendar
      );
2020-12-30 18:15:56.687415 (Thread-1158): handling poll request
2020-12-30 18:15:56.687972 (Thread-1158): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dcf50400>]}
2020-12-30 18:15:56.689590 (Thread-1158): sending response (<Response 6064 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:15:56.853200 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2020-12-30 18:15:56.854302 (Thread-1): On model.sales_dataflo.Dim_Calendar: COMMIT
2020-12-30 18:15:56.854416 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:15:56.854464 (Thread-1): On model.sales_dataflo.Dim_Calendar: COMMIT
2020-12-30 18:15:56.908843 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:15:56.919896 (Thread-1): finished collecting timing info
2020-12-30 18:15:56.920125 (Thread-1): On model.sales_dataflo.Dim_Calendar: Close
2020-12-30 18:15:56.995469 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ecb3cd0>]}
2020-12-30 18:15:56.996663 (Thread-1): 18:15:56 | 1 of 29 OK created table model dbt_salesdataflo.Dim_Calendar......... [SUCCESS 1 in 2.23s]
2020-12-30 18:15:56.996768 (Thread-1): Finished running node model.sales_dataflo.Dim_Calendar
2020-12-30 18:15:56.996873 (Thread-1): Began running node model.sales_dataflo.Dim_Employee
2020-12-30 18:15:56.997716 (Thread-1): 18:15:56 | 2 of 29 START incremental model dbt_salesdataflo.Dim_Employee........ [RUN]
2020-12-30 18:15:56.997938 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:15:56.998012 (Thread-1): Compiling model.sales_dataflo.Dim_Employee
2020-12-30 18:15:57.006306 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Employee model triggered this warning. 
2020-12-30 18:15:57.008315 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Employee"
2020-12-30 18:15:57.029208 (Thread-1): finished collecting timing info
2020-12-30 18:15:57.056404 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:15:57.056521 (Thread-1): On model.sales_dataflo.Dim_Employee: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Employee"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee__dbt_tmp  as
      (



With user AS(
    select *  from DBT_TEST_LIVEDATA_RK.user
),usr_role AS(
    select *  from DBT_TEST_LIVEDATA_RK.user_role
),Dim_Employee AS(
 SELECT
   md5(cast(
    
    coalesce(cast(user.id as 
    varchar
), '')

 as 
    varchar
)) AS employee_id,
   ACCOUNT_ID AS emp_account_id,
   user.id AS source_Emp_id,
   cast('FIVETRAN_SF' as varchar(50)) AS Entity_id, 
   COMPANY_NAME AS org_name,
   EMPLOYEE_NUMBER AS employee_code,
   FIRST_NAME AS first_name,
   NULL AS middle_name,
   LAST_NAME AS last_name,
   user.NAME AS emp_full_nm,
   USER_ROLE_ID AS emp_role_id,
   usr_role. NAME AS emp_position_level,
   NULL  AS emp_gender,
   PHONE AS emp_phone_number,
   EMAIL AS emp_email,
   NULL AS sales_branch_id,
   NULL AS sales_branch_name,
   NULL AS sales_region_id,
   NULL AS sales_region_name,
   NULL AS sales_zone_id,
   NULL AS sales_zone_name,
   NULL AS business_unit_id,
   DEPARTMENT AS business_unit_name,
   CREATED_DATE AS emp_create_dt,
   user.LAST_MODIFIED_DATE AS emp_last_update_dt,
   MANAGER_ID AS mngr_emp_id,
   usr_role.NAME AS mngr_position_level,
   USER_ROLE_ID AS mngr_role_id,
   NULL AS emp_financial_year_start,
   NULL AS emp_start_of_week,
   NULL AS Weekly_working_days,
   IS_ACTIVE AS  emp_active,
     'SF'  as Source_type,
   'D_EMPLOYEE_DIM_LOAD' AS DW_SESSION_NM,
   
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
  FROM
      user left join usr_role  on user.USER_ROLE_ID = usr_role.ID
)

select * from Dim_Employee
      );
2020-12-30 18:15:57.056610 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:15:58.215384 (Thread-1159): handling poll request
2020-12-30 18:15:58.215857 (Thread-1159): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dcf50040>]}
2020-12-30 18:15:58.218609 (Thread-1159): sending response (<Response 9885 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:15:58.730214 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2020-12-30 18:15:58.739167 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:15:58.739282 (Thread-1): On model.sales_dataflo.Dim_Employee: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Employee"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee__dbt_tmp
2020-12-30 18:15:58.820531 (Thread-1): SQL status: SUCCESS 35 in 0.08 seconds
2020-12-30 18:15:58.825280 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:15:58.825374 (Thread-1): On model.sales_dataflo.Dim_Employee: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Employee"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
2020-12-30 18:15:58.912985 (Thread-1): SQL status: SUCCESS 34 in 0.09 seconds
2020-12-30 18:15:58.917487 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:15:58.917573 (Thread-1): On model.sales_dataflo.Dim_Employee: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Employee"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
2020-12-30 18:15:58.972719 (Thread-1): SQL status: SUCCESS 34 in 0.06 seconds
2020-12-30 18:15:58.997507 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Employee"
2020-12-30 18:15:59.020443 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:15:59.020553 (Thread-1): On model.sales_dataflo.Dim_Employee: BEGIN
2020-12-30 18:15:59.092711 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:15:59.092857 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:15:59.092908 (Thread-1): On model.sales_dataflo.Dim_Employee: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Employee"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.employee_id = DBT_INTERNAL_DEST.employee_id
        

    
    when matched then update set
        "EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","EMP_ACCOUNT_ID" = DBT_INTERNAL_SOURCE."EMP_ACCOUNT_ID","SOURCE_EMP_ID" = DBT_INTERNAL_SOURCE."SOURCE_EMP_ID","ENTITY_ID" = DBT_INTERNAL_SOURCE."ENTITY_ID","ORG_NAME" = DBT_INTERNAL_SOURCE."ORG_NAME","EMPLOYEE_CODE" = DBT_INTERNAL_SOURCE."EMPLOYEE_CODE","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","MIDDLE_NAME" = DBT_INTERNAL_SOURCE."MIDDLE_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","EMP_FULL_NM" = DBT_INTERNAL_SOURCE."EMP_FULL_NM","EMP_ROLE_NM" = DBT_INTERNAL_SOURCE."EMP_ROLE_NM","EMP_POSITION_LEVEL" = DBT_INTERNAL_SOURCE."EMP_POSITION_LEVEL","EMP_GENDER" = DBT_INTERNAL_SOURCE."EMP_GENDER","EMP_PHONE_NUMBER" = DBT_INTERNAL_SOURCE."EMP_PHONE_NUMBER","EMP_EMAIL" = DBT_INTERNAL_SOURCE."EMP_EMAIL","SALES_BRANCH_ID" = DBT_INTERNAL_SOURCE."SALES_BRANCH_ID","SALES_BRANCH_NAME" = DBT_INTERNAL_SOURCE."SALES_BRANCH_NAME","SALES_REGION_ID" = DBT_INTERNAL_SOURCE."SALES_REGION_ID","SALES_REGION_NAME" = DBT_INTERNAL_SOURCE."SALES_REGION_NAME","SALES_ZONE_ID" = DBT_INTERNAL_SOURCE."SALES_ZONE_ID","SALES_ZONE_NAME" = DBT_INTERNAL_SOURCE."SALES_ZONE_NAME","BUSINESS_UNIT_ID" = DBT_INTERNAL_SOURCE."BUSINESS_UNIT_ID","BUSINESS_UNIT_NAME" = DBT_INTERNAL_SOURCE."BUSINESS_UNIT_NAME","EMP_CREATE_DT" = DBT_INTERNAL_SOURCE."EMP_CREATE_DT","EMP_LAST_UPDATE_DT" = DBT_INTERNAL_SOURCE."EMP_LAST_UPDATE_DT","MNGR_EMP_ID" = DBT_INTERNAL_SOURCE."MNGR_EMP_ID","MNGR_POSITION_LEVEL" = DBT_INTERNAL_SOURCE."MNGR_POSITION_LEVEL","EMP_FINANCIAL_YEAR_START" = DBT_INTERNAL_SOURCE."EMP_FINANCIAL_YEAR_START","EMP_START_OF_WEEK" = DBT_INTERNAL_SOURCE."EMP_START_OF_WEEK","WEEKLY_WORKING_DAYS" = DBT_INTERNAL_SOURCE."WEEKLY_WORKING_DAYS","EMP_ACTIVE" = DBT_INTERNAL_SOURCE."EMP_ACTIVE","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("EMPLOYEE_ID", "EMP_ACCOUNT_ID", "SOURCE_EMP_ID", "ENTITY_ID", "ORG_NAME", "EMPLOYEE_CODE", "FIRST_NAME", "MIDDLE_NAME", "LAST_NAME", "EMP_FULL_NM", "EMP_ROLE_NM", "EMP_POSITION_LEVEL", "EMP_GENDER", "EMP_PHONE_NUMBER", "EMP_EMAIL", "SALES_BRANCH_ID", "SALES_BRANCH_NAME", "SALES_REGION_ID", "SALES_REGION_NAME", "SALES_ZONE_ID", "SALES_ZONE_NAME", "BUSINESS_UNIT_ID", "BUSINESS_UNIT_NAME", "EMP_CREATE_DT", "EMP_LAST_UPDATE_DT", "MNGR_EMP_ID", "MNGR_POSITION_LEVEL", "EMP_FINANCIAL_YEAR_START", "EMP_START_OF_WEEK", "WEEKLY_WORKING_DAYS", "EMP_ACTIVE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("EMPLOYEE_ID", "EMP_ACCOUNT_ID", "SOURCE_EMP_ID", "ENTITY_ID", "ORG_NAME", "EMPLOYEE_CODE", "FIRST_NAME", "MIDDLE_NAME", "LAST_NAME", "EMP_FULL_NM", "EMP_ROLE_NM", "EMP_POSITION_LEVEL", "EMP_GENDER", "EMP_PHONE_NUMBER", "EMP_EMAIL", "SALES_BRANCH_ID", "SALES_BRANCH_NAME", "SALES_REGION_ID", "SALES_REGION_NAME", "SALES_ZONE_ID", "SALES_ZONE_NAME", "BUSINESS_UNIT_ID", "BUSINESS_UNIT_NAME", "EMP_CREATE_DT", "EMP_LAST_UPDATE_DT", "MNGR_EMP_ID", "MNGR_POSITION_LEVEL", "EMP_FINANCIAL_YEAR_START", "EMP_START_OF_WEEK", "WEEKLY_WORKING_DAYS", "EMP_ACTIVE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:15:59.204849 (Thread-1): Snowflake query id: 01994787-00f4-bdfc-0000-5eb100102552
2020-12-30 18:15:59.204990 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 158
invalid identifier 'EMP_ROLE_NM'
2020-12-30 18:15:59.205153 (Thread-1): finished collecting timing info
2020-12-30 18:15:59.205445 (Thread-1): On model.sales_dataflo.Dim_Employee: ROLLBACK
2020-12-30 18:15:59.320268 (Thread-1): On model.sales_dataflo.Dim_Employee: Close
2020-12-30 18:15:59.405193 (Thread-1): Database Error in model Dim_Employee (ETL/Target/Tables/Dim_Employee.sql)
  000904 (42000): SQL compilation error: error line 15 at position 158
  invalid identifier 'EMP_ROLE_NM'
  compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Employee.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 15 at position 158
invalid identifier 'EMP_ROLE_NM'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 120, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model Dim_Employee (ETL/Target/Tables/Dim_Employee.sql)
  000904 (42000): SQL compilation error: error line 15 at position 158
  invalid identifier 'EMP_ROLE_NM'
  compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Employee.sql
2020-12-30 18:15:59.407422 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ed51ca0>]}
2020-12-30 18:15:59.408542 (Thread-1): 18:15:59 | 2 of 29 ERROR creating incremental model dbt_salesdataflo.Dim_Employee [ERROR in 2.41s]
2020-12-30 18:15:59.408630 (Thread-1): Finished running node model.sales_dataflo.Dim_Employee
2020-12-30 18:15:59.408737 (Thread-1): Began running node model.sales_dataflo.Dim_Account
2020-12-30 18:15:59.409567 (Thread-1): 18:15:59 | 3 of 29 START incremental model dbt_salesdataflo.Dim_Account......... [RUN]
2020-12-30 18:15:59.409785 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:15:59.409859 (Thread-1): Compiling model.sales_dataflo.Dim_Account
2020-12-30 18:15:59.421238 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Account model triggered this warning. 
2020-12-30 18:15:59.424423 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Account"
2020-12-30 18:15:59.444681 (Thread-1): finished collecting timing info
2020-12-30 18:15:59.454547 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:15:59.454657 (Thread-1): On model.sales_dataflo.Dim_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Account"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account__dbt_tmp  as
      (



WITH source AS
 (
 select * from DBT_TEST_LIVEDATA_RK.Account
  ),
DIM_ACCOUNT as (
      select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
          'SF'  as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM source
    )
select * from DIM_ACCOUNT
      );
2020-12-30 18:15:59.454744 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:15:59.776029 (Thread-1160): handling poll request
2020-12-30 18:15:59.776454 (Thread-1160): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dcf50bb0>]}
2020-12-30 18:15:59.781558 (Thread-1160): sending response (<Response 23718 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:16:01.018486 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2020-12-30 18:16:01.021468 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:16:01.021569 (Thread-1): On model.sales_dataflo.Dim_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Account"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account__dbt_tmp
2020-12-30 18:16:01.104731 (Thread-1): SQL status: SUCCESS 12 in 0.08 seconds
2020-12-30 18:16:01.109215 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:16:01.109311 (Thread-1): On model.sales_dataflo.Dim_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Account"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account
2020-12-30 18:16:01.175252 (Thread-1): SQL status: SUCCESS 12 in 0.07 seconds
2020-12-30 18:16:01.178704 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:16:01.178791 (Thread-1): On model.sales_dataflo.Dim_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Account"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account
2020-12-30 18:16:01.237292 (Thread-1161): handling poll request
2020-12-30 18:16:01.237904 (Thread-1161): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6047910>]}
2020-12-30 18:16:01.239630 (Thread-1161): sending response (<Response 3921 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:16:01.253623 (Thread-1): SQL status: SUCCESS 12 in 0.07 seconds
2020-12-30 18:16:01.255915 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Account"
2020-12-30 18:16:01.278703 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:16:01.278814 (Thread-1): On model.sales_dataflo.Dim_Account: BEGIN
2020-12-30 18:16:01.414109 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-12-30 18:16:01.414249 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:16:01.414300 (Thread-1): On model.sales_dataflo.Dim_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Account"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.Account_ID = DBT_INTERNAL_DEST.Account_ID
        

    
    when matched then update set
        "ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","ACCOUNT_NAME" = DBT_INTERNAL_SOURCE."ACCOUNT_NAME","ACCOUNT_TYPE" = DBT_INTERNAL_SOURCE."ACCOUNT_TYPE","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","INDUSTRY" = DBT_INTERNAL_SOURCE."INDUSTRY","ANNUAL_REVENUE" = DBT_INTERNAL_SOURCE."ANNUAL_REVENUE","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","INITIAL_CREATE_DT" = DBT_INTERNAL_SOURCE."INITIAL_CREATE_DT","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("ACCOUNT_ID", "ACCOUNT_NAME", "ACCOUNT_TYPE", "SOURCE_ID", "ACTIVE_FLAG", "INDUSTRY", "ANNUAL_REVENUE", "EMPLOYEE_ID", "INITIAL_CREATE_DT", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("ACCOUNT_ID", "ACCOUNT_NAME", "ACCOUNT_TYPE", "SOURCE_ID", "ACTIVE_FLAG", "INDUSTRY", "ANNUAL_REVENUE", "EMPLOYEE_ID", "INITIAL_CREATE_DT", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:16:02.434762 (Thread-1): SQL status: SUCCESS 16234 in 1.02 seconds
2020-12-30 18:16:02.435736 (Thread-1): On model.sales_dataflo.Dim_Account: COMMIT
2020-12-30 18:16:02.435870 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:16:02.435918 (Thread-1): On model.sales_dataflo.Dim_Account: COMMIT
2020-12-30 18:16:02.637286 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-12-30 18:16:02.640465 (Thread-1): finished collecting timing info
2020-12-30 18:16:02.640704 (Thread-1): On model.sales_dataflo.Dim_Account: Close
2020-12-30 18:16:02.697016 (Thread-1162): handling poll request
2020-12-30 18:16:02.697525 (Thread-1162): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5b801f0>]}
2020-12-30 18:16:02.699563 (Thread-1162): sending response (<Response 6691 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:16:02.724976 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238efc17c0>]}
2020-12-30 18:16:02.727144 (Thread-1): 18:16:02 | 3 of 29 OK created incremental model dbt_salesdataflo.Dim_Account.... [SUCCESS 16234 in 3.31s]
2020-12-30 18:16:02.727314 (Thread-1): Finished running node model.sales_dataflo.Dim_Account
2020-12-30 18:16:02.727495 (Thread-1): Began running node model.sales_dataflo.Dim_Lead
2020-12-30 18:16:02.728947 (Thread-1): 18:16:02 | 4 of 29 START incremental model dbt_salesdataflo.Dim_Lead............ [RUN]
2020-12-30 18:16:02.729371 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:16:02.729503 (Thread-1): Compiling model.sales_dataflo.Dim_Lead
2020-12-30 18:16:02.745285 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Lead model triggered this warning. 
2020-12-30 18:16:02.748003 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Lead"
2020-12-30 18:16:02.766728 (Thread-1): finished collecting timing info
2020-12-30 18:16:02.773373 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:16:02.773456 (Thread-1): On model.sales_dataflo.Dim_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Lead"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead__dbt_tmp  as
      (



    WITH lead AS (
       select *  from DBT_TEST_LIVEDATA_RK.Lead
    ),opportunity as(
        select *  from DBT_TEST_LIVEDATA_RK.Opportunity 
    ),Dim_Lead as(
    SELECT
        md5(cast(
    
    coalesce(cast(lead.id as 
    varchar
), '')

 as 
    varchar
)) AS lead_id,
        lead.LEAD_SOURCE AS LEAD_SOURCE,
        lead.ID AS source_id,
        concat(COALESCE(lead.street,' ',lead.city,' ',lead.state,' ',lead.postal_code,' ',lead.country)) AS lead_contact_address,
        lead.STATUS AS STATUS,
        opportunity.STAGE_NAME AS STAGE_NAME,
        NULL AS product_id,
        NULL AS campaign_id,
        lead.IS_CONVERTED AS lead_to_opp_flag,
        null AS lead_lost_flag,
        lead.CONVERTED_DATE AS lead_CONVERTED_DATE,
        lead.CONVERTED_OPPORTUNITY_ID AS CONVERTED_OPPORTUNITY_ID,
        NULL AS lead_lost_dt,
        NULL AS lead_lost_reason,
        lead.INDUSTRY AS Industry,
        LEAD.owner_id AS employee_id,
        lead.CREATED_DATE as INITIAL_CREATE_DT,
        lead.LAST_MODIFIED_DATE as lead_LAST_MODIFIED_DATE,
          'SF'  as Source_type,
        'D_LEAD_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
        FROM
          lead left join opportunity on lead.CONVERTED_OPPORTUNITY_ID = opportunity.id 
    )    
 
select * from Dim_Lead
      );
2020-12-30 18:16:02.773517 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:04.122657 (Thread-1163): handling poll request
2020-12-30 18:16:04.123134 (Thread-1163): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d681da30>]}
2020-12-30 18:16:04.125215 (Thread-1163): sending response (<Response 7229 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:16:04.618041 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2020-12-30 18:16:04.620998 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:16:04.621131 (Thread-1): On model.sales_dataflo.Dim_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Lead"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead__dbt_tmp
2020-12-30 18:16:04.705404 (Thread-1): SQL status: SUCCESS 21 in 0.08 seconds
2020-12-30 18:16:04.709190 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:16:04.709274 (Thread-1): On model.sales_dataflo.Dim_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Lead"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead
2020-12-30 18:16:04.774117 (Thread-1): SQL status: SUCCESS 21 in 0.06 seconds
2020-12-30 18:16:04.778053 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:16:04.778142 (Thread-1): On model.sales_dataflo.Dim_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Lead"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead
2020-12-30 18:16:04.853715 (Thread-1): SQL status: SUCCESS 21 in 0.08 seconds
2020-12-30 18:16:04.856694 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Lead"
2020-12-30 18:16:04.877947 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:16:04.878043 (Thread-1): On model.sales_dataflo.Dim_Lead: BEGIN
2020-12-30 18:16:04.951165 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:16:04.951282 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:16:04.951332 (Thread-1): On model.sales_dataflo.Dim_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Lead"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.lead_id = DBT_INTERNAL_DEST.lead_id
        

    
    when matched then update set
        "LEAD_ID" = DBT_INTERNAL_SOURCE."LEAD_ID","LEAD_SOURCE" = DBT_INTERNAL_SOURCE."LEAD_SOURCE","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","LEAD_CONTACT_ADDRESS" = DBT_INTERNAL_SOURCE."LEAD_CONTACT_ADDRESS","STATUS" = DBT_INTERNAL_SOURCE."STATUS","STAGE_NAME" = DBT_INTERNAL_SOURCE."STAGE_NAME","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","LEAD_TO_OPP_FLAG" = DBT_INTERNAL_SOURCE."LEAD_TO_OPP_FLAG","LEAD_LOST_FLAG" = DBT_INTERNAL_SOURCE."LEAD_LOST_FLAG","LEAD_CONVERTED_DATE" = DBT_INTERNAL_SOURCE."LEAD_CONVERTED_DATE","CONVERTED_OPPORTUNITY_ID" = DBT_INTERNAL_SOURCE."CONVERTED_OPPORTUNITY_ID","LEAD_LOST_DT" = DBT_INTERNAL_SOURCE."LEAD_LOST_DT","LEAD_LOST_REASON" = DBT_INTERNAL_SOURCE."LEAD_LOST_REASON","INDUSTRY" = DBT_INTERNAL_SOURCE."INDUSTRY","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","INITIAL_CREATE_DT" = DBT_INTERNAL_SOURCE."INITIAL_CREATE_DT","LEAD_LAST_MODIFIED_DATE" = DBT_INTERNAL_SOURCE."LEAD_LAST_MODIFIED_DATE","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("LEAD_ID", "LEAD_SOURCE", "SOURCE_ID", "LEAD_CONTACT_ADDRESS", "STATUS", "STAGE_NAME", "PRODUCT_ID", "CAMPAIGN_ID", "LEAD_TO_OPP_FLAG", "LEAD_LOST_FLAG", "LEAD_CONVERTED_DATE", "CONVERTED_OPPORTUNITY_ID", "LEAD_LOST_DT", "LEAD_LOST_REASON", "INDUSTRY", "EMPLOYEE_ID", "INITIAL_CREATE_DT", "LEAD_LAST_MODIFIED_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("LEAD_ID", "LEAD_SOURCE", "SOURCE_ID", "LEAD_CONTACT_ADDRESS", "STATUS", "STAGE_NAME", "PRODUCT_ID", "CAMPAIGN_ID", "LEAD_TO_OPP_FLAG", "LEAD_LOST_FLAG", "LEAD_CONVERTED_DATE", "CONVERTED_OPPORTUNITY_ID", "LEAD_LOST_DT", "LEAD_LOST_REASON", "INDUSTRY", "EMPLOYEE_ID", "INITIAL_CREATE_DT", "LEAD_LAST_MODIFIED_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:16:05.600669 (Thread-1164): handling poll request
2020-12-30 18:16:05.601177 (Thread-1164): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d60df760>]}
2020-12-30 18:16:05.711369 (Thread-1164): sending response (<Response 8767 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:16:06.668397 (Thread-1): SQL status: SUCCESS 114992 in 1.72 seconds
2020-12-30 18:16:06.669386 (Thread-1): On model.sales_dataflo.Dim_Lead: COMMIT
2020-12-30 18:16:06.669516 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:16:06.669564 (Thread-1): On model.sales_dataflo.Dim_Lead: COMMIT
2020-12-30 18:16:06.901188 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-12-30 18:16:06.904236 (Thread-1): finished collecting timing info
2020-12-30 18:16:06.904451 (Thread-1): On model.sales_dataflo.Dim_Lead: Close
2020-12-30 18:16:06.980831 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ee0b280>]}
2020-12-30 18:16:06.981894 (Thread-1): 18:16:06 | 4 of 29 OK created incremental model dbt_salesdataflo.Dim_Lead....... [SUCCESS 114992 in 4.25s]
2020-12-30 18:16:06.981987 (Thread-1): Finished running node model.sales_dataflo.Dim_Lead
2020-12-30 18:16:06.982094 (Thread-1): Began running node model.sales_dataflo.Dim_Opportunity
2020-12-30 18:16:06.982874 (Thread-1): 18:16:06 | 5 of 29 START incremental model dbt_salesdataflo.Dim_Opportunity..... [RUN]
2020-12-30 18:16:06.983090 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:16:06.983162 (Thread-1): Compiling model.sales_dataflo.Dim_Opportunity
2020-12-30 18:16:06.991704 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity model triggered this warning. 
2020-12-30 18:16:06.993645 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Opportunity"
2020-12-30 18:16:07.014702 (Thread-1): finished collecting timing info
2020-12-30 18:16:07.022709 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:16:07.022786 (Thread-1): On model.sales_dataflo.Dim_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity__dbt_tmp  as
      (



    WITH OPPORTUNITY AS (
       select *  from DBT_TEST_LIVEDATA_RK.opportunity 
    ),contact AS(
        select *  from DBT_TEST_LIVEDATA_RK.contact    
    ),
    emp AS(
        select *  from DBT_TEST_LIVEDATA_RK.user    
    ),
    --OPPORTUNITY_LINE_ITEM AS(
    --      select OPPORTUNITY_ID,PRODUCT_2_ID ,PRODUCT_CODE,TOTAL_PRICE from DBT_TEST_LIVEDATA_RK.OPPORTUNITY_LINE_ITEM
     --),
    OPPORTUNITY_STAGE AS(
        select *  from DBT_TEST_LIVEDATA_RK.opportunity_stage  
    )
    ,Dim_Opportunity as(
    SELECT
        md5(cast(
    
    coalesce(cast(OPPORTUNITY.id as 
    varchar
), '')

 as 
    varchar
)) AS opportunity_id,
        OPPORTUNITY.NAME AS opportunity_NAME,
        OPPORTUNITY.TYPE AS opportunity_Type, 
        OPPORTUNITY.ACCOUNT_ID AS ACCOUNT_ID,        
        OPPORTUNITY.OWNER_ID AS employee_id,
        OPPORTUNITY.ID AS Source_id,
        OPPORTUNITY_STAGE.SORT_ORDER AS stage_id,
        OPPORTUNITY.IS_WON as IS_WON,
        OPPORTUNITY.IS_CLOSED as IS_CLOSED,
        OPPORTUNITY.stage_name AS stage_name,
        --   OPPORTUNITY.PROBABILITY as PROBABILITY,        
        OPPORTUNITY.FORECAST_CATEGORY as FORECAST_CATEGORY,
        OPPORTUNITY.AMOUNT AS AMOUNT,
        --OPPORTUNITY.EXPECTED_REVENUE as EXPECTED_REVENUE,
        NULL AS amount_without_disc,
        NULL AS expectd_Clouser_Dt,
        OPPORTUNITY.CONTACT_ID AS Contact_id,
        contact.NAME AS contact_name,
        contact.PHONE AS contact_number,
        contact.EMAIL AS contact_email,
        contact.MAILING_STREET AS contact_address,
        OPPORTUNITY.CREATED_DATE AS initial_create_dt,
        OPPORTUNITY.LAST_MODIFIED_DATE AS last_updated_dt,
        OPPORTUNITY.CLOSE_DATE AS CLOSE_DATE,
        NULL AS prospect_Dt,
        NULL AS stage_calc_id,
        OPPORTUNITY_STAGE.CREATED_DATE AS stage_start_dt,
        NULL AS stage_end_dt,        
        NULL AS lead_lost_reason,
        --OPPORTUNITY.CAMPAIGN_ID AS campaign_id,
        NULL AS competitor,
        NULL AS on_hold_flag,
        --OPPORTUNITY_LINE_ITEM. PRODUCT_2_ID AS product_id,
        --OPPORTUNITY_LINE_ITEM. PRODUCT_CODE AS product_name,
        NULL AS sub_product_id,
        NULL AS sub_product_name,
        --OPPORTUNITY_LINE_ITEM. TOTAL_PRICE AS product_amount,
        NULL AS prd_amount_without_disc,
        NULL AS prd_discount,
        OPPORTUNITY. IS_DELETED AS active_flag,
        NULL AS DW_CURR_FLG,
        NULL AS EFFCT_START_DATE,
        NULL AS EFFCT_END_DATE,
          'SF'  as Source_type,
        'D_OPPORTUNITY_DIM_LOAD'  AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
      FROM
        OPPORTUNITY 
        left join emp on OPPORTUNITY.Owner_id  =  emp.id
        left join contact on emp.contact_id  =  contact.id
        --left join OPPORTUNITY_LINE_ITEM on OPPORTUNITY.ID = OPPORTUNITY_LINE_ITEM.OPPORTUNITY_ID
        left join OPPORTUNITY_STAGE on OPPORTUNITY.stage_name = OPPORTUNITY_STAGE.MASTER_LABEL
     
    )    
    

select * from Dim_Opportunity
      );
2020-12-30 18:16:07.022845 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:07.238958 (Thread-1165): handling poll request
2020-12-30 18:16:07.239425 (Thread-1165): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d646ffa0>]}
2020-12-30 18:16:07.241914 (Thread-1165): sending response (<Response 11482 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:16:08.714191 (Thread-1166): handling poll request
2020-12-30 18:16:08.714686 (Thread-1166): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d646fd60>]}
2020-12-30 18:16:08.715595 (Thread-1166): sending response (<Response 285 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:16:09.097592 (Thread-1): SQL status: SUCCESS 1 in 2.07 seconds
2020-12-30 18:16:09.101189 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:16:09.101278 (Thread-1): On model.sales_dataflo.Dim_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity__dbt_tmp
2020-12-30 18:16:09.185682 (Thread-1): SQL status: SUCCESS 40 in 0.08 seconds
2020-12-30 18:16:09.190581 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:16:09.190677 (Thread-1): On model.sales_dataflo.Dim_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity
2020-12-30 18:16:09.253114 (Thread-1): SQL status: SUCCESS 40 in 0.06 seconds
2020-12-30 18:16:09.258064 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:16:09.258155 (Thread-1): On model.sales_dataflo.Dim_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity
2020-12-30 18:16:09.320690 (Thread-1): SQL status: SUCCESS 40 in 0.06 seconds
2020-12-30 18:16:09.326846 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Opportunity"
2020-12-30 18:16:09.349365 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:16:09.349523 (Thread-1): On model.sales_dataflo.Dim_Opportunity: BEGIN
2020-12-30 18:16:09.421099 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:16:09.421243 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:16:09.421292 (Thread-1): On model.sales_dataflo.Dim_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.opportunity_id = DBT_INTERNAL_DEST.opportunity_id
        

    
    when matched then update set
        "OPPORTUNITY_ID" = DBT_INTERNAL_SOURCE."OPPORTUNITY_ID","OPPORTUNITY_NAME" = DBT_INTERNAL_SOURCE."OPPORTUNITY_NAME","OPPORTUNITY_TYPE" = DBT_INTERNAL_SOURCE."OPPORTUNITY_TYPE","ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","STAGE_ID" = DBT_INTERNAL_SOURCE."STAGE_ID","IS_WON" = DBT_INTERNAL_SOURCE."IS_WON","IS_CLOSED" = DBT_INTERNAL_SOURCE."IS_CLOSED","STAGE_NAME" = DBT_INTERNAL_SOURCE."STAGE_NAME","FORECAST_CATEGORY" = DBT_INTERNAL_SOURCE."FORECAST_CATEGORY","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AMOUNT_WITHOUT_DISC" = DBT_INTERNAL_SOURCE."AMOUNT_WITHOUT_DISC","EXPECTD_CLOUSER_DT" = DBT_INTERNAL_SOURCE."EXPECTD_CLOUSER_DT","CONTACT_ID" = DBT_INTERNAL_SOURCE."CONTACT_ID","CONTACT_NAME" = DBT_INTERNAL_SOURCE."CONTACT_NAME","CONTACT_NUMBER" = DBT_INTERNAL_SOURCE."CONTACT_NUMBER","CONTACT_EMAIL" = DBT_INTERNAL_SOURCE."CONTACT_EMAIL","CONTACT_ADDRESS" = DBT_INTERNAL_SOURCE."CONTACT_ADDRESS","INITIAL_CREATE_DT" = DBT_INTERNAL_SOURCE."INITIAL_CREATE_DT","LAST_UPDATED_DT" = DBT_INTERNAL_SOURCE."LAST_UPDATED_DT","CLOSE_DATE" = DBT_INTERNAL_SOURCE."CLOSE_DATE","PROSPECT_DT" = DBT_INTERNAL_SOURCE."PROSPECT_DT","STAGE_CALC_ID" = DBT_INTERNAL_SOURCE."STAGE_CALC_ID","STAGE_START_DT" = DBT_INTERNAL_SOURCE."STAGE_START_DT","STAGE_END_DT" = DBT_INTERNAL_SOURCE."STAGE_END_DT","LEAD_LOST_REASON" = DBT_INTERNAL_SOURCE."LEAD_LOST_REASON","COMPETITOR" = DBT_INTERNAL_SOURCE."COMPETITOR","ON_HOLD_FLAG" = DBT_INTERNAL_SOURCE."ON_HOLD_FLAG","SUB_PRODUCT_ID" = DBT_INTERNAL_SOURCE."SUB_PRODUCT_ID","SUB_PRODUCT_NAME" = DBT_INTERNAL_SOURCE."SUB_PRODUCT_NAME","PRD_AMOUNT_WITHOUT_DISC" = DBT_INTERNAL_SOURCE."PRD_AMOUNT_WITHOUT_DISC","PRD_DISCOUNT" = DBT_INTERNAL_SOURCE."PRD_DISCOUNT","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","DW_CURR_FLG" = DBT_INTERNAL_SOURCE."DW_CURR_FLG","EFFCT_START_DATE" = DBT_INTERNAL_SOURCE."EFFCT_START_DATE","EFFCT_END_DATE" = DBT_INTERNAL_SOURCE."EFFCT_END_DATE","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("OPPORTUNITY_ID", "OPPORTUNITY_NAME", "OPPORTUNITY_TYPE", "ACCOUNT_ID", "EMPLOYEE_ID", "SOURCE_ID", "STAGE_ID", "IS_WON", "IS_CLOSED", "STAGE_NAME", "FORECAST_CATEGORY", "AMOUNT", "AMOUNT_WITHOUT_DISC", "EXPECTD_CLOUSER_DT", "CONTACT_ID", "CONTACT_NAME", "CONTACT_NUMBER", "CONTACT_EMAIL", "CONTACT_ADDRESS", "INITIAL_CREATE_DT", "LAST_UPDATED_DT", "CLOSE_DATE", "PROSPECT_DT", "STAGE_CALC_ID", "STAGE_START_DT", "STAGE_END_DT", "LEAD_LOST_REASON", "COMPETITOR", "ON_HOLD_FLAG", "SUB_PRODUCT_ID", "SUB_PRODUCT_NAME", "PRD_AMOUNT_WITHOUT_DISC", "PRD_DISCOUNT", "ACTIVE_FLAG", "DW_CURR_FLG", "EFFCT_START_DATE", "EFFCT_END_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("OPPORTUNITY_ID", "OPPORTUNITY_NAME", "OPPORTUNITY_TYPE", "ACCOUNT_ID", "EMPLOYEE_ID", "SOURCE_ID", "STAGE_ID", "IS_WON", "IS_CLOSED", "STAGE_NAME", "FORECAST_CATEGORY", "AMOUNT", "AMOUNT_WITHOUT_DISC", "EXPECTD_CLOUSER_DT", "CONTACT_ID", "CONTACT_NAME", "CONTACT_NUMBER", "CONTACT_EMAIL", "CONTACT_ADDRESS", "INITIAL_CREATE_DT", "LAST_UPDATED_DT", "CLOSE_DATE", "PROSPECT_DT", "STAGE_CALC_ID", "STAGE_START_DT", "STAGE_END_DT", "LEAD_LOST_REASON", "COMPETITOR", "ON_HOLD_FLAG", "SUB_PRODUCT_ID", "SUB_PRODUCT_NAME", "PRD_AMOUNT_WITHOUT_DISC", "PRD_DISCOUNT", "ACTIVE_FLAG", "DW_CURR_FLG", "EFFCT_START_DATE", "EFFCT_END_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:16:10.218545 (Thread-1167): handling poll request
2020-12-30 18:16:10.219048 (Thread-1167): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dcc80d30>]}
2020-12-30 18:16:10.221675 (Thread-1167): sending response (<Response 10813 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:16:11.644978 (Thread-1): SQL status: SUCCESS 11459 in 2.22 seconds
2020-12-30 18:16:11.646498 (Thread-1): On model.sales_dataflo.Dim_Opportunity: COMMIT
2020-12-30 18:16:11.646684 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:16:11.646775 (Thread-1): On model.sales_dataflo.Dim_Opportunity: COMMIT
2020-12-30 18:16:11.721334 (Thread-1168): handling poll request
2020-12-30 18:16:11.721766 (Thread-1168): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc58ce80>]}
2020-12-30 18:16:11.722992 (Thread-1168): sending response (<Response 1619 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:16:11.861173 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-12-30 18:16:11.866639 (Thread-1): finished collecting timing info
2020-12-30 18:16:11.867003 (Thread-1): On model.sales_dataflo.Dim_Opportunity: Close
2020-12-30 18:16:11.940836 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238f03bee0>]}
2020-12-30 18:16:11.942753 (Thread-1): 18:16:11 | 5 of 29 OK created incremental model dbt_salesdataflo.Dim_Opportunity [SUCCESS 11459 in 4.96s]
2020-12-30 18:16:11.942903 (Thread-1): Finished running node model.sales_dataflo.Dim_Opportunity
2020-12-30 18:16:11.943075 (Thread-1): Began running node model.sales_dataflo.Dim_Contact
2020-12-30 18:16:11.944475 (Thread-1): 18:16:11 | 6 of 29 START incremental model dbt_salesdataflo.Dim_Contact......... [RUN]
2020-12-30 18:16:11.944807 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:16:11.944934 (Thread-1): Compiling model.sales_dataflo.Dim_Contact
2020-12-30 18:16:11.958491 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Contact model triggered this warning. 
2020-12-30 18:16:11.962131 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Contact"
2020-12-30 18:16:11.981002 (Thread-1): finished collecting timing info
2020-12-30 18:16:11.991806 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:16:11.991943 (Thread-1): On model.sales_dataflo.Dim_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Contact"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact__dbt_tmp  as
      (



WITH contacts AS (
       select *  from DBT_TEST_LIVEDATA_RK.Contact 
    ),
Dim_Contact as(
      SELECT 
        md5(cast(
    
    coalesce(cast(contacts.id as 
    varchar
), '')

 as 
    varchar
)) AS contact_id, 
        contacts.salutation AS salutation, 
        contacts.NAME AS contact_name, 
        contacts.last_name AS last_name, 
        contacts.first_name AS first_name, 
        contacts.phone AS contact_number, 
        contacts.mobile_phone AS mobile_phone, 
        contacts.home_phone AS home_phone, 
        contacts.email AS contact_email, 
        contacts.id AS source_id, 
        contacts.department AS department, 
        contacts.lead_source AS lead_source, 
        null AS organization_id, 
        contacts.owner_ID AS employee_id, 
        contacts.account_id AS account_id, 
        NULL AS contact_age_group, 
        NULL AS contact_income, 
        NULL AS dependent, 
        NULL AS contact_type, 
        contacts.IS_DELETED AS active,
        CREATED_DATE as INITIAL_CREATE_DT,
          'SF'  as Source_type,
        'D_CONTACT_DIM_LOAD' AS dw_session_nm, 
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
     FROM 
       contacts
    )    
    
select * from Dim_Contact
      );
2020-12-30 18:16:11.992042 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:13.199168 (Thread-1169): handling poll request
2020-12-30 18:16:13.199613 (Thread-1169): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d769fd60>]}
2020-12-30 18:16:13.202054 (Thread-1169): sending response (<Response 8326 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:16:14.170430 (Thread-1): SQL status: SUCCESS 1 in 2.18 seconds
2020-12-30 18:16:14.173394 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:16:14.173494 (Thread-1): On model.sales_dataflo.Dim_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Contact"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact__dbt_tmp
2020-12-30 18:16:14.254561 (Thread-1): SQL status: SUCCESS 24 in 0.08 seconds
2020-12-30 18:16:14.258555 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:16:14.258644 (Thread-1): On model.sales_dataflo.Dim_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Contact"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact
2020-12-30 18:16:14.313473 (Thread-1): SQL status: SUCCESS 24 in 0.05 seconds
2020-12-30 18:16:14.317625 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:16:14.317712 (Thread-1): On model.sales_dataflo.Dim_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Contact"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact
2020-12-30 18:16:14.380974 (Thread-1): SQL status: SUCCESS 24 in 0.06 seconds
2020-12-30 18:16:14.384143 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Contact"
2020-12-30 18:16:14.405343 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:16:14.405433 (Thread-1): On model.sales_dataflo.Dim_Contact: BEGIN
2020-12-30 18:16:14.471525 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:16:14.471641 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:16:14.471691 (Thread-1): On model.sales_dataflo.Dim_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Contact"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.contact_id = DBT_INTERNAL_DEST.contact_id
        

    
    when matched then update set
        "CONTACT_ID" = DBT_INTERNAL_SOURCE."CONTACT_ID","SALUTATION" = DBT_INTERNAL_SOURCE."SALUTATION","CONTACT_NAME" = DBT_INTERNAL_SOURCE."CONTACT_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","CONTACT_NUMBER" = DBT_INTERNAL_SOURCE."CONTACT_NUMBER","MOBILE_PHONE" = DBT_INTERNAL_SOURCE."MOBILE_PHONE","HOME_PHONE" = DBT_INTERNAL_SOURCE."HOME_PHONE","CONTACT_EMAIL" = DBT_INTERNAL_SOURCE."CONTACT_EMAIL","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","DEPARTMENT" = DBT_INTERNAL_SOURCE."DEPARTMENT","LEAD_SOURCE" = DBT_INTERNAL_SOURCE."LEAD_SOURCE","ORGANIZATION_ID" = DBT_INTERNAL_SOURCE."ORGANIZATION_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","CONTACT_AGE_GROUP" = DBT_INTERNAL_SOURCE."CONTACT_AGE_GROUP","CONTACT_INCOME" = DBT_INTERNAL_SOURCE."CONTACT_INCOME","DEPENDENT" = DBT_INTERNAL_SOURCE."DEPENDENT","CONTACT_TYPE" = DBT_INTERNAL_SOURCE."CONTACT_TYPE","ACTIVE" = DBT_INTERNAL_SOURCE."ACTIVE","INITIAL_CREATE_DT" = DBT_INTERNAL_SOURCE."INITIAL_CREATE_DT","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("CONTACT_ID", "SALUTATION", "CONTACT_NAME", "LAST_NAME", "FIRST_NAME", "CONTACT_NUMBER", "MOBILE_PHONE", "HOME_PHONE", "CONTACT_EMAIL", "SOURCE_ID", "DEPARTMENT", "LEAD_SOURCE", "ORGANIZATION_ID", "EMPLOYEE_ID", "ACCOUNT_ID", "CONTACT_AGE_GROUP", "CONTACT_INCOME", "DEPENDENT", "CONTACT_TYPE", "ACTIVE", "INITIAL_CREATE_DT", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("CONTACT_ID", "SALUTATION", "CONTACT_NAME", "LAST_NAME", "FIRST_NAME", "CONTACT_NUMBER", "MOBILE_PHONE", "HOME_PHONE", "CONTACT_EMAIL", "SOURCE_ID", "DEPARTMENT", "LEAD_SOURCE", "ORGANIZATION_ID", "EMPLOYEE_ID", "ACCOUNT_ID", "CONTACT_AGE_GROUP", "CONTACT_INCOME", "DEPENDENT", "CONTACT_TYPE", "ACTIVE", "INITIAL_CREATE_DT", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:16:14.645736 (Thread-1170): handling poll request
2020-12-30 18:16:14.646175 (Thread-1170): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d769ffa0>]}
2020-12-30 18:16:14.648348 (Thread-1170): sending response (<Response 9001 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:16:16.049825 (Thread-1171): handling poll request
2020-12-30 18:16:16.050430 (Thread-1171): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d646f7c0>]}
2020-12-30 18:16:16.051764 (Thread-1171): sending response (<Response 285 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:16:17.489415 (Thread-1172): handling poll request
2020-12-30 18:16:17.489830 (Thread-1172): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d646fe80>]}
2020-12-30 18:16:17.490695 (Thread-1172): sending response (<Response 285 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:16:18.141171 (Thread-1): SQL status: SUCCESS 237706 in 3.67 seconds
2020-12-30 18:16:18.142421 (Thread-1): On model.sales_dataflo.Dim_Contact: COMMIT
2020-12-30 18:16:18.142549 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:16:18.142596 (Thread-1): On model.sales_dataflo.Dim_Contact: COMMIT
2020-12-30 18:16:18.358549 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-12-30 18:16:18.361618 (Thread-1): finished collecting timing info
2020-12-30 18:16:18.361834 (Thread-1): On model.sales_dataflo.Dim_Contact: Close
2020-12-30 18:16:18.444059 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238f0126d0>]}
2020-12-30 18:16:18.445132 (Thread-1): 18:16:18 | 6 of 29 OK created incremental model dbt_salesdataflo.Dim_Contact.... [SUCCESS 237706 in 6.50s]
2020-12-30 18:16:18.445229 (Thread-1): Finished running node model.sales_dataflo.Dim_Contact
2020-12-30 18:16:18.445341 (Thread-1): Began running node model.sales_dataflo.Dim_Address
2020-12-30 18:16:18.446159 (Thread-1): 18:16:18 | 7 of 29 START table model dbt_salesdataflo.Dim_Address............... [RUN]
2020-12-30 18:16:18.446379 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-30 18:16:18.446451 (Thread-1): Compiling model.sales_dataflo.Dim_Address
2020-12-30 18:16:18.454938 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-30 18:16:18.456198 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-30 18:16:18.458026 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Address"
2020-12-30 18:16:18.478449 (Thread-1): finished collecting timing info
2020-12-30 18:16:18.482645 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Address"
2020-12-30 18:16:18.502450 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-30 18:16:18.502533 (Thread-1): On model.sales_dataflo.Dim_Address: BEGIN
2020-12-30 18:16:18.502593 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:19.013332 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-12-30 18:16:19.013483 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-30 18:16:19.013534 (Thread-1): On model.sales_dataflo.Dim_Address: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Address"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Address  as
      (



WITH source AS (
       select *  from DBT_TEST_LIVEDATA_RK.Contact 
    ),Dim_Address AS(
        SELECT 
            md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
)) AS  address_id,
            account_id AS account_id,
            id as source_id,
            MAILING_STREET AS STREET,
            MAILING_CITY AS CITY,
            MAILING_STATE AS STATE,
            MAILING_POSTAL_CODE AS POSTAL_CODE,
            MAILING_COUNTRY AS COUNTRY,
            'Billing' as address_type,
              'SF'  as Source_type,
             'D_ADDRESS_DIM_LOAD' AS DW_SESSION_NM,
            
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
            from source
        union 
        SELECT
            md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
)) AS  address_id,
            account_id AS account_id,
            id as source_id,
            OTHER_STREET AS STREET,
            OTHER_CITY AS CITY,
            OTHER_STATE AS STATE,
            OTHER_POSTAL_CODE AS POSTAL_CODE,
            OTHER_COUNTRY As COUNTRY, 
            'Shipping' as address_type,
              'SF'  as Source_type,
             'D_ADDRESS_DIM_LOAD' AS DW_SESSION_NM,
            
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
             from source
    )
    
select * from Dim_Address
      );
2020-12-30 18:16:19.021763 (Thread-1173): handling poll request
2020-12-30 18:16:19.022184 (Thread-1173): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc271ca0>]}
2020-12-30 18:16:19.025153 (Thread-1173): sending response (<Response 11581 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:16:20.503197 (Thread-1174): handling poll request
2020-12-30 18:16:20.503618 (Thread-1174): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc44a3d0>]}
2020-12-30 18:16:20.504488 (Thread-1174): sending response (<Response 285 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:16:21.439883 (Thread-1): SQL status: SUCCESS 1 in 2.43 seconds
2020-12-30 18:16:21.440871 (Thread-1): On model.sales_dataflo.Dim_Address: COMMIT
2020-12-30 18:16:21.440993 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-30 18:16:21.441041 (Thread-1): On model.sales_dataflo.Dim_Address: COMMIT
2020-12-30 18:16:21.497842 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:16:21.499800 (Thread-1): finished collecting timing info
2020-12-30 18:16:21.500017 (Thread-1): On model.sales_dataflo.Dim_Address: Close
2020-12-30 18:16:21.565482 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238f0a7400>]}
2020-12-30 18:16:21.566539 (Thread-1): 18:16:21 | 7 of 29 OK created table model dbt_salesdataflo.Dim_Address.......... [SUCCESS 1 in 3.12s]
2020-12-30 18:16:21.566631 (Thread-1): Finished running node model.sales_dataflo.Dim_Address
2020-12-30 18:16:21.566742 (Thread-1): Began running node model.sales_dataflo.Dim_Campaign
2020-12-30 18:16:21.567543 (Thread-1): 18:16:21 | 8 of 29 START incremental model dbt_salesdataflo.Dim_Campaign........ [RUN]
2020-12-30 18:16:21.567757 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:16:21.567829 (Thread-1): Compiling model.sales_dataflo.Dim_Campaign
2020-12-30 18:16:21.577275 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Campaign model triggered this warning. 
2020-12-30 18:16:21.579181 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Campaign"
2020-12-30 18:16:21.599875 (Thread-1): finished collecting timing info
2020-12-30 18:16:21.606129 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:16:21.606207 (Thread-1): On model.sales_dataflo.Dim_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Campaign"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign__dbt_tmp  as
      (



WITH source AS (
    select * from DBT_TEST_LIVEDATA_RK.Campaign 
    ),
Dim_Campaign as (

      SELECT
        NULL AS Account_ID,
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
)) AS Campaign_ID,
        NAME AS Campaign_Name,
        IS_ACTIVE AS active_flag,
        ID AS Source_ID,
        TYPE AS TYPE,
        STATUS AS STATUS,
        START_DATE AS START_DATE,
        END_DATE AS END_DATE,
        EXPECTED_REVENUE AS EXPECTED_REVENUE,
        BUDGETED_COST AS BUDGETED_COST,
        ACTUAL_COST AS ACTUAL_COST,
        EXPECTED_RESPONSE AS EXPECTED_RESPONSE,
        NUMBER_SENT AS NUMBER_SENT,
        NUMBER_OF_LEADS AS NUMBER_OF_LEADS,
        NUMBER_OF_CONVERTED_LEADS AS NUMBER_OF_CONVERTED_LEADS,
        NUMBER_OF_CONTACTS AS NUMBER_OF_CONTACTS,
        NUMBER_OF_RESPONSES AS NUMBER_OF_RESPONSES,
        NUMBER_OF_OPPORTUNITIES AS NUMBER_OF_OPPORTUNITIES,
        NUMBER_OF_WON_OPPORTUNITIES AS NUMBER_OF_WON_OPPORTUNITIES,
        AMOUNT_ALL_OPPORTUNITIES AS AMOUNT_ALL_OPPORTUNITIES,
        AMOUNT_WON_OPPORTUNITIES AS AMOUNT_WON_OPPORTUNITIES,
           'SF'  as Source_type,
        'D_CAMPAIGN_DIM_LOAD'  AS 	DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
     FROM
        source     
      )

  select * from  Dim_Campaign
      );
2020-12-30 18:16:21.606267 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:22.207681 (Thread-1175): handling poll request
2020-12-30 18:16:22.208122 (Thread-1175): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc44af70>]}
2020-12-30 18:16:22.210770 (Thread-1175): sending response (<Response 9706 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:16:22.664879 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2020-12-30 18:16:22.668510 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:16:22.668608 (Thread-1): On model.sales_dataflo.Dim_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Campaign"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign__dbt_tmp
2020-12-30 18:16:22.750219 (Thread-1): SQL status: SUCCESS 25 in 0.08 seconds
2020-12-30 18:16:22.754217 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:16:22.754303 (Thread-1): On model.sales_dataflo.Dim_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Campaign"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign
2020-12-30 18:16:22.848558 (Thread-1): SQL status: SUCCESS 25 in 0.09 seconds
2020-12-30 18:16:22.852867 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:16:22.852965 (Thread-1): On model.sales_dataflo.Dim_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Campaign"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign
2020-12-30 18:16:22.912126 (Thread-1): SQL status: SUCCESS 25 in 0.06 seconds
2020-12-30 18:16:22.915574 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Campaign"
2020-12-30 18:16:22.936968 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:16:22.937118 (Thread-1): On model.sales_dataflo.Dim_Campaign: BEGIN
2020-12-30 18:16:23.010029 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:16:23.010167 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:16:23.010218 (Thread-1): On model.sales_dataflo.Dim_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Campaign"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.Campaign_ID = DBT_INTERNAL_DEST.Campaign_ID
        

    
    when matched then update set
        "ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","CAMPAIGN_NAME" = DBT_INTERNAL_SOURCE."CAMPAIGN_NAME","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","TYPE" = DBT_INTERNAL_SOURCE."TYPE","STATUS" = DBT_INTERNAL_SOURCE."STATUS","START_DATE" = DBT_INTERNAL_SOURCE."START_DATE","END_DATE" = DBT_INTERNAL_SOURCE."END_DATE","EXPECTED_REVENUE" = DBT_INTERNAL_SOURCE."EXPECTED_REVENUE","BUDGETED_COST" = DBT_INTERNAL_SOURCE."BUDGETED_COST","ACTUAL_COST" = DBT_INTERNAL_SOURCE."ACTUAL_COST","EXPECTED_RESPONSE" = DBT_INTERNAL_SOURCE."EXPECTED_RESPONSE","NUMBER_SENT" = DBT_INTERNAL_SOURCE."NUMBER_SENT","NUMBER_OF_LEADS" = DBT_INTERNAL_SOURCE."NUMBER_OF_LEADS","NUMBER_OF_CONVERTED_LEADS" = DBT_INTERNAL_SOURCE."NUMBER_OF_CONVERTED_LEADS","NUMBER_OF_CONTACTS" = DBT_INTERNAL_SOURCE."NUMBER_OF_CONTACTS","NUMBER_OF_RESPONSES" = DBT_INTERNAL_SOURCE."NUMBER_OF_RESPONSES","NUMBER_OF_OPPORTUNITIES" = DBT_INTERNAL_SOURCE."NUMBER_OF_OPPORTUNITIES","NUMBER_OF_WON_OPPORTUNITIES" = DBT_INTERNAL_SOURCE."NUMBER_OF_WON_OPPORTUNITIES","AMOUNT_ALL_OPPORTUNITIES" = DBT_INTERNAL_SOURCE."AMOUNT_ALL_OPPORTUNITIES","AMOUNT_WON_OPPORTUNITIES" = DBT_INTERNAL_SOURCE."AMOUNT_WON_OPPORTUNITIES","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("ACCOUNT_ID", "CAMPAIGN_ID", "CAMPAIGN_NAME", "ACTIVE_FLAG", "SOURCE_ID", "TYPE", "STATUS", "START_DATE", "END_DATE", "EXPECTED_REVENUE", "BUDGETED_COST", "ACTUAL_COST", "EXPECTED_RESPONSE", "NUMBER_SENT", "NUMBER_OF_LEADS", "NUMBER_OF_CONVERTED_LEADS", "NUMBER_OF_CONTACTS", "NUMBER_OF_RESPONSES", "NUMBER_OF_OPPORTUNITIES", "NUMBER_OF_WON_OPPORTUNITIES", "AMOUNT_ALL_OPPORTUNITIES", "AMOUNT_WON_OPPORTUNITIES", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("ACCOUNT_ID", "CAMPAIGN_ID", "CAMPAIGN_NAME", "ACTIVE_FLAG", "SOURCE_ID", "TYPE", "STATUS", "START_DATE", "END_DATE", "EXPECTED_REVENUE", "BUDGETED_COST", "ACTUAL_COST", "EXPECTED_RESPONSE", "NUMBER_SENT", "NUMBER_OF_LEADS", "NUMBER_OF_CONVERTED_LEADS", "NUMBER_OF_CONTACTS", "NUMBER_OF_RESPONSES", "NUMBER_OF_OPPORTUNITIES", "NUMBER_OF_WON_OPPORTUNITIES", "AMOUNT_ALL_OPPORTUNITIES", "AMOUNT_WON_OPPORTUNITIES", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:16:23.566427 (Thread-1): SQL status: SUCCESS 1268 in 0.56 seconds
2020-12-30 18:16:23.567646 (Thread-1): On model.sales_dataflo.Dim_Campaign: COMMIT
2020-12-30 18:16:23.567770 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:16:23.567816 (Thread-1): On model.sales_dataflo.Dim_Campaign: COMMIT
2020-12-30 18:16:23.703636 (Thread-1176): handling poll request
2020-12-30 18:16:23.704065 (Thread-1176): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d66cba30>]}
2020-12-30 18:16:23.706579 (Thread-1176): sending response (<Response 10733 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:16:23.772455 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-12-30 18:16:23.775556 (Thread-1): finished collecting timing info
2020-12-30 18:16:23.775782 (Thread-1): On model.sales_dataflo.Dim_Campaign: Close
2020-12-30 18:16:24.297342 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ee5d7f0>]}
2020-12-30 18:16:24.298453 (Thread-1): 18:16:24 | 8 of 29 OK created incremental model dbt_salesdataflo.Dim_Campaign... [SUCCESS 1268 in 2.73s]
2020-12-30 18:16:24.298553 (Thread-1): Finished running node model.sales_dataflo.Dim_Campaign
2020-12-30 18:16:24.298658 (Thread-1): Began running node model.sales_dataflo.Dim_Entity
2020-12-30 18:16:24.299553 (Thread-1): 18:16:24 | 9 of 29 START table model dbt_salesdataflo.Dim_Entity................ [RUN]
2020-12-30 18:16:24.299798 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-30 18:16:24.299874 (Thread-1): Compiling model.sales_dataflo.Dim_Entity
2020-12-30 18:16:24.306466 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Entity"
2020-12-30 18:16:24.325903 (Thread-1): finished collecting timing info
2020-12-30 18:16:24.331417 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Entity"
2020-12-30 18:16:24.351764 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-30 18:16:24.351846 (Thread-1): On model.sales_dataflo.Dim_Entity: BEGIN
2020-12-30 18:16:24.351905 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:24.887498 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2020-12-30 18:16:24.887643 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-30 18:16:24.887696 (Thread-1): On model.sales_dataflo.Dim_Entity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Entity"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Entity  as
      (

select * from (
Select 1 entity_id,'DBT_TEST_LIVEDATA_RK' entity_name,'D_ENTITY_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 2 entity_id,'SALESFORCE_FREETRAILS' entity_name,'D_ENTITY_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
)
      );
2020-12-30 18:16:25.160208 (Thread-1177): handling poll request
2020-12-30 18:16:25.160617 (Thread-1177): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dc5ac5e0>]}
2020-12-30 18:16:25.163007 (Thread-1177): sending response (<Response 8021 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:16:25.558897 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2020-12-30 18:16:25.559864 (Thread-1): On model.sales_dataflo.Dim_Entity: COMMIT
2020-12-30 18:16:25.559977 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-30 18:16:25.560024 (Thread-1): On model.sales_dataflo.Dim_Entity: COMMIT
2020-12-30 18:16:25.616543 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:16:25.618663 (Thread-1): finished collecting timing info
2020-12-30 18:16:25.618869 (Thread-1): On model.sales_dataflo.Dim_Entity: Close
2020-12-30 18:16:25.681782 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e9b2d90>]}
2020-12-30 18:16:25.682978 (Thread-1): 18:16:25 | 9 of 29 OK created table model dbt_salesdataflo.Dim_Entity........... [SUCCESS 1 in 1.38s]
2020-12-30 18:16:25.683080 (Thread-1): Finished running node model.sales_dataflo.Dim_Entity
2020-12-30 18:16:25.683193 (Thread-1): Began running node model.sales_dataflo.Dim_Opportunity_Stage
2020-12-30 18:16:25.684057 (Thread-1): 18:16:25 | 10 of 29 START incremental model dbt_salesdataflo.Dim_Opportunity_Stage [RUN]
2020-12-30 18:16:25.684310 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:16:25.684391 (Thread-1): Compiling model.sales_dataflo.Dim_Opportunity_Stage
2020-12-30 18:16:25.692949 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity_Stage model triggered this warning. 
2020-12-30 18:16:25.695030 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Opportunity_Stage"
2020-12-30 18:16:25.714281 (Thread-1): finished collecting timing info
2020-12-30 18:16:25.720056 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:16:25.720132 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity_Stage"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage__dbt_tmp  as
      (



WITH source AS (
       select *  from DBT_TEST_LIVEDATA_RK.Opportunity_stage 
    ),Dim_Opportunity_stage as(
        SELECT
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS stage_id,
        MASTER_LABEL AS stage_name,
        SORT_ORDER AS stage_position,
        NULL AS account_id,
        IS_ACTIVE AS active_flag,
        ID AS Source_id,
        FORECAST_CATEGORY AS FORECAST_CATEGORY,
        NULL AS lead_opp_flag,
        IS_CLOSED AS IS_CLOSED,
        IS_WON AS IS_WON,
        DEFAULT_PROBABILITY AS OPPORTUNITY_STAGE,
          'SF'  as Source_type,
        'D_OPPORTUNITYSTAGES_DIM_LOAD'  AS 	DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
     FROM
       source
    )    

select * from Dim_Opportunity_stage
      );
2020-12-30 18:16:25.720191 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:26.624868 (Thread-1178): handling poll request
2020-12-30 18:16:26.625343 (Thread-1178): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6879250>]}
2020-12-30 18:16:26.627933 (Thread-1178): sending response (<Response 9358 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:16:26.788955 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2020-12-30 18:16:26.791895 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:16:26.791995 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity_Stage"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage__dbt_tmp
2020-12-30 18:16:26.877183 (Thread-1): SQL status: SUCCESS 14 in 0.09 seconds
2020-12-30 18:16:26.880622 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:16:26.880706 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity_Stage"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage
2020-12-30 18:16:26.956997 (Thread-1): SQL status: SUCCESS 14 in 0.08 seconds
2020-12-30 18:16:26.960602 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:16:26.961556 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity_Stage"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage
2020-12-30 18:16:27.029508 (Thread-1): SQL status: SUCCESS 14 in 0.07 seconds
2020-12-30 18:16:27.031991 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Opportunity_Stage"
2020-12-30 18:16:27.054052 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:16:27.054140 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: BEGIN
2020-12-30 18:16:27.125085 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:16:27.125208 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:16:27.125257 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity_Stage"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.Stage_id = DBT_INTERNAL_DEST.Stage_id
        

    
    when matched then update set
        "STAGE_ID" = DBT_INTERNAL_SOURCE."STAGE_ID","STAGE_NAME" = DBT_INTERNAL_SOURCE."STAGE_NAME","STAGE_POSITION" = DBT_INTERNAL_SOURCE."STAGE_POSITION","ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","FORECAST_CATEGORY" = DBT_INTERNAL_SOURCE."FORECAST_CATEGORY","LEAD_OPP_FLAG" = DBT_INTERNAL_SOURCE."LEAD_OPP_FLAG","IS_CLOSED" = DBT_INTERNAL_SOURCE."IS_CLOSED","IS_WON" = DBT_INTERNAL_SOURCE."IS_WON","OPPORTUNITY_STAGE" = DBT_INTERNAL_SOURCE."OPPORTUNITY_STAGE","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("STAGE_ID", "STAGE_NAME", "STAGE_POSITION", "ACCOUNT_ID", "ACTIVE_FLAG", "SOURCE_ID", "FORECAST_CATEGORY", "LEAD_OPP_FLAG", "IS_CLOSED", "IS_WON", "OPPORTUNITY_STAGE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("STAGE_ID", "STAGE_NAME", "STAGE_POSITION", "ACCOUNT_ID", "ACTIVE_FLAG", "SOURCE_ID", "FORECAST_CATEGORY", "LEAD_OPP_FLAG", "IS_CLOSED", "IS_WON", "OPPORTUNITY_STAGE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:16:27.701437 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2020-12-30 18:16:27.702449 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: COMMIT
2020-12-30 18:16:27.702572 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:16:27.702620 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: COMMIT
2020-12-30 18:16:27.892264 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-12-30 18:16:27.895808 (Thread-1): finished collecting timing info
2020-12-30 18:16:27.896042 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: Close
2020-12-30 18:16:27.978142 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23999d8460>]}
2020-12-30 18:16:27.979230 (Thread-1): 18:16:27 | 10 of 29 OK created incremental model dbt_salesdataflo.Dim_Opportunity_Stage [SUCCESS 1 in 2.29s]
2020-12-30 18:16:27.979327 (Thread-1): Finished running node model.sales_dataflo.Dim_Opportunity_Stage
2020-12-30 18:16:27.979435 (Thread-1): Began running node model.sales_dataflo.Dim_Metrics
2020-12-30 18:16:27.980221 (Thread-1): 18:16:27 | 11 of 29 START table model dbt_salesdataflo.Dim_Metrics.............. [RUN]
2020-12-30 18:16:27.980439 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-30 18:16:27.980511 (Thread-1): Compiling model.sales_dataflo.Dim_Metrics
2020-12-30 18:16:27.988426 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Metrics"
2020-12-30 18:16:28.022603 (Thread-1): finished collecting timing info
2020-12-30 18:16:28.026988 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Metrics"
2020-12-30 18:16:28.043780 (Thread-1179): handling poll request
2020-12-30 18:16:28.044124 (Thread-1179): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d7153790>]}
2020-12-30 18:16:28.047699 (Thread-1179): sending response (<Response 15139 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:16:28.072398 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-30 18:16:28.072546 (Thread-1): On model.sales_dataflo.Dim_Metrics: BEGIN
2020-12-30 18:16:28.072637 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:28.396274 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-12-30 18:16:28.396416 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-30 18:16:28.396467 (Thread-1): On model.sales_dataflo.Dim_Metrics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Metrics"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Metrics  as
      (

select * from(
Select 1 METRIC_ID,'Opportunities Won Revenue' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage ""is equal to Closed Won"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Opportunities Won Revenue during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 2 METRIC_ID,'Key Metrics' METRIC_NAME,5 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'' METRICCRITERIA,'This is a multi-metric Datablock with the following metrics: Avg Case Close Time, Converted Leads, Expected revenue, New Cases, New Leads, Opportunities Lost Count, Open Opportunities Count, Opportunities Won Count, Opportunities Won Revenue.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 3 METRIC_ID,'Converted Leads' METRIC_NAME,4 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Status ""is equal to Converted"" and Lead owner ""is equal to logged in employee""' METRICCRITERIA,'Number of Converted Leads during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 4 METRIC_ID,'New Leads' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Name ""is not empty"" and Lead owner ""is equal to logged in employee""' METRICCRITERIA,'Number of New Leads during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 5 METRIC_ID,'Open Opportunity by stage' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Sales stage ""is not equal to Closed Won"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Total Open Opportunities Count during the specified Date Range split up by Owner. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 6 METRIC_ID,'Top Sales Rep' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Sum ' RESULT_TYPE,'' METRICCRITERIA,'This is a multi-metric Datablock with the following metrics: Opportunities Won Amount by Owner, Opportunities Won Count by Owner.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 7 METRIC_ID,'New Leads by industry' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'' METRICCRITERIA,'Number of New Leads during the specified Date Range split up by Industry.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 8 METRIC_ID,'Return On Investment Amount by Campaign' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'' METRICCRITERIA,'Total Return On Investment Amount during the specified Date Range split up by Campaign Type. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 9 METRIC_ID,'Return On Investment by Campaign Type' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'' METRICCRITERIA,'Total Return On Investment during the specified Date Range split up by Campaign Type. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 10 METRIC_ID,'Opportunities Lost' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Sales stage ""is equal to Closed Lost"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Opportunities Lost Count during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 11 METRIC_ID,'Opportunities Lost Amount by Owner' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage ""is equal to Closed Lost""' METRICCRITERIA,'Opportunities Lost Amount during the specified Date Range split up by Owner.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 12 METRIC_ID,'Opportunities Lost by Owner' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage ""is equal to Closed Lost""' METRICCRITERIA,'Opportunities Lost Count during the specified Date Range split up by Owner.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 13 METRIC_ID,'Average Case Close Time' METRIC_NAME,6 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'' METRICCRITERIA,'Average Case Close Time during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 14 METRIC_ID,'Opportunities Lost Amount by Opp Name' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage ""is equal to Closed Lost"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Opportunities Lost Amount during the specified Date Range split up by Opportunity Name.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 15 METRIC_ID,'Closed Cases' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Status ""is equal to Closed"" and case owner ""is equal to logged in employee""' METRICCRITERIA,'Number of Closed Cases during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 16 METRIC_ID,'Opportunities Won Revenue by Product Family' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'' METRICCRITERIA,'Opportunities Won Revenue during the specified Date Range split up by Product Family.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 17 METRIC_ID,'Expected Revenue' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Closed Date "is not empty" and Sales stage "is not equal to Closed Won, closed Lost"' METRICCRITERIA,'Expected Revenue during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 18 METRIC_ID,'New Leads by Lead Source' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Lead Source ""is not empty""' METRICCRITERIA,'Number of New Leads during the specified Date Range split up by Lead Source.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 19 METRIC_ID,'New Leads by Lead Status' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Lead Status ""is not empty""' METRICCRITERIA,'Number of New Leads during the specified Date Range split up by Lead Status.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 20 METRIC_ID,'New Cases' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Case # ""is not empty""' METRICCRITERIA,'Number of New Cases during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 21 METRIC_ID,'Opportunities Won' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Sales stage ""is equal to Closed Won"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Opportunities Won Count during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 22 METRIC_ID,'Opportunities Won Amount by Opp Name' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage ""is equal to Closed Won"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Opportunities Won Amount during the specified Date Range split up by Opportunity Name.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 23 METRIC_ID,'Open Opportunities' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Sales stage "is not equal to Closed Won, closed Lost" and Opportunity owner "is equal to logged in employee"' METRICCRITERIA,'Total Open Opportunities Count during the specified Date Range. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 24 METRIC_ID,'Opportunities Overview' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'' METRICCRITERIA,'This is a multi-metric Datablock with the following metrics: Opportunities Lost Count, Open Opportunities Count, Opportunities Won Count.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 25 METRIC_ID,'Open Opportunities Amount by Stage Name' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage "is not equal to Closed Won, closed Lost" and Opportunity owner "is equal to logged in employee"' METRICCRITERIA,'Total Open Opportunities Amount during the specified Date Range split up by Owner. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 26 METRIC_ID,'Open Opportunities Amount by Opp Name' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'' METRICCRITERIA,'Total Open Opportunities Amount during the specified Date Range split up by Opportunity Name. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 27 METRIC_ID,'Accounts' METRIC_NAME,5 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Account Name "is not empty" and Account Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of accounts by annual revenue.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 28 METRIC_ID,'Accounts by Type' METRIC_NAME,5 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Account Type "is not empty" and Account Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of accounts by type.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 29 METRIC_ID,'Contacts' METRIC_NAME,6 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,' Name "is not empty" and Contact Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of all your contacts by department including name, phone, title, and more.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 30 METRIC_ID,'Leads' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,' Name "is not empty" and Lead Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of leads (for this quarter).' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 31 METRIC_ID,'Leads by location' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,' Address "is not empty" and Lead Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of leads by location (for the last 7 days).' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 32 METRIC_ID,'Opportunities by type' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Type "is not empty" and Opportunity Owner is equal to "Logged in employee"' METRICCRITERIA,'Get the number of opportunities by type (for this year or for the last two quarters).' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 33 METRIC_ID,'Leads by status' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Lead status "is not empty" and Lead Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of new leads by status (for this month).' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 34 METRIC_ID,'Opportunities (for this quarter)' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Opportunity Name "is not empty" and Opportunity Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of opportunities (for this quarter).' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
)
      );
2020-12-30 18:16:29.265210 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2020-12-30 18:16:29.266193 (Thread-1): On model.sales_dataflo.Dim_Metrics: COMMIT
2020-12-30 18:16:29.266310 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-30 18:16:29.266357 (Thread-1): On model.sales_dataflo.Dim_Metrics: COMMIT
2020-12-30 18:16:29.326854 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:16:29.328862 (Thread-1): finished collecting timing info
2020-12-30 18:16:29.329108 (Thread-1): On model.sales_dataflo.Dim_Metrics: Close
2020-12-30 18:16:29.403661 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238f014820>]}
2020-12-30 18:16:29.404692 (Thread-1): 18:16:29 | 11 of 29 OK created table model dbt_salesdataflo.Dim_Metrics......... [SUCCESS 1 in 1.42s]
2020-12-30 18:16:29.404780 (Thread-1): Finished running node model.sales_dataflo.Dim_Metrics
2020-12-30 18:16:29.404890 (Thread-1): Began running node model.sales_dataflo.Dim_Metrics_Category
2020-12-30 18:16:29.405711 (Thread-1): 18:16:29 | 12 of 29 START table model dbt_salesdataflo.Dim_Metrics_Category..... [RUN]
2020-12-30 18:16:29.405940 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-30 18:16:29.406011 (Thread-1): Compiling model.sales_dataflo.Dim_Metrics_Category
2020-12-30 18:16:29.412893 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Metrics_Category"
2020-12-30 18:16:29.431422 (Thread-1): finished collecting timing info
2020-12-30 18:16:29.435821 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Metrics_Category"
2020-12-30 18:16:29.454220 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-30 18:16:29.454300 (Thread-1): On model.sales_dataflo.Dim_Metrics_Category: BEGIN
2020-12-30 18:16:29.454358 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:29.506798 (Thread-1180): handling poll request
2020-12-30 18:16:29.507173 (Thread-1180): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6879670>]}
2020-12-30 18:16:29.510093 (Thread-1180): sending response (<Response 24231 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:16:29.926282 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2020-12-30 18:16:29.926426 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-30 18:16:29.926477 (Thread-1): On model.sales_dataflo.Dim_Metrics_Category: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Metrics_Category"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Metrics_Category  as
      (

select *from (
Select 1 metric_category_id,'Productivity' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 2 metric_category_id,'Opportunity Generation' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 3 metric_category_id,'Lead Generation' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 4 metric_category_id,'Conversion' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 5 metric_category_id,'Account' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 6 metric_category_id,'Contact' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 7 metric_category_id,'Sub-list' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 8 metric_category_id,'Funnel' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
)
      );
2020-12-30 18:16:30.573970 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2020-12-30 18:16:30.574963 (Thread-1): On model.sales_dataflo.Dim_Metrics_Category: COMMIT
2020-12-30 18:16:30.575087 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-30 18:16:30.575133 (Thread-1): On model.sales_dataflo.Dim_Metrics_Category: COMMIT
2020-12-30 18:16:30.631786 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:16:30.633770 (Thread-1): finished collecting timing info
2020-12-30 18:16:30.634033 (Thread-1): On model.sales_dataflo.Dim_Metrics_Category: Close
2020-12-30 18:16:30.699090 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ee75df0>]}
2020-12-30 18:16:30.700265 (Thread-1): 18:16:30 | 12 of 29 OK created table model dbt_salesdataflo.Dim_Metrics_Category [SUCCESS 1 in 1.29s]
2020-12-30 18:16:30.700360 (Thread-1): Finished running node model.sales_dataflo.Dim_Metrics_Category
2020-12-30 18:16:30.700469 (Thread-1): Began running node model.sales_dataflo.Dim_Product
2020-12-30 18:16:30.701309 (Thread-1): 18:16:30 | 13 of 29 START incremental model dbt_salesdataflo.Dim_Product........ [RUN]
2020-12-30 18:16:30.701533 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Product".
2020-12-30 18:16:30.701603 (Thread-1): Compiling model.sales_dataflo.Dim_Product
2020-12-30 18:16:30.710625 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Product model triggered this warning. 
2020-12-30 18:16:30.712621 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Product"
2020-12-30 18:16:30.731297 (Thread-1): finished collecting timing info
2020-12-30 18:16:30.736075 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Product"
2020-12-30 18:16:30.755145 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Product".
2020-12-30 18:16:30.755222 (Thread-1): On model.sales_dataflo.Dim_Product: BEGIN
2020-12-30 18:16:30.755279 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:30.946161 (Thread-1181): handling poll request
2020-12-30 18:16:30.946585 (Thread-1181): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d7421730>]}
2020-12-30 18:16:30.949361 (Thread-1181): sending response (<Response 10900 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:16:31.069578 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-12-30 18:16:31.069734 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Product".
2020-12-30 18:16:31.069789 (Thread-1): On model.sales_dataflo.Dim_Product: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Product"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Product  as
      (
/*



    WITH source AS (
        SELECT * from DBT_TEST_LIVEDATA_RK.product
    ),Dim_Product as(
        SELECT
            NULL AS account_id,
            md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
)) AS product_id,
            ID AS Source_id,
            PRODUCT_CODE AS product_code,
            NAME AS product_name,
            IS_ACTIVE AS active_flag,
            QUANTITY_UNIT_OF_MEASURE AS Quantity_UOM,
               'SF'  as Source_type,
            'D_PRODUCT_DIM_LOAD'  AS DW_SESSION_NM,
            
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
         FROM
            source 
     
    )    
select * from Dim_Product
*/
      );
2020-12-30 18:16:31.137480 (Thread-1): Snowflake query id: 01994788-0078-6319-0000-5eb10010530a
2020-12-30 18:16:31.137603 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 39 at position 6 unexpected ')'.
2020-12-30 18:16:31.137723 (Thread-1): finished collecting timing info
2020-12-30 18:16:31.137967 (Thread-1): On model.sales_dataflo.Dim_Product: ROLLBACK
2020-12-30 18:16:31.252348 (Thread-1): On model.sales_dataflo.Dim_Product: Close
2020-12-30 18:16:31.320222 (Thread-1): Database Error in model Dim_Product (ETL/Target/Tables/Dim_Product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 39 at position 6 unexpected ')'.
  compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Product.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 39 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 120, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model Dim_Product (ETL/Target/Tables/Dim_Product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 39 at position 6 unexpected ')'.
  compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Product.sql
2020-12-30 18:16:31.320829 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ed82790>]}
2020-12-30 18:16:31.321976 (Thread-1): 18:16:31 | 13 of 29 ERROR creating incremental model dbt_salesdataflo.Dim_Product [ERROR in 0.62s]
2020-12-30 18:16:31.322062 (Thread-1): Finished running node model.sales_dataflo.Dim_Product
2020-12-30 18:16:31.322168 (Thread-1): Began running node model.sales_dataflo.Dim_TimeFrame
2020-12-30 18:16:31.322956 (Thread-1): 18:16:31 | 14 of 29 START table model dbt_salesdataflo.Dim_TimeFrame............ [RUN]
2020-12-30 18:16:31.323169 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-30 18:16:31.323240 (Thread-1): Compiling model.sales_dataflo.Dim_TimeFrame
2020-12-30 18:16:31.333402 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_TimeFrame"
2020-12-30 18:16:31.360812 (Thread-1): finished collecting timing info
2020-12-30 18:16:31.365557 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_TimeFrame"
2020-12-30 18:16:31.384891 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-30 18:16:31.385007 (Thread-1): On model.sales_dataflo.Dim_TimeFrame: BEGIN
2020-12-30 18:16:31.385100 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:31.689487 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-12-30 18:16:31.689639 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-30 18:16:31.689690 (Thread-1): On model.sales_dataflo.Dim_TimeFrame: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_TimeFrame"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame  as
      (



with year_data as 
(
    select * from DBT_TEST_LIVEDATA_RK.period 
    where type ='Year'
),
qutr_data as 
(
    select * from DBT_TEST_LIVEDATA_RK.period 
    where type ='Quarter'
),
 Dates AS 
(
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Calendar
)   
,Dim_TimeFrame as(
select
    d.Calendar_ID AS TimeFrameID,
    'D' as TimeFrameType,
    d.Calendar_ID as calendar_id,
    d.cldr_date as day_start,
    d.cldr_date as day_end,
    d.week_start_date as week_Start,
    d.week_end_date as week_end,
    'W' || d.cldr_week_num as week_num,
    d.cldr_mnth_strt_dt as month_start,
    d.cldr_mnth_end_dt as month_end, 
    d.month_name as month_name,
     'Q' || s.number as qutr_number,
    s.start_date as quarter_start,
    s.end_date as quarter_end,
    d.year as year,
    y.start_date as year_start,
    y.end_date as year_end,
      'SF'  as Source_type,
    'D_TIMEFRAME_DIM_LOAD' AS DW_SESSION_NM,
    
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS     
from
    dates d
    left join qutr_data s
    on d.cldr_date between s.start_date and s.end_date
    left join year_data y
    on d.cldr_date between y.start_date and y.end_date
order by 2)

select * from Dim_TimeFrame
      );
2020-12-30 18:16:32.442458 (Thread-1182): handling poll request
2020-12-30 18:16:32.442900 (Thread-1182): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dd208730>]}
2020-12-30 18:16:32.445978 (Thread-1182): sending response (<Response 17045 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:16:32.583374 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2020-12-30 18:16:32.584354 (Thread-1): On model.sales_dataflo.Dim_TimeFrame: COMMIT
2020-12-30 18:16:32.584481 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-30 18:16:32.584528 (Thread-1): On model.sales_dataflo.Dim_TimeFrame: COMMIT
2020-12-30 18:16:32.640918 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:16:32.642802 (Thread-1): finished collecting timing info
2020-12-30 18:16:32.643007 (Thread-1): On model.sales_dataflo.Dim_TimeFrame: Close
2020-12-30 18:16:32.711771 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ed6b940>]}
2020-12-30 18:16:32.712829 (Thread-1): 18:16:32 | 14 of 29 OK created table model dbt_salesdataflo.Dim_TimeFrame....... [SUCCESS 1 in 1.39s]
2020-12-30 18:16:32.712921 (Thread-1): Finished running node model.sales_dataflo.Dim_TimeFrame
2020-12-30 18:16:32.713024 (Thread-1): Began running node model.sales_dataflo.Dim_Employee_Hier
2020-12-30 18:16:32.713160 (Thread-1): 18:16:32 | 15 of 29 SKIP relation dbt_salesdataflo.Dim_Employee_Hier............ [SKIP]
2020-12-30 18:16:32.713220 (Thread-1): Finished running node model.sales_dataflo.Dim_Employee_Hier
2020-12-30 18:16:32.713287 (Thread-1): Began running node model.sales_dataflo.VW_Employee
2020-12-30 18:16:32.713353 (Thread-1): 18:16:32 | 16 of 29 SKIP relation dbt_salesdataflo.VW_Employee.................. [SKIP]
2020-12-30 18:16:32.713403 (Thread-1): Finished running node model.sales_dataflo.VW_Employee
2020-12-30 18:16:32.713464 (Thread-1): Began running node model.sales_dataflo.VW_Account
2020-12-30 18:16:32.714265 (Thread-1): 18:16:32 | 17 of 29 START view model dbt_salesdataflo.VW_Account................ [RUN]
2020-12-30 18:16:32.714475 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Account".
2020-12-30 18:16:32.714547 (Thread-1): Compiling model.sales_dataflo.VW_Account
2020-12-30 18:16:32.723417 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Account"
2020-12-30 18:16:32.744809 (Thread-1): finished collecting timing info
2020-12-30 18:16:32.763163 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Account"
2020-12-30 18:16:32.790814 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Account".
2020-12-30 18:16:32.790895 (Thread-1): On model.sales_dataflo.VW_Account: BEGIN
2020-12-30 18:16:32.790954 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:33.094670 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-12-30 18:16:33.094825 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Account".
2020-12-30 18:16:33.094877 (Thread-1): On model.sales_dataflo.VW_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Account"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Account  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account
  );
2020-12-30 18:16:33.350871 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-12-30 18:16:33.351831 (Thread-1): On model.sales_dataflo.VW_Account: COMMIT
2020-12-30 18:16:33.351954 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Account".
2020-12-30 18:16:33.352001 (Thread-1): On model.sales_dataflo.VW_Account: COMMIT
2020-12-30 18:16:33.410618 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:16:33.413654 (Thread-1): finished collecting timing info
2020-12-30 18:16:33.413871 (Thread-1): On model.sales_dataflo.VW_Account: Close
2020-12-30 18:16:33.485552 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ecb54f0>]}
2020-12-30 18:16:33.486694 (Thread-1): 18:16:33 | 17 of 29 OK created view model dbt_salesdataflo.VW_Account........... [SUCCESS 1 in 0.77s]
2020-12-30 18:16:33.486792 (Thread-1): Finished running node model.sales_dataflo.VW_Account
2020-12-30 18:16:33.486895 (Thread-1): Began running node model.sales_dataflo.VW_Lead
2020-12-30 18:16:33.487691 (Thread-1): 18:16:33 | 18 of 29 START view model dbt_salesdataflo.VW_Lead................... [RUN]
2020-12-30 18:16:33.487905 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-30 18:16:33.487979 (Thread-1): Compiling model.sales_dataflo.VW_Lead
2020-12-30 18:16:33.495481 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Lead"
2020-12-30 18:16:33.516494 (Thread-1): finished collecting timing info
2020-12-30 18:16:33.520825 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Lead"
2020-12-30 18:16:33.541127 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-30 18:16:33.541210 (Thread-1): On model.sales_dataflo.VW_Lead: BEGIN
2020-12-30 18:16:33.541273 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:33.829758 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2020-12-30 18:16:33.829902 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-30 18:16:33.829953 (Thread-1): On model.sales_dataflo.VW_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Lead"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Lead  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead
  );
2020-12-30 18:16:33.877998 (Thread-1183): handling poll request
2020-12-30 18:16:33.878393 (Thread-1183): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d7421a90>]}
2020-12-30 18:16:33.883278 (Thread-1183): sending response (<Response 21914 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:16:34.073033 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-12-30 18:16:34.074500 (Thread-1): On model.sales_dataflo.VW_Lead: COMMIT
2020-12-30 18:16:34.074672 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-30 18:16:34.074755 (Thread-1): On model.sales_dataflo.VW_Lead: COMMIT
2020-12-30 18:16:34.126914 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:16:34.131434 (Thread-1): finished collecting timing info
2020-12-30 18:16:34.131752 (Thread-1): On model.sales_dataflo.VW_Lead: Close
2020-12-30 18:16:34.204640 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ed5c850>]}
2020-12-30 18:16:34.206479 (Thread-1): 18:16:34 | 18 of 29 OK created view model dbt_salesdataflo.VW_Lead.............. [SUCCESS 1 in 0.72s]
2020-12-30 18:16:34.206669 (Thread-1): Finished running node model.sales_dataflo.VW_Lead
2020-12-30 18:16:34.206915 (Thread-1): Began running node model.sales_dataflo.VW_Opportunity
2020-12-30 18:16:34.208197 (Thread-1): 18:16:34 | 19 of 29 START view model dbt_salesdataflo.VW_Opportunity............ [RUN]
2020-12-30 18:16:34.208520 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-30 18:16:34.208626 (Thread-1): Compiling model.sales_dataflo.VW_Opportunity
2020-12-30 18:16:34.220649 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Opportunity"
2020-12-30 18:16:34.240740 (Thread-1): finished collecting timing info
2020-12-30 18:16:34.246292 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Opportunity"
2020-12-30 18:16:34.266205 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-30 18:16:34.266293 (Thread-1): On model.sales_dataflo.VW_Opportunity: BEGIN
2020-12-30 18:16:34.266355 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:34.586651 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-12-30 18:16:34.586790 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-30 18:16:34.586839 (Thread-1): On model.sales_dataflo.VW_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Opportunity"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Opportunity  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity
  );
2020-12-30 18:16:34.853963 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-12-30 18:16:34.854919 (Thread-1): On model.sales_dataflo.VW_Opportunity: COMMIT
2020-12-30 18:16:34.855040 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-30 18:16:34.855088 (Thread-1): On model.sales_dataflo.VW_Opportunity: COMMIT
2020-12-30 18:16:34.908841 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:16:34.911737 (Thread-1): finished collecting timing info
2020-12-30 18:16:34.911932 (Thread-1): On model.sales_dataflo.VW_Opportunity: Close
2020-12-30 18:16:34.981763 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ede9ac0>]}
2020-12-30 18:16:34.982729 (Thread-1): 18:16:34 | 19 of 29 OK created view model dbt_salesdataflo.VW_Opportunity....... [SUCCESS 1 in 0.77s]
2020-12-30 18:16:34.982812 (Thread-1): Finished running node model.sales_dataflo.VW_Opportunity
2020-12-30 18:16:34.982912 (Thread-1): Began running node model.sales_dataflo.VW_Contact
2020-12-30 18:16:34.983686 (Thread-1): 18:16:34 | 20 of 29 START view model dbt_salesdataflo.VW_Contact................ [RUN]
2020-12-30 18:16:34.983888 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-30 18:16:34.983958 (Thread-1): Compiling model.sales_dataflo.VW_Contact
2020-12-30 18:16:34.991600 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Contact"
2020-12-30 18:16:35.009674 (Thread-1): finished collecting timing info
2020-12-30 18:16:35.013905 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Contact"
2020-12-30 18:16:35.032294 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-30 18:16:35.032373 (Thread-1): On model.sales_dataflo.VW_Contact: BEGIN
2020-12-30 18:16:35.032431 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:35.355259 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-12-30 18:16:35.355404 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-30 18:16:35.355455 (Thread-1): On model.sales_dataflo.VW_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Contact"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Contact  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact
  );
2020-12-30 18:16:35.374398 (Thread-1184): handling poll request
2020-12-30 18:16:35.374809 (Thread-1184): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d67c1970>]}
2020-12-30 18:16:35.379324 (Thread-1184): sending response (<Response 18034 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:16:35.610487 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-12-30 18:16:35.611462 (Thread-1): On model.sales_dataflo.VW_Contact: COMMIT
2020-12-30 18:16:35.611590 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-30 18:16:35.611638 (Thread-1): On model.sales_dataflo.VW_Contact: COMMIT
2020-12-30 18:16:35.664348 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:16:35.667304 (Thread-1): finished collecting timing info
2020-12-30 18:16:35.667510 (Thread-1): On model.sales_dataflo.VW_Contact: Close
2020-12-30 18:16:35.755247 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ededbe0>]}
2020-12-30 18:16:35.756418 (Thread-1): 18:16:35 | 20 of 29 OK created view model dbt_salesdataflo.VW_Contact........... [SUCCESS 1 in 0.77s]
2020-12-30 18:16:35.756519 (Thread-1): Finished running node model.sales_dataflo.VW_Contact
2020-12-30 18:16:35.756626 (Thread-1): Began running node model.sales_dataflo.VW_Address
2020-12-30 18:16:35.757434 (Thread-1): 18:16:35 | 21 of 29 START view model dbt_salesdataflo.VW_Address................ [RUN]
2020-12-30 18:16:35.757654 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Address".
2020-12-30 18:16:35.757727 (Thread-1): Compiling model.sales_dataflo.VW_Address
2020-12-30 18:16:35.765516 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Address"
2020-12-30 18:16:35.785406 (Thread-1): finished collecting timing info
2020-12-30 18:16:35.789682 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Address"
2020-12-30 18:16:35.810746 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Address".
2020-12-30 18:16:35.810830 (Thread-1): On model.sales_dataflo.VW_Address: BEGIN
2020-12-30 18:16:35.810889 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:36.293942 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-12-30 18:16:36.294090 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Address".
2020-12-30 18:16:36.294140 (Thread-1): On model.sales_dataflo.VW_Address: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Address"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Address  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Address
  );
2020-12-30 18:16:36.556508 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-12-30 18:16:36.557506 (Thread-1): On model.sales_dataflo.VW_Address: COMMIT
2020-12-30 18:16:36.557635 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Address".
2020-12-30 18:16:36.557682 (Thread-1): On model.sales_dataflo.VW_Address: COMMIT
2020-12-30 18:16:36.613935 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:16:36.616875 (Thread-1): finished collecting timing info
2020-12-30 18:16:36.617107 (Thread-1): On model.sales_dataflo.VW_Address: Close
2020-12-30 18:16:36.694785 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ed8c2e0>]}
2020-12-30 18:16:36.695889 (Thread-1): 18:16:36 | 21 of 29 OK created view model dbt_salesdataflo.VW_Address........... [SUCCESS 1 in 0.94s]
2020-12-30 18:16:36.695992 (Thread-1): Finished running node model.sales_dataflo.VW_Address
2020-12-30 18:16:36.696097 (Thread-1): Began running node model.sales_dataflo.VW_Campaign
2020-12-30 18:16:36.696885 (Thread-1): 18:16:36 | 22 of 29 START view model dbt_salesdataflo.VW_Campaign............... [RUN]
2020-12-30 18:16:36.697134 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-30 18:16:36.697221 (Thread-1): Compiling model.sales_dataflo.VW_Campaign
2020-12-30 18:16:36.705114 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Campaign"
2020-12-30 18:16:36.723601 (Thread-1): finished collecting timing info
2020-12-30 18:16:36.727909 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Campaign"
2020-12-30 18:16:36.747031 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-30 18:16:36.747110 (Thread-1): On model.sales_dataflo.VW_Campaign: BEGIN
2020-12-30 18:16:36.747171 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:36.778514 (Thread-1185): handling poll request
2020-12-30 18:16:36.778883 (Thread-1185): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d7211e50>]}
2020-12-30 18:16:36.783001 (Thread-1185): sending response (<Response 16634 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:16:37.311645 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2020-12-30 18:16:37.311798 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-30 18:16:37.311849 (Thread-1): On model.sales_dataflo.VW_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Campaign"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Campaign  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign
  );
2020-12-30 18:16:37.545543 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-12-30 18:16:37.546517 (Thread-1): On model.sales_dataflo.VW_Campaign: COMMIT
2020-12-30 18:16:37.546643 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-30 18:16:37.546691 (Thread-1): On model.sales_dataflo.VW_Campaign: COMMIT
2020-12-30 18:16:37.599650 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:16:37.602962 (Thread-1): finished collecting timing info
2020-12-30 18:16:37.603180 (Thread-1): On model.sales_dataflo.VW_Campaign: Close
2020-12-30 18:16:37.676739 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ecfda30>]}
2020-12-30 18:16:37.677927 (Thread-1): 18:16:37 | 22 of 29 OK created view model dbt_salesdataflo.VW_Campaign.......... [SUCCESS 1 in 0.98s]
2020-12-30 18:16:37.678034 (Thread-1): Finished running node model.sales_dataflo.VW_Campaign
2020-12-30 18:16:37.678139 (Thread-1): Began running node model.sales_dataflo.test
2020-12-30 18:16:37.678913 (Thread-1): 18:16:37 | 23 of 29 START incremental model dbt_salesdataflo.test............... [RUN]
2020-12-30 18:16:37.679133 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test".
2020-12-30 18:16:37.679208 (Thread-1): Compiling model.sales_dataflo.test
2020-12-30 18:16:37.689744 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:16:37.689827 (Thread-1): On model.sales_dataflo.test: BEGIN
2020-12-30 18:16:37.689885 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:38.014725 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-12-30 18:16:38.014881 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:16:38.014932 (Thread-1): On model.sales_dataflo.test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.test"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:16:38.194874 (Thread-1186): handling poll request
2020-12-30 18:16:38.195302 (Thread-1186): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5402910>]}
2020-12-30 18:16:38.197980 (Thread-1186): sending response (<Response 9173 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:16:38.282586 (Thread-1): SQL status: SUCCESS 2 in 0.27 seconds
2020-12-30 18:16:38.283234 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.test model triggered this warning. 
2020-12-30 18:16:38.284310 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.test model triggered this warning. 
2020-12-30 18:16:38.287013 (Thread-1): Writing injected SQL for node "model.sales_dataflo.test"
2020-12-30 18:16:38.305591 (Thread-1): finished collecting timing info
2020-12-30 18:16:38.311202 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.test"
2020-12-30 18:16:38.330518 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:16:38.330619 (Thread-1): On model.sales_dataflo.test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.test"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.test  as
      (







  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        'DBT_TEST_LIVEDATA_RK' as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM DBT_TEST_LIVEDATA_RK.Account


            UNION ALL
        
  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        'SALESFORCE_FREETRAILS' as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM SALESFORCE_FREETRAILS.Account

      );
2020-12-30 18:16:39.101650 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2020-12-30 18:16:39.102612 (Thread-1): On model.sales_dataflo.test: COMMIT
2020-12-30 18:16:39.102725 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:16:39.102772 (Thread-1): On model.sales_dataflo.test: COMMIT
2020-12-30 18:16:39.148800 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:16:39.152996 (Thread-1): finished collecting timing info
2020-12-30 18:16:39.153231 (Thread-1): On model.sales_dataflo.test: Close
2020-12-30 18:16:39.235408 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ed12a00>]}
2020-12-30 18:16:39.236507 (Thread-1): 18:16:39 | 23 of 29 OK created incremental model dbt_salesdataflo.test.......... [SUCCESS 1 in 1.56s]
2020-12-30 18:16:39.236607 (Thread-1): Finished running node model.sales_dataflo.test
2020-12-30 18:16:39.236716 (Thread-1): Began running node model.sales_dataflo.VW_Opportunity_Stage
2020-12-30 18:16:39.237534 (Thread-1): 18:16:39 | 24 of 29 START view model dbt_salesdataflo.VW_Opportunity_Stage...... [RUN]
2020-12-30 18:16:39.237760 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-30 18:16:39.237834 (Thread-1): Compiling model.sales_dataflo.VW_Opportunity_Stage
2020-12-30 18:16:39.244817 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Opportunity_Stage"
2020-12-30 18:16:39.263647 (Thread-1): finished collecting timing info
2020-12-30 18:16:39.267986 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Opportunity_Stage"
2020-12-30 18:16:39.288348 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-30 18:16:39.288431 (Thread-1): On model.sales_dataflo.VW_Opportunity_Stage: BEGIN
2020-12-30 18:16:39.288493 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:39.597271 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-12-30 18:16:39.597427 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-30 18:16:39.597479 (Thread-1): On model.sales_dataflo.VW_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Opportunity_Stage"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Opportunity_Stage  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage
  );
2020-12-30 18:16:39.648271 (Thread-1187): handling poll request
2020-12-30 18:16:39.648703 (Thread-1187): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dd0a16d0>]}
2020-12-30 18:16:39.652147 (Thread-1187): sending response (<Response 14031 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:16:39.871763 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2020-12-30 18:16:39.872724 (Thread-1): On model.sales_dataflo.VW_Opportunity_Stage: COMMIT
2020-12-30 18:16:39.872844 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-30 18:16:39.872892 (Thread-1): On model.sales_dataflo.VW_Opportunity_Stage: COMMIT
2020-12-30 18:16:39.931364 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:16:39.934321 (Thread-1): finished collecting timing info
2020-12-30 18:16:39.934519 (Thread-1): On model.sales_dataflo.VW_Opportunity_Stage: Close
2020-12-30 18:16:40.002847 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238edc27c0>]}
2020-12-30 18:16:40.003927 (Thread-1): 18:16:40 | 24 of 29 OK created view model dbt_salesdataflo.VW_Opportunity_Stage. [SUCCESS 1 in 0.76s]
2020-12-30 18:16:40.004017 (Thread-1): Finished running node model.sales_dataflo.VW_Opportunity_Stage
2020-12-30 18:16:40.004119 (Thread-1): Began running node model.sales_dataflo.Fact_Sales_History
2020-12-30 18:16:40.004214 (Thread-1): 18:16:40 | 25 of 29 SKIP relation dbt_salesdataflo.Fact_Sales_History........... [SKIP]
2020-12-30 18:16:40.004269 (Thread-1): Finished running node model.sales_dataflo.Fact_Sales_History
2020-12-30 18:16:40.004333 (Thread-1): Began running node model.sales_dataflo.Fact_Sales_Segmented_History
2020-12-30 18:16:40.004396 (Thread-1): 18:16:40 | 26 of 29 SKIP relation dbt_salesdataflo.Fact_Sales_Segmented_History. [SKIP]
2020-12-30 18:16:40.004444 (Thread-1): Finished running node model.sales_dataflo.Fact_Sales_Segmented_History
2020-12-30 18:16:40.004504 (Thread-1): Began running node model.sales_dataflo.VW_TimeFrame
2020-12-30 18:16:40.005325 (Thread-1): 18:16:40 | 27 of 29 START view model dbt_salesdataflo.VW_TimeFrame.............. [RUN]
2020-12-30 18:16:40.005541 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-30 18:16:40.005620 (Thread-1): Compiling model.sales_dataflo.VW_TimeFrame
2020-12-30 18:16:40.013392 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_TimeFrame"
2020-12-30 18:16:40.031612 (Thread-1): finished collecting timing info
2020-12-30 18:16:40.035950 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_TimeFrame"
2020-12-30 18:16:40.052148 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-30 18:16:40.052240 (Thread-1): On model.sales_dataflo.VW_TimeFrame: BEGIN
2020-12-30 18:16:40.052304 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:16:40.566738 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-12-30 18:16:40.566890 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-30 18:16:40.566943 (Thread-1): On model.sales_dataflo.VW_TimeFrame: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_TimeFrame"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_TimeFrame  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame
  );
2020-12-30 18:16:40.865310 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-12-30 18:16:40.866283 (Thread-1): On model.sales_dataflo.VW_TimeFrame: COMMIT
2020-12-30 18:16:40.866407 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-30 18:16:40.866454 (Thread-1): On model.sales_dataflo.VW_TimeFrame: COMMIT
2020-12-30 18:16:40.920510 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:16:40.923521 (Thread-1): finished collecting timing info
2020-12-30 18:16:40.923727 (Thread-1): On model.sales_dataflo.VW_TimeFrame: Close
2020-12-30 18:16:40.991551 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63da19fc-ec43-401d-a60e-d39ec5ae6d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238ecf7640>]}
2020-12-30 18:16:40.992609 (Thread-1): 18:16:40 | 27 of 29 OK created view model dbt_salesdataflo.VW_TimeFrame......... [SUCCESS 1 in 0.99s]
2020-12-30 18:16:40.992705 (Thread-1): Finished running node model.sales_dataflo.VW_TimeFrame
2020-12-30 18:16:40.992808 (Thread-1): Began running node model.sales_dataflo.Fact_Sales
2020-12-30 18:16:40.992895 (Thread-1): 18:16:40 | 28 of 29 SKIP relation dbt_salesdataflo.Fact_Sales................... [SKIP]
2020-12-30 18:16:40.992949 (Thread-1): Finished running node model.sales_dataflo.Fact_Sales
2020-12-30 18:16:40.993012 (Thread-1): Began running node model.sales_dataflo.Fact_Sales_Segmented
2020-12-30 18:16:40.993097 (Thread-1): 18:16:40 | 29 of 29 SKIP relation dbt_salesdataflo.Fact_Sales_Segmented......... [SKIP]
2020-12-30 18:16:40.993148 (Thread-1): Finished running node model.sales_dataflo.Fact_Sales_Segmented
2020-12-30 18:16:40.994962 (MainThread): Acquiring new snowflake connection "master".
2020-12-30 18:16:40.995123 (MainThread): Using snowflake connection "master".
2020-12-30 18:16:40.995173 (MainThread): On master: BEGIN
2020-12-30 18:16:40.995227 (MainThread): Opening a new connection, currently in state closed
2020-12-30 18:16:41.171513 (Thread-1188): handling poll request
2020-12-30 18:16:41.171935 (Thread-1188): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5423d00>]}
2020-12-30 18:16:41.176716 (Thread-1188): sending response (<Response 22373 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:16:41.305202 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2020-12-30 18:16:41.305358 (MainThread): On master: COMMIT
2020-12-30 18:16:41.305452 (MainThread): Using snowflake connection "master".
2020-12-30 18:16:41.305500 (MainThread): On master: COMMIT
2020-12-30 18:16:41.431036 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2020-12-30 18:16:41.431200 (MainThread): On master: Close
2020-12-30 18:16:41.500983 (MainThread): 18:16:41 | 
2020-12-30 18:16:41.501140 (MainThread): 18:16:41 | Finished running 10 table models, 9 incremental models, 10 view models in 48.70s.
2020-12-30 18:16:41.501203 (MainThread): Connection 'master' was properly closed.
2020-12-30 18:16:41.501247 (MainThread): Connection 'model.sales_dataflo.VW_TimeFrame' was properly closed.
2020-12-30 18:16:41.605227 (MainThread): 
2020-12-30 18:16:41.605355 (MainThread): Completed with 2 errors and 0 warnings:
2020-12-30 18:16:41.605410 (MainThread): 
2020-12-30 18:16:41.605462 (MainThread): Database Error in model Dim_Employee (ETL/Target/Tables/Dim_Employee.sql)
2020-12-30 18:16:41.605505 (MainThread):   000904 (42000): SQL compilation error: error line 15 at position 158
2020-12-30 18:16:41.605543 (MainThread):   invalid identifier 'EMP_ROLE_NM'
2020-12-30 18:16:41.605579 (MainThread):   compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Employee.sql
2020-12-30 18:16:41.605620 (MainThread): 
2020-12-30 18:16:41.605664 (MainThread): Database Error in model Dim_Product (ETL/Target/Tables/Dim_Product.sql)
2020-12-30 18:16:41.605703 (MainThread):   001003 (42000): SQL compilation error:
2020-12-30 18:16:41.605748 (MainThread):   syntax error line 39 at position 6 unexpected ')'.
2020-12-30 18:16:41.605785 (MainThread):   compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Product.sql
2020-12-30 18:16:41.605844 (MainThread): 
Done. PASS=21 WARN=0 ERROR=2 SKIP=6 TOTAL=29
2020-12-30 18:16:42.589986 (Thread-1189): handling poll request
2020-12-30 18:16:42.590407 (Thread-1189): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d541d670>]}
2020-12-30 18:16:42.657311 (Thread-1189): sending response (<Response 186092 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:16:43.342534 (Thread-1190): handling status request
2020-12-30 18:16:43.342980 (Thread-1190): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6543e80>]}
2020-12-30 18:16:43.344197 (Thread-1190): sending response (<Response 1753 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:30:43.431585 (Thread-1191): Got an acceptable cached parse result
2020-12-30 18:30:44.060276 (Thread-1191): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:30:44.080509 (Thread-1192): handling status request
2020-12-30 18:30:44.084399 (Thread-1192): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d50cc7f0>]}
2020-12-30 18:30:44.085783 (Thread-1192): sending response (<Response 931 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:31:26.054654 (Thread-1193): Parsing macros/Segmented_Calc.sql
2020-12-30 18:31:26.060992 (Thread-1193): Parsing macros/NS_History_Calc.sql
2020-12-30 18:31:26.071593 (Thread-1193): Parsing macros/NS_Calc.sql
2020-12-30 18:31:26.461541 (Thread-1193): Got an acceptable cached parse result
2020-12-30 18:31:26.754254 (Thread-1194): handling status request
2020-12-30 18:31:26.773623 (Thread-1194): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40f8d60>]}
2020-12-30 18:31:26.774594 (Thread-1194): sending response (<Response 184 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:31:27.281360 (Thread-1193): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:31:28.273226 (Thread-1195): handling status request
2020-12-30 18:31:28.273643 (Thread-1195): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d511d760>]}
2020-12-30 18:31:28.274772 (Thread-1195): sending response (<Response 1723 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:31:44.148689 (Thread-1196): Got an acceptable cached parse result
2020-12-30 18:31:44.263142 (Thread-1196): Acquiring new snowflake connection "model.sales_dataflo.test".
2020-12-30 18:31:44.403063 (Thread-1197): handling status request
2020-12-30 18:31:44.404620 (Thread-1197): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfd83fa0>]}
2020-12-30 18:31:44.567760 (Thread-1197): sending response (<Response 184 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:31:44.728719 (Thread-1196): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:31:46.103437 (Thread-1198): handling status request
2020-12-30 18:31:46.103891 (Thread-1198): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29550>]}
2020-12-30 18:31:46.104886 (Thread-1198): sending response (<Response 1228 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:31:47.173748 (Thread-1199): handling status request
2020-12-30 18:31:47.174161 (Thread-1199): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1ac0>]}
2020-12-30 18:31:47.175136 (Thread-1199): sending response (<Response 1228 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:31:47.641676 (Thread-1200): handling run_sql request
2020-12-30 18:31:47.642098 (Thread-1200): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1b80>]}
2020-12-30 18:31:47.643343 (Thread-1200): Connection 'model.sales_dataflo.test' was properly closed.
2020-12-30 18:31:48.671013 (Thread-1200): sending response (<Response 137 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:31:48.689138 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:31:48.739880 (MainThread): Found 30 models, 0 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:31:48.740366 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:31:48.740475 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:31:48.761945 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:31:48.762056 (Thread-1): On rpc.sales_dataflo.request: BEGIN
2020-12-30 18:31:48.762115 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:31:49.192594 (Thread-1201): handling poll request
2020-12-30 18:31:49.193164 (Thread-1201): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc00b80>]}
2020-12-30 18:31:49.195373 (Thread-1201): sending response (<Response 2424 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:31:49.320107 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2020-12-30 18:31:49.320266 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:31:49.320316 (Thread-1): On rpc.sales_dataflo.request: select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:31:49.408072 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2020-12-30 18:31:49.413833 (Thread-1): finished collecting timing info
2020-12-30 18:31:49.416371 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:31:49.416468 (Thread-1): On rpc.sales_dataflo.request: with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('27' as number) as METRIC_ID,
        cast('5' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type, 'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
2020-12-30 18:31:50.697246 (Thread-1202): handling poll request
2020-12-30 18:31:50.697675 (Thread-1202): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc002b0>]}
2020-12-30 18:31:50.699133 (Thread-1202): sending response (<Response 5975 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:31:52.191276 (Thread-1203): handling poll request
2020-12-30 18:31:52.191714 (Thread-1203): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24400>]}
2020-12-30 18:31:52.192620 (Thread-1203): sending response (<Response 386 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:31:53.679343 (Thread-1204): handling poll request
2020-12-30 18:31:53.679770 (Thread-1204): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f240d0>]}
2020-12-30 18:31:53.680648 (Thread-1204): sending response (<Response 386 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:31:54.343116 (Thread-1): SQL status: SUCCESS 2526714 in 4.93 seconds
2020-12-30 18:31:55.156204 (Thread-1205): handling poll request
2020-12-30 18:31:55.156642 (Thread-1205): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24ee0>]}
2020-12-30 18:31:55.157723 (Thread-1205): sending response (<Response 660 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:31:56.716432 (Thread-1206): handling poll request
2020-12-30 18:31:56.716882 (Thread-1206): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24dc0>]}
2020-12-30 18:31:56.717855 (Thread-1206): sending response (<Response 386 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:31:58.293512 (Thread-1207): handling poll request
2020-12-30 18:31:58.293943 (Thread-1207): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f5e0>]}
2020-12-30 18:31:58.295322 (Thread-1207): sending response (<Response 387 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:31:59.771722 (Thread-1208): handling poll request
2020-12-30 18:31:59.772139 (Thread-1208): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f241c0>]}
2020-12-30 18:31:59.773026 (Thread-1208): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:32:01.269339 (Thread-1209): handling poll request
2020-12-30 18:32:01.269773 (Thread-1209): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24130>]}
2020-12-30 18:32:01.270653 (Thread-1209): sending response (<Response 387 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:32:02.742219 (Thread-1210): handling poll request
2020-12-30 18:32:02.742654 (Thread-1210): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc009a0>]}
2020-12-30 18:32:02.743570 (Thread-1210): sending response (<Response 387 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:32:04.363361 (Thread-1211): handling poll request
2020-12-30 18:32:04.363832 (Thread-1211): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f244c0>]}
2020-12-30 18:32:04.364733 (Thread-1211): sending response (<Response 387 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:32:05.864376 (Thread-1212): handling poll request
2020-12-30 18:32:05.864811 (Thread-1212): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc006a0>]}
2020-12-30 18:32:05.865728 (Thread-1212): sending response (<Response 387 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:32:07.437579 (Thread-1213): handling poll request
2020-12-30 18:32:07.438000 (Thread-1213): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f297f0>]}
2020-12-30 18:32:07.438887 (Thread-1213): sending response (<Response 387 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:32:09.022464 (Thread-1214): handling poll request
2020-12-30 18:32:09.022881 (Thread-1214): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1af0>]}
2020-12-30 18:32:09.023735 (Thread-1214): sending response (<Response 387 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:32:10.496992 (Thread-1215): handling poll request
2020-12-30 18:32:10.497444 (Thread-1215): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f0d0>]}
2020-12-30 18:32:10.498333 (Thread-1215): sending response (<Response 387 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:32:11.989267 (Thread-1216): handling poll request
2020-12-30 18:32:11.989672 (Thread-1216): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2fa60>]}
2020-12-30 18:32:11.990531 (Thread-1216): sending response (<Response 387 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:32:13.585699 (Thread-1217): handling poll request
2020-12-30 18:32:13.586113 (Thread-1217): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2fc10>]}
2020-12-30 18:32:13.587027 (Thread-1217): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:32:15.071631 (Thread-1218): handling poll request
2020-12-30 18:32:15.072033 (Thread-1218): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2fe50>]}
2020-12-30 18:32:15.072879 (Thread-1218): sending response (<Response 387 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:32:16.600905 (Thread-1219): handling poll request
2020-12-30 18:32:16.601345 (Thread-1219): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2fdc0>]}
2020-12-30 18:32:16.602239 (Thread-1219): sending response (<Response 387 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:32:18.091075 (Thread-1220): handling poll request
2020-12-30 18:32:18.091500 (Thread-1220): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f335b0>]}
2020-12-30 18:32:18.092387 (Thread-1220): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:32:19.649744 (Thread-1221): handling poll request
2020-12-30 18:32:19.650193 (Thread-1221): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f339a0>]}
2020-12-30 18:32:19.651426 (Thread-1221): sending response (<Response 387 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:32:21.162241 (Thread-1222): handling poll request
2020-12-30 18:32:21.162654 (Thread-1222): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f250>]}
2020-12-30 18:32:21.163539 (Thread-1222): sending response (<Response 387 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:32:22.727513 (Thread-1223): handling poll request
2020-12-30 18:32:22.727924 (Thread-1223): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f880>]}
2020-12-30 18:32:22.728815 (Thread-1223): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:32:24.315462 (Thread-1224): handling poll request
2020-12-30 18:32:24.315881 (Thread-1224): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f9aaf0>]}
2020-12-30 18:32:24.316754 (Thread-1224): sending response (<Response 387 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:32:25.807630 (Thread-1225): handling poll request
2020-12-30 18:32:25.808041 (Thread-1225): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1dc0>]}
2020-12-30 18:32:25.808901 (Thread-1225): sending response (<Response 387 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:32:27.304351 (Thread-1226): handling poll request
2020-12-30 18:32:27.304770 (Thread-1226): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc00d00>]}
2020-12-30 18:32:27.305682 (Thread-1226): sending response (<Response 387 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:32:28.896785 (Thread-1227): handling poll request
2020-12-30 18:32:28.897271 (Thread-1227): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2fb80>]}
2020-12-30 18:32:29.008092 (Thread-1227): sending response (<Response 387 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:32:30.517326 (Thread-1228): handling poll request
2020-12-30 18:32:30.517742 (Thread-1228): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc00ac0>]}
2020-12-30 18:32:30.518595 (Thread-1228): sending response (<Response 387 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:32:31.998046 (Thread-1229): handling poll request
2020-12-30 18:32:31.998464 (Thread-1229): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f240a0>]}
2020-12-30 18:32:31.999323 (Thread-1229): sending response (<Response 387 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:32:33.452557 (Thread-1230): handling poll request
2020-12-30 18:32:33.452981 (Thread-1230): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f248b0>]}
2020-12-30 18:32:33.453895 (Thread-1230): sending response (<Response 385 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:32:34.917300 (Thread-1231): handling poll request
2020-12-30 18:32:34.917879 (Thread-1231): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24f40>]}
2020-12-30 18:32:34.918840 (Thread-1231): sending response (<Response 387 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:32:36.420069 (Thread-1232): handling poll request
2020-12-30 18:32:36.420627 (Thread-1232): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91be0>]}
2020-12-30 18:32:36.421825 (Thread-1232): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:32:37.887750 (Thread-1233): handling poll request
2020-12-30 18:32:37.889000 (Thread-1233): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29130>]}
2020-12-30 18:32:37.889943 (Thread-1233): sending response (<Response 387 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:32:39.462067 (Thread-1234): handling poll request
2020-12-30 18:32:39.462481 (Thread-1234): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91a30>]}
2020-12-30 18:32:39.463342 (Thread-1234): sending response (<Response 387 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:32:40.977850 (Thread-1235): handling poll request
2020-12-30 18:32:40.978275 (Thread-1235): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91910>]}
2020-12-30 18:32:40.979164 (Thread-1235): sending response (<Response 387 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:32:42.555800 (Thread-1236): handling poll request
2020-12-30 18:32:42.556223 (Thread-1236): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91ee0>]}
2020-12-30 18:32:42.557153 (Thread-1236): sending response (<Response 387 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:32:44.051116 (Thread-1237): handling poll request
2020-12-30 18:32:44.051616 (Thread-1237): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa19a0>]}
2020-12-30 18:32:44.052563 (Thread-1237): sending response (<Response 387 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:32:45.531074 (Thread-1238): handling poll request
2020-12-30 18:32:45.531493 (Thread-1238): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f8d460>]}
2020-12-30 18:32:45.532378 (Thread-1238): sending response (<Response 387 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:32:47.193321 (Thread-1239): handling poll request
2020-12-30 18:32:47.193730 (Thread-1239): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f8dac0>]}
2020-12-30 18:32:47.194612 (Thread-1239): sending response (<Response 387 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:32:48.670151 (Thread-1240): handling poll request
2020-12-30 18:32:48.670615 (Thread-1240): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f8d6d0>]}
2020-12-30 18:32:48.671482 (Thread-1240): sending response (<Response 387 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:32:50.156935 (Thread-1241): handling poll request
2020-12-30 18:32:50.157377 (Thread-1241): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f8d8e0>]}
2020-12-30 18:32:50.158590 (Thread-1241): sending response (<Response 387 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:32:51.674487 (Thread-1242): handling poll request
2020-12-30 18:32:51.674924 (Thread-1242): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f8d250>]}
2020-12-30 18:32:51.675793 (Thread-1242): sending response (<Response 387 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:32:53.196934 (Thread-1243): handling poll request
2020-12-30 18:32:53.197376 (Thread-1243): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f8d1f0>]}
2020-12-30 18:32:53.198249 (Thread-1243): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:32:54.663470 (Thread-1244): handling poll request
2020-12-30 18:32:54.663897 (Thread-1244): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1070>]}
2020-12-30 18:32:54.664797 (Thread-1244): sending response (<Response 387 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:32:56.140013 (Thread-1245): handling poll request
2020-12-30 18:32:56.140420 (Thread-1245): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24e50>]}
2020-12-30 18:32:56.141292 (Thread-1245): sending response (<Response 387 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:32:57.619272 (Thread-1246): handling poll request
2020-12-30 18:32:57.619701 (Thread-1246): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24a60>]}
2020-12-30 18:32:57.620560 (Thread-1246): sending response (<Response 387 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:32:59.137893 (Thread-1247): handling poll request
2020-12-30 18:32:59.138356 (Thread-1247): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f8de80>]}
2020-12-30 18:32:59.139223 (Thread-1247): sending response (<Response 387 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:33:00.619447 (Thread-1248): handling poll request
2020-12-30 18:33:00.619854 (Thread-1248): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24a60>]}
2020-12-30 18:33:00.620718 (Thread-1248): sending response (<Response 387 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:33:02.118717 (Thread-1249): handling poll request
2020-12-30 18:33:02.119131 (Thread-1249): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29a00>]}
2020-12-30 18:33:02.120000 (Thread-1249): sending response (<Response 387 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:33:03.660320 (Thread-1250): handling poll request
2020-12-30 18:33:03.660767 (Thread-1250): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29430>]}
2020-12-30 18:33:03.661744 (Thread-1250): sending response (<Response 387 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:33:05.145021 (Thread-1251): handling poll request
2020-12-30 18:33:05.145467 (Thread-1251): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91040>]}
2020-12-30 18:33:05.146366 (Thread-1251): sending response (<Response 387 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:33:06.627672 (Thread-1252): handling poll request
2020-12-30 18:33:06.628291 (Thread-1252): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f913d0>]}
2020-12-30 18:33:06.629504 (Thread-1252): sending response (<Response 386 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:33:08.103570 (Thread-1253): handling poll request
2020-12-30 18:33:08.103993 (Thread-1253): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91070>]}
2020-12-30 18:33:08.104897 (Thread-1253): sending response (<Response 387 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:33:09.597974 (Thread-1254): handling poll request
2020-12-30 18:33:09.598614 (Thread-1254): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f8de50>]}
2020-12-30 18:33:09.599760 (Thread-1254): sending response (<Response 387 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:33:11.179755 (Thread-1255): handling poll request
2020-12-30 18:33:11.180175 (Thread-1255): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91340>]}
2020-12-30 18:33:11.181337 (Thread-1255): sending response (<Response 387 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:33:12.679151 (Thread-1256): handling poll request
2020-12-30 18:33:12.679576 (Thread-1256): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f914c0>]}
2020-12-30 18:33:12.680454 (Thread-1256): sending response (<Response 387 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:33:14.154877 (Thread-1257): handling poll request
2020-12-30 18:33:14.155328 (Thread-1257): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91910>]}
2020-12-30 18:33:14.280249 (Thread-1257): sending response (<Response 387 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:33:15.748839 (Thread-1258): handling poll request
2020-12-30 18:33:15.749299 (Thread-1258): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29940>]}
2020-12-30 18:33:15.750347 (Thread-1258): sending response (<Response 387 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:33:17.269626 (Thread-1259): handling poll request
2020-12-30 18:33:17.270098 (Thread-1259): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfd2a790>]}
2020-12-30 18:33:17.271017 (Thread-1259): sending response (<Response 387 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:33:18.760531 (Thread-1260): handling poll request
2020-12-30 18:33:18.760970 (Thread-1260): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29730>]}
2020-12-30 18:33:18.761953 (Thread-1260): sending response (<Response 387 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:33:20.267328 (Thread-1261): handling poll request
2020-12-30 18:33:20.267778 (Thread-1261): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24310>]}
2020-12-30 18:33:20.268687 (Thread-1261): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:33:21.751764 (Thread-1262): handling poll request
2020-12-30 18:33:21.752355 (Thread-1262): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24d60>]}
2020-12-30 18:33:21.753348 (Thread-1262): sending response (<Response 387 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:33:23.245467 (Thread-1263): handling poll request
2020-12-30 18:33:23.245940 (Thread-1263): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f240d0>]}
2020-12-30 18:33:23.246890 (Thread-1263): sending response (<Response 387 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:33:24.734535 (Thread-1264): handling poll request
2020-12-30 18:33:24.735096 (Thread-1264): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa19a0>]}
2020-12-30 18:33:24.736132 (Thread-1264): sending response (<Response 387 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:33:26.218454 (Thread-1265): handling poll request
2020-12-30 18:33:26.218914 (Thread-1265): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f550>]}
2020-12-30 18:33:26.219821 (Thread-1265): sending response (<Response 386 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:33:27.713410 (Thread-1266): handling poll request
2020-12-30 18:33:27.713916 (Thread-1266): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f5e0>]}
2020-12-30 18:33:27.714898 (Thread-1266): sending response (<Response 388 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:33:29.197015 (Thread-1267): handling poll request
2020-12-30 18:33:29.197466 (Thread-1267): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2fee0>]}
2020-12-30 18:33:29.198363 (Thread-1267): sending response (<Response 388 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:33:30.671722 (Thread-1268): handling poll request
2020-12-30 18:33:30.672133 (Thread-1268): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f400>]}
2020-12-30 18:33:30.673031 (Thread-1268): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:33:32.160670 (Thread-1269): handling poll request
2020-12-30 18:33:32.161131 (Thread-1269): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f0d0>]}
2020-12-30 18:33:32.162019 (Thread-1269): sending response (<Response 388 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:33:33.694028 (Thread-1270): handling poll request
2020-12-30 18:33:33.694449 (Thread-1270): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f9d0>]}
2020-12-30 18:33:33.695322 (Thread-1270): sending response (<Response 387 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:33:35.238137 (Thread-1271): handling poll request
2020-12-30 18:33:35.238558 (Thread-1271): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f760>]}
2020-12-30 18:33:35.239434 (Thread-1271): sending response (<Response 388 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:33:36.742119 (Thread-1272): handling poll request
2020-12-30 18:33:36.742563 (Thread-1272): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29e80>]}
2020-12-30 18:33:36.743450 (Thread-1272): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:33:38.225822 (Thread-1273): handling poll request
2020-12-30 18:33:38.226248 (Thread-1273): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29fd0>]}
2020-12-30 18:33:38.227126 (Thread-1273): sending response (<Response 388 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:33:39.705745 (Thread-1274): handling poll request
2020-12-30 18:33:39.706159 (Thread-1274): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29b20>]}
2020-12-30 18:33:39.707035 (Thread-1274): sending response (<Response 388 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:33:41.208302 (Thread-1275): handling poll request
2020-12-30 18:33:41.208765 (Thread-1275): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d520d820>]}
2020-12-30 18:33:41.209671 (Thread-1275): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:33:42.699411 (Thread-1276): handling poll request
2020-12-30 18:33:42.699842 (Thread-1276): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1280>]}
2020-12-30 18:33:42.700728 (Thread-1276): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:33:44.287492 (Thread-1277): handling poll request
2020-12-30 18:33:44.287924 (Thread-1277): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24160>]}
2020-12-30 18:33:44.288810 (Thread-1277): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:33:45.780571 (Thread-1278): handling poll request
2020-12-30 18:33:45.780998 (Thread-1278): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f248b0>]}
2020-12-30 18:33:45.781893 (Thread-1278): sending response (<Response 388 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:33:47.282324 (Thread-1279): handling poll request
2020-12-30 18:33:47.282748 (Thread-1279): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24f40>]}
2020-12-30 18:33:47.283615 (Thread-1279): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:33:48.767056 (Thread-1280): handling poll request
2020-12-30 18:33:48.767469 (Thread-1280): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91f40>]}
2020-12-30 18:33:48.768362 (Thread-1280): sending response (<Response 387 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:33:50.340028 (Thread-1281): handling poll request
2020-12-30 18:33:50.340441 (Thread-1281): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91f40>]}
2020-12-30 18:33:50.341366 (Thread-1281): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:33:51.816744 (Thread-1282): handling poll request
2020-12-30 18:33:51.817198 (Thread-1282): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91700>]}
2020-12-30 18:33:51.818351 (Thread-1282): sending response (<Response 388 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:33:53.280173 (Thread-1283): handling poll request
2020-12-30 18:33:53.280592 (Thread-1283): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24c10>]}
2020-12-30 18:33:53.281477 (Thread-1283): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:33:54.781800 (Thread-1284): handling poll request
2020-12-30 18:33:54.782289 (Thread-1284): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24250>]}
2020-12-30 18:33:54.783585 (Thread-1284): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:33:56.248475 (Thread-1285): handling poll request
2020-12-30 18:33:56.248911 (Thread-1285): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24610>]}
2020-12-30 18:33:56.249823 (Thread-1285): sending response (<Response 388 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:33:57.841431 (Thread-1286): handling poll request
2020-12-30 18:33:57.841851 (Thread-1286): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24af0>]}
2020-12-30 18:33:57.842727 (Thread-1286): sending response (<Response 388 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:33:59.319559 (Thread-1287): handling poll request
2020-12-30 18:33:59.319980 (Thread-1287): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfd9ac40>]}
2020-12-30 18:33:59.425142 (Thread-1287): sending response (<Response 388 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:34:00.909863 (Thread-1288): handling poll request
2020-12-30 18:34:00.910285 (Thread-1288): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cff7f400>]}
2020-12-30 18:34:00.911163 (Thread-1288): sending response (<Response 388 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:34:02.437453 (Thread-1289): handling poll request
2020-12-30 18:34:02.437874 (Thread-1289): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f292e0>]}
2020-12-30 18:34:02.438895 (Thread-1289): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:34:03.960550 (Thread-1290): handling poll request
2020-12-30 18:34:03.961000 (Thread-1290): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc008e0>]}
2020-12-30 18:34:03.961906 (Thread-1290): sending response (<Response 388 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:34:05.438633 (Thread-1291): handling poll request
2020-12-30 18:34:05.439103 (Thread-1291): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc007c0>]}
2020-12-30 18:34:05.439960 (Thread-1291): sending response (<Response 387 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:34:06.935002 (Thread-1292): handling poll request
2020-12-30 18:34:06.935416 (Thread-1292): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f563a0>]}
2020-12-30 18:34:06.936275 (Thread-1292): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:34:08.393092 (Thread-1293): handling poll request
2020-12-30 18:34:08.393516 (Thread-1293): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56790>]}
2020-12-30 18:34:08.394375 (Thread-1293): sending response (<Response 387 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:34:09.856799 (Thread-1294): handling poll request
2020-12-30 18:34:09.857244 (Thread-1294): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91070>]}
2020-12-30 18:34:09.858113 (Thread-1294): sending response (<Response 388 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:34:11.350217 (Thread-1295): handling poll request
2020-12-30 18:34:11.350667 (Thread-1295): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc00940>]}
2020-12-30 18:34:11.351547 (Thread-1295): sending response (<Response 388 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:34:12.818533 (Thread-1296): handling poll request
2020-12-30 18:34:12.818956 (Thread-1296): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f914f0>]}
2020-12-30 18:34:12.819832 (Thread-1296): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:34:14.302415 (Thread-1297): handling poll request
2020-12-30 18:34:14.302837 (Thread-1297): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2fe20>]}
2020-12-30 18:34:14.303716 (Thread-1297): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:34:15.826543 (Thread-1298): handling poll request
2020-12-30 18:34:15.827060 (Thread-1298): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f567c0>]}
2020-12-30 18:34:15.827967 (Thread-1298): sending response (<Response 388 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:34:17.321308 (Thread-1299): handling poll request
2020-12-30 18:34:17.321862 (Thread-1299): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f310>]}
2020-12-30 18:34:17.323051 (Thread-1299): sending response (<Response 388 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:34:18.814122 (Thread-1300): handling poll request
2020-12-30 18:34:18.814544 (Thread-1300): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24820>]}
2020-12-30 18:34:18.815427 (Thread-1300): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:34:20.303685 (Thread-1301): handling poll request
2020-12-30 18:34:20.304128 (Thread-1301): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f244f0>]}
2020-12-30 18:34:20.305427 (Thread-1301): sending response (<Response 386 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:34:21.783913 (Thread-1302): handling poll request
2020-12-30 18:34:21.784355 (Thread-1302): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24cd0>]}
2020-12-30 18:34:21.785313 (Thread-1302): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:34:23.253960 (Thread-1303): handling poll request
2020-12-30 18:34:23.254390 (Thread-1303): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f6d0>]}
2020-12-30 18:34:23.255291 (Thread-1303): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:34:24.852107 (Thread-1304): handling poll request
2020-12-30 18:34:24.852533 (Thread-1304): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f2f9d0>]}
2020-12-30 18:34:24.853449 (Thread-1304): sending response (<Response 388 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:34:26.455375 (Thread-1305): handling poll request
2020-12-30 18:34:26.455799 (Thread-1305): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91af0>]}
2020-12-30 18:34:26.456693 (Thread-1305): sending response (<Response 387 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:34:27.925416 (Thread-1306): handling poll request
2020-12-30 18:34:27.925854 (Thread-1306): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f916d0>]}
2020-12-30 18:34:27.926757 (Thread-1306): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:34:29.418667 (Thread-1307): handling poll request
2020-12-30 18:34:29.419228 (Thread-1307): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91e20>]}
2020-12-30 18:34:29.420423 (Thread-1307): sending response (<Response 388 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:34:30.933828 (Thread-1308): handling poll request
2020-12-30 18:34:30.934253 (Thread-1308): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91100>]}
2020-12-30 18:34:30.935173 (Thread-1308): sending response (<Response 388 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:34:32.414946 (Thread-1309): handling poll request
2020-12-30 18:34:32.415367 (Thread-1309): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29ca0>]}
2020-12-30 18:34:32.416253 (Thread-1309): sending response (<Response 388 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:34:33.927964 (Thread-1310): handling poll request
2020-12-30 18:34:33.928392 (Thread-1310): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29160>]}
2020-12-30 18:34:33.929293 (Thread-1310): sending response (<Response 388 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:34:35.426416 (Thread-1311): handling poll request
2020-12-30 18:34:35.426839 (Thread-1311): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56b80>]}
2020-12-30 18:34:35.427733 (Thread-1311): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:34:36.905348 (Thread-1312): handling poll request
2020-12-30 18:34:36.905789 (Thread-1312): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56190>]}
2020-12-30 18:34:36.906695 (Thread-1312): sending response (<Response 387 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:34:38.395640 (Thread-1313): handling poll request
2020-12-30 18:34:38.396071 (Thread-1313): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56610>]}
2020-12-30 18:34:38.396971 (Thread-1313): sending response (<Response 388 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:34:39.872252 (Thread-1314): handling poll request
2020-12-30 18:34:39.872671 (Thread-1314): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56940>]}
2020-12-30 18:34:39.873570 (Thread-1314): sending response (<Response 388 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:34:41.400624 (Thread-1315): handling poll request
2020-12-30 18:34:41.401040 (Thread-1315): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc00a30>]}
2020-12-30 18:34:41.402501 (Thread-1315): sending response (<Response 388 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:34:42.894129 (Thread-1316): handling poll request
2020-12-30 18:34:42.894542 (Thread-1316): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56280>]}
2020-12-30 18:34:42.895441 (Thread-1316): sending response (<Response 388 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:34:44.404889 (Thread-1317): handling poll request
2020-12-30 18:34:44.405352 (Thread-1317): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56af0>]}
2020-12-30 18:34:44.530662 (Thread-1317): sending response (<Response 388 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:34:46.020217 (Thread-1318): handling poll request
2020-12-30 18:34:46.020650 (Thread-1318): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29a00>]}
2020-12-30 18:34:46.021577 (Thread-1318): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:34:47.537654 (Thread-1319): handling poll request
2020-12-30 18:34:47.538090 (Thread-1319): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91940>]}
2020-12-30 18:34:47.538976 (Thread-1319): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:34:49.035764 (Thread-1320): handling poll request
2020-12-30 18:34:49.036206 (Thread-1320): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91b80>]}
2020-12-30 18:34:49.037137 (Thread-1320): sending response (<Response 388 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:34:50.513088 (Thread-1321): handling poll request
2020-12-30 18:34:50.513519 (Thread-1321): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91430>]}
2020-12-30 18:34:50.514386 (Thread-1321): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:34:52.008453 (Thread-1322): handling poll request
2020-12-30 18:34:52.008871 (Thread-1322): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91910>]}
2020-12-30 18:34:52.009770 (Thread-1322): sending response (<Response 388 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:34:54.260530 (Thread-1323): handling poll request
2020-12-30 18:34:54.260953 (Thread-1323): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc008b0>]}
2020-12-30 18:34:54.261880 (Thread-1323): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:34:55.761033 (Thread-1324): handling poll request
2020-12-30 18:34:55.761473 (Thread-1324): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc00e50>]}
2020-12-30 18:34:55.762328 (Thread-1324): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:34:57.779893 (Thread-1325): handling poll request
2020-12-30 18:34:57.780303 (Thread-1325): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc00640>]}
2020-12-30 18:34:57.781201 (Thread-1325): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:34:59.774428 (Thread-1326): handling poll request
2020-12-30 18:34:59.774872 (Thread-1326): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc009d0>]}
2020-12-30 18:34:59.775752 (Thread-1326): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:35:01.797969 (Thread-1327): handling poll request
2020-12-30 18:35:01.798389 (Thread-1327): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f89dc0>]}
2020-12-30 18:35:01.799258 (Thread-1327): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:35:03.735332 (Thread-1328): handling poll request
2020-12-30 18:35:03.735792 (Thread-1328): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f89580>]}
2020-12-30 18:35:03.736686 (Thread-1328): sending response (<Response 388 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:35:05.780253 (Thread-1329): handling poll request
2020-12-30 18:35:05.780679 (Thread-1329): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f893a0>]}
2020-12-30 18:35:05.781596 (Thread-1329): sending response (<Response 388 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:35:07.764919 (Thread-1330): handling poll request
2020-12-30 18:35:07.765428 (Thread-1330): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f891f0>]}
2020-12-30 18:35:07.766321 (Thread-1330): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:35:09.800739 (Thread-1331): handling poll request
2020-12-30 18:35:09.801180 (Thread-1331): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc003d0>]}
2020-12-30 18:35:09.802064 (Thread-1331): sending response (<Response 388 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:35:11.752472 (Thread-1332): handling poll request
2020-12-30 18:35:11.752907 (Thread-1332): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc00730>]}
2020-12-30 18:35:11.753829 (Thread-1332): sending response (<Response 388 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:35:13.753738 (Thread-1333): handling poll request
2020-12-30 18:35:13.754176 (Thread-1333): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc00d30>]}
2020-12-30 18:35:13.755072 (Thread-1333): sending response (<Response 388 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:35:15.784704 (Thread-1334): handling poll request
2020-12-30 18:35:15.785201 (Thread-1334): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f89ca0>]}
2020-12-30 18:35:15.786084 (Thread-1334): sending response (<Response 388 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:35:17.794876 (Thread-1335): handling poll request
2020-12-30 18:35:17.795316 (Thread-1335): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f297f0>]}
2020-12-30 18:35:17.796222 (Thread-1335): sending response (<Response 388 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:35:19.763042 (Thread-1336): handling poll request
2020-12-30 18:35:19.763473 (Thread-1336): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29cd0>]}
2020-12-30 18:35:19.764364 (Thread-1336): sending response (<Response 388 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:35:21.777352 (Thread-1337): handling poll request
2020-12-30 18:35:21.777779 (Thread-1337): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29ca0>]}
2020-12-30 18:35:21.778653 (Thread-1337): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:35:23.978004 (Thread-1338): handling poll request
2020-12-30 18:35:23.978443 (Thread-1338): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91a30>]}
2020-12-30 18:35:23.979357 (Thread-1338): sending response (<Response 388 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:35:25.780205 (Thread-1339): handling poll request
2020-12-30 18:35:25.780633 (Thread-1339): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91220>]}
2020-12-30 18:35:25.781546 (Thread-1339): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:35:27.779815 (Thread-1340): handling poll request
2020-12-30 18:35:27.780404 (Thread-1340): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91f40>]}
2020-12-30 18:35:27.781668 (Thread-1340): sending response (<Response 388 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:35:29.736853 (Thread-1341): handling poll request
2020-12-30 18:35:29.737356 (Thread-1341): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f893a0>]}
2020-12-30 18:35:29.738220 (Thread-1341): sending response (<Response 387 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:35:31.784052 (Thread-1342): handling poll request
2020-12-30 18:35:31.784469 (Thread-1342): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f569d0>]}
2020-12-30 18:35:31.785632 (Thread-1342): sending response (<Response 388 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:35:33.756216 (Thread-1343): handling poll request
2020-12-30 18:35:33.756641 (Thread-1343): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f910d0>]}
2020-12-30 18:35:33.757567 (Thread-1343): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:35:35.467592 (Thread-1344): handling poll request
2020-12-30 18:35:35.468049 (Thread-1344): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56f10>]}
2020-12-30 18:35:35.468924 (Thread-1344): sending response (<Response 388 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:35:36.935512 (Thread-1345): handling poll request
2020-12-30 18:35:36.935936 (Thread-1345): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f9a670>]}
2020-12-30 18:35:36.936840 (Thread-1345): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:35:38.546969 (Thread-1346): handling poll request
2020-12-30 18:35:38.547394 (Thread-1346): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f918b0>]}
2020-12-30 18:35:38.548270 (Thread-1346): sending response (<Response 388 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:35:40.034076 (Thread-1347): handling poll request
2020-12-30 18:35:40.034501 (Thread-1347): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f299d0>]}
2020-12-30 18:35:40.140384 (Thread-1347): sending response (<Response 388 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:35:41.639838 (Thread-1348): handling poll request
2020-12-30 18:35:41.640253 (Thread-1348): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f29430>]}
2020-12-30 18:35:41.641156 (Thread-1348): sending response (<Response 388 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:35:43.103513 (Thread-1349): handling poll request
2020-12-30 18:35:43.103929 (Thread-1349): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f563d0>]}
2020-12-30 18:35:43.104812 (Thread-1349): sending response (<Response 388 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:35:44.617723 (Thread-1350): handling poll request
2020-12-30 18:35:44.618150 (Thread-1350): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56190>]}
2020-12-30 18:35:44.619024 (Thread-1350): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:35:46.792955 (Thread-1351): handling poll request
2020-12-30 18:35:46.793416 (Thread-1351): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56dc0>]}
2020-12-30 18:35:46.794288 (Thread-1351): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:35:48.759009 (Thread-1352): handling poll request
2020-12-30 18:35:48.759433 (Thread-1352): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1dc0>]}
2020-12-30 18:35:48.760328 (Thread-1352): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:35:50.791622 (Thread-1353): handling poll request
2020-12-30 18:35:50.792065 (Thread-1353): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1820>]}
2020-12-30 18:35:50.792984 (Thread-1353): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:35:52.744882 (Thread-1354): handling poll request
2020-12-30 18:35:52.745363 (Thread-1354): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24a60>]}
2020-12-30 18:35:52.746297 (Thread-1354): sending response (<Response 388 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:35:54.788072 (Thread-1355): handling poll request
2020-12-30 18:35:54.788524 (Thread-1355): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f241c0>]}
2020-12-30 18:35:54.789478 (Thread-1355): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:35:56.797831 (Thread-1356): handling poll request
2020-12-30 18:35:56.798272 (Thread-1356): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f248e0>]}
2020-12-30 18:35:56.799187 (Thread-1356): sending response (<Response 386 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:35:58.261787 (Thread-1357): handling poll request
2020-12-30 18:35:58.262219 (Thread-1357): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f244f0>]}
2020-12-30 18:35:58.263121 (Thread-1357): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:35:59.754348 (Thread-1358): handling poll request
2020-12-30 18:35:59.754779 (Thread-1358): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ef2730>]}
2020-12-30 18:35:59.755667 (Thread-1358): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:36:01.240749 (Thread-1359): handling poll request
2020-12-30 18:36:01.241200 (Thread-1359): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ef2910>]}
2020-12-30 18:36:01.242076 (Thread-1359): sending response (<Response 388 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:36:02.798103 (Thread-1360): handling poll request
2020-12-30 18:36:02.798533 (Thread-1360): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ef2e80>]}
2020-12-30 18:36:02.799399 (Thread-1360): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:36:04.345285 (Thread-1361): handling poll request
2020-12-30 18:36:04.345711 (Thread-1361): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ef20d0>]}
2020-12-30 18:36:04.346926 (Thread-1361): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:36:05.804048 (Thread-1362): handling poll request
2020-12-30 18:36:05.804481 (Thread-1362): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ef2460>]}
2020-12-30 18:36:05.805406 (Thread-1362): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:36:07.384202 (Thread-1363): handling poll request
2020-12-30 18:36:07.384637 (Thread-1363): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ef2160>]}
2020-12-30 18:36:07.385532 (Thread-1363): sending response (<Response 388 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:36:08.962076 (Thread-1364): handling poll request
2020-12-30 18:36:08.962502 (Thread-1364): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ef26a0>]}
2020-12-30 18:36:08.963385 (Thread-1364): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:36:10.418244 (Thread-1365): handling poll request
2020-12-30 18:36:10.418674 (Thread-1365): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f245e0>]}
2020-12-30 18:36:10.419561 (Thread-1365): sending response (<Response 388 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:36:11.894620 (Thread-1366): handling poll request
2020-12-30 18:36:11.895066 (Thread-1366): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24c40>]}
2020-12-30 18:36:11.895959 (Thread-1366): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:36:13.367469 (Thread-1367): handling poll request
2020-12-30 18:36:13.367901 (Thread-1367): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24d60>]}
2020-12-30 18:36:13.368801 (Thread-1367): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:36:14.809852 (Thread-1368): handling poll request
2020-12-30 18:36:14.810287 (Thread-1368): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24a00>]}
2020-12-30 18:36:14.811159 (Thread-1368): sending response (<Response 388 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:36:16.297299 (Thread-1369): handling poll request
2020-12-30 18:36:16.297727 (Thread-1369): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1c10>]}
2020-12-30 18:36:16.298616 (Thread-1369): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:36:17.769347 (Thread-1370): handling poll request
2020-12-30 18:36:17.769770 (Thread-1370): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1550>]}
2020-12-30 18:36:17.770635 (Thread-1370): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:36:19.251579 (Thread-1371): handling poll request
2020-12-30 18:36:19.251991 (Thread-1371): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4fa1ca0>]}
2020-12-30 18:36:19.252876 (Thread-1371): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:36:20.746720 (Thread-1372): handling poll request
2020-12-30 18:36:20.747140 (Thread-1372): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f564f0>]}
2020-12-30 18:36:20.748017 (Thread-1372): sending response (<Response 387 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:36:22.232562 (Thread-1373): handling poll request
2020-12-30 18:36:22.232981 (Thread-1373): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56730>]}
2020-12-30 18:36:22.233887 (Thread-1373): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:36:23.567215 (Thread-1374): handling kill request
2020-12-30 18:36:23.567684 (Thread-1374): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56850>]}
2020-12-30 18:36:23.569859 (Thread-1374): sending response (<Response 113 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:36:24.377638 (Thread-1375): handling poll request
2020-12-30 18:36:24.378078 (Thread-1375): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56b20>]}
2020-12-30 18:36:24.379001 (Thread-1375): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:36:25.874227 (Thread-1376): handling poll request
2020-12-30 18:36:25.874661 (Thread-1376): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f56e80>]}
2020-12-30 18:36:25.875546 (Thread-1376): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:36:27.367370 (Thread-1377): handling poll request
2020-12-30 18:36:27.367794 (Thread-1377): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfd9ac40>]}
2020-12-30 18:36:27.495175 (Thread-1377): sending response (<Response 388 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:36:28.982645 (Thread-1378): handling poll request
2020-12-30 18:36:28.983071 (Thread-1378): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24550>]}
2020-12-30 18:36:28.983957 (Thread-1378): sending response (<Response 388 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:36:30.472049 (Thread-1379): handling poll request
2020-12-30 18:36:30.472479 (Thread-1379): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f244c0>]}
2020-12-30 18:36:30.473395 (Thread-1379): sending response (<Response 388 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:36:31.930625 (Thread-1380): handling poll request
2020-12-30 18:36:31.931058 (Thread-1380): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f245e0>]}
2020-12-30 18:36:31.931934 (Thread-1380): sending response (<Response 388 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:36:57.954629 (Thread-1381): handling status request
2020-12-30 18:36:57.955054 (Thread-1381): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f24040>]}
2020-12-30 18:36:57.956044 (Thread-1381): sending response (<Response 1228 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:36:58.294523 (Thread-1382): handling ps request
2020-12-30 18:36:58.294983 (Thread-1382): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f91550>]}
2020-12-30 18:36:58.325820 (Thread-1382): sending response (<Response 91247 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:36:59.163819 (Thread-1383): handling poll request
2020-12-30 18:36:59.164247 (Thread-1383): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4f8ddc0>]}
2020-12-30 18:36:59.291942 (Thread-1383): sending response (<Response 567103 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:37:58.975748 (Thread-1384): Parsing macros/Segmented_Calc.sql
2020-12-30 18:37:58.984228 (Thread-1384): Parsing macros/NS_Calc.sql
2020-12-30 18:37:59.626960 (Thread-1385): handling status request
2020-12-30 18:37:59.657092 (Thread-1385): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfc89400>]}
2020-12-30 18:37:59.657884 (Thread-1385): sending response (<Response 184 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:37:59.658073 (Thread-1384): Got an acceptable cached parse result
2020-12-30 18:37:59.764370 (Thread-1384): Acquiring new snowflake connection "model.sales_dataflo.test_metrics".
2020-12-30 18:38:00.180982 (Thread-1384): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:38:01.341733 (Thread-1386): handling status request
2020-12-30 18:38:01.342154 (Thread-1386): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4e90eb0>]}
2020-12-30 18:38:01.343286 (Thread-1386): sending response (<Response 1761 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:38:11.136994 (MainThread): Connection 'model.sales_dataflo.test_metrics' was properly closed.
2020-12-30 18:38:11.630538 (Thread-1387): Got an acceptable cached parse result
2020-12-30 18:38:11.722989 (Thread-1387): Acquiring new snowflake connection "model.sales_dataflo.test_metrics".
2020-12-30 18:38:11.746745 (Thread-1388): handling status request
2020-12-30 18:38:11.747205 (Thread-1388): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4187c10>]}
2020-12-30 18:38:11.747960 (Thread-1388): sending response (<Response 184 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:38:12.383129 (Thread-1387): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:38:13.262589 (Thread-1389): handling status request
2020-12-30 18:38:13.263019 (Thread-1389): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d422ab20>]}
2020-12-30 18:38:13.263994 (Thread-1389): sending response (<Response 1236 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:38:19.645252 (MainThread): Connection 'model.sales_dataflo.test_metrics' was properly closed.
2020-12-30 18:38:19.737114 (Thread-1390): Parsing macros/Segmented_Calc.sql
2020-12-30 18:38:19.745261 (Thread-1390): Parsing macros/NS_Calc.sql
2020-12-30 18:38:20.123935 (Thread-1390): Got an acceptable cached parse result
2020-12-30 18:38:20.223875 (Thread-1391): handling status request
2020-12-30 18:38:20.224327 (Thread-1391): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4668ca0>]}
2020-12-30 18:38:20.225153 (Thread-1391): sending response (<Response 184 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:38:20.604742 (Thread-1390): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:38:21.719444 (Thread-1392): handling status request
2020-12-30 18:38:21.719875 (Thread-1392): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d72006d0>]}
2020-12-30 18:38:21.720931 (Thread-1392): sending response (<Response 1456 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:38:42.628255 (Thread-1393): Got an acceptable cached parse result
2020-12-30 18:38:42.658857 (Thread-1394): handling status request
2020-12-30 18:38:42.659235 (Thread-1394): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfe646a0>]}
2020-12-30 18:38:42.659906 (Thread-1394): sending response (<Response 184 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:38:42.746107 (Thread-1393): Acquiring new snowflake connection "model.sales_dataflo.test".
2020-12-30 18:38:43.363025 (Thread-1393): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:38:44.201777 (Thread-1395): handling status request
2020-12-30 18:38:44.202214 (Thread-1395): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d6041c40>]}
2020-12-30 18:38:44.203223 (Thread-1395): sending response (<Response 1228 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:40:32.600523 (MainThread): Connection 'model.sales_dataflo.test' was properly closed.
2020-12-30 18:40:32.706283 (Thread-1396): Parsing macros/Segmented_Calc.sql
2020-12-30 18:40:32.711867 (Thread-1396): Parsing macros/NS_History_Calc.sql
2020-12-30 18:40:32.720662 (Thread-1396): Parsing macros/NS_Calc.sql
2020-12-30 18:40:33.105897 (Thread-1396): Got an acceptable cached parse result
2020-12-30 18:40:33.595726 (Thread-1396): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:40:33.674743 (Thread-1397): handling status request
2020-12-30 18:40:33.675160 (Thread-1397): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5245970>]}
2020-12-30 18:40:33.676277 (Thread-1397): sending response (<Response 1723 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:41:45.952568 (Thread-1398): handling status request
2020-12-30 18:41:45.954577 (Thread-1398): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d52454f0>]}
2020-12-30 18:41:45.955749 (Thread-1398): sending response (<Response 1723 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:41:46.409792 (Thread-1399): handling run_sql request
2020-12-30 18:41:46.410212 (Thread-1399): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d7bb70d0>]}
2020-12-30 18:41:47.476162 (Thread-1399): sending response (<Response 137 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:41:47.495348 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:41:47.512182 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:41:47.539776 (MainThread): Found 31 models, 0 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:41:47.540183 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:41:47.540286 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-30 18:41:47.555587 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.request model triggered this warning. 
2020-12-30 18:41:47.557695 (Thread-1): finished collecting timing info
2020-12-30 18:41:47.559049 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-30 18:41:47.559108 (Thread-1): On rpc.sales_dataflo.request: With user AS(
    select *  from DBT_TEST_LIVEDATA_RK.user
),usr_role AS(
    select *  from DBT_TEST_LIVEDATA_RK.user_role
),Dim_Employee AS(
 SELECT
   md5(cast(
    
    coalesce(cast(user.id as 
    varchar
), '')

 as 
    varchar
)) AS employee_id,
   ACCOUNT_ID AS emp_account_id,
   user.id AS source_Emp_id,
   cast('FIVETRAN_SF' as varchar(50)) AS Entity_id, 
   COMPANY_NAME AS org_name,
   EMPLOYEE_NUMBER AS employee_code,
   FIRST_NAME AS first_name,
   NULL AS middle_name,
   LAST_NAME AS last_name,
   user.NAME AS emp_full_nm,
   USER_ROLE_ID AS emp_role_id,
   usr_role. NAME AS emp_position_level,
   NULL  AS emp_gender,
   PHONE AS emp_phone_number,
   EMAIL AS emp_email,
   NULL AS sales_branch_id,
   NULL AS sales_branch_name,
   NULL AS sales_region_id,
   NULL AS sales_region_name,
   NULL AS sales_zone_id,
   NULL AS sales_zone_name,
   NULL AS business_unit_id,
   DEPARTMENT AS business_unit_name,
   CREATED_DATE AS emp_create_dt,
   user.LAST_MODIFIED_DATE AS emp_last_update_dt,
   MANAGER_ID AS mngr_emp_id,
   usr_role.NAME AS mngr_position_level,
   USER_ROLE_ID AS mngr_role_id,
   NULL AS emp_financial_year_start,
   NULL AS emp_start_of_week,
   NULL AS Weekly_working_days,
   IS_ACTIVE AS  emp_active,
     'SF'  as Source_type,
   'D_EMPLOYEE_DIM_LOAD' AS DW_SESSION_NM,
   
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
  FROM
      user left join usr_role  on user.USER_ROLE_ID = usr_role.ID
)

select * from Dim_Employee
2020-12-30 18:41:47.559162 (Thread-1): Opening a new connection, currently in state init
2020-12-30 18:41:47.914375 (Thread-1400): handling poll request
2020-12-30 18:41:47.914861 (Thread-1400): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d7bb70d0>]}
2020-12-30 18:41:47.917164 (Thread-1400): sending response (<Response 5363 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:41:48.954911 (Thread-1): SQL status: SUCCESS 3466 in 1.40 seconds
2020-12-30 18:41:49.438660 (Thread-1401): handling poll request
2020-12-30 18:41:49.439110 (Thread-1401): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d5233130>]}
2020-12-30 18:41:49.440115 (Thread-1401): sending response (<Response 665 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:41:49.672983 (Thread-1): finished collecting timing info
2020-12-30 18:41:49.673449 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-30 18:41:50.903052 (Thread-1402): handling poll request
2020-12-30 18:41:50.903481 (Thread-1402): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfcdb130>]}
2020-12-30 18:41:50.945410 (Thread-1402): sending response (<Response 1638408 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:42:47.570999 (Thread-1403): Got an acceptable cached parse result
2020-12-30 18:42:47.681807 (Thread-1403): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2020-12-30 18:42:48.079183 (Thread-1403): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-30 18:42:48.128512 (Thread-1404): handling status request
2020-12-30 18:42:48.128898 (Thread-1404): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ee7040>]}
2020-12-30 18:42:48.129917 (Thread-1404): sending response (<Response 1241 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:43:11.831209 (Thread-1405): handling status request
2020-12-30 18:43:11.831626 (Thread-1405): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ee7820>]}
2020-12-30 18:43:11.832604 (Thread-1405): sending response (<Response 1241 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:43:11.839814 (Thread-1406): handling status request
2020-12-30 18:43:11.840094 (Thread-1406): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ee7130>]}
2020-12-30 18:43:11.840912 (Thread-1406): sending response (<Response 1241 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:43:12.334235 (Thread-1407): handling cli_args request
2020-12-30 18:43:12.334673 (Thread-1407): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ee74c0>]}
2020-12-30 18:43:12.345398 (Thread-1407): Connection 'model.sales_dataflo.Dim_Employee_Hier' was properly closed.
2020-12-30 18:43:13.542317 (Thread-1407): sending response (<Response 137 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:43:13.676429 (MainThread): Partial parsing not enabled
2020-12-30 18:43:13.684119 (MainThread): Parsing macros/Segmented_Calc.sql
2020-12-30 18:43:13.687779 (MainThread): Parsing macros/NS_History_Calc.sql
2020-12-30 18:43:13.697196 (MainThread): Parsing macros/NS_Calc.sql
2020-12-30 18:43:13.701880 (MainThread): Parsing macros/Segmented_History_Calc.sql
2020-12-30 18:43:13.710215 (MainThread): Parsing macros/Archive/NS_Opportunity_History.sql
2020-12-30 18:43:13.716195 (MainThread): Parsing macros/Archive/NS_Account_History.sql
2020-12-30 18:43:13.722931 (MainThread): Parsing macros/Archive/NS_Lead_History.sql
2020-12-30 18:43:13.728949 (MainThread): Parsing macros/Archive/NS_Contact_History.sql
2020-12-30 18:43:13.731801 (MainThread): Parsing macros/adapters.sql
2020-12-30 18:43:13.760202 (MainThread): Parsing macros/catalog.sql
2020-12-30 18:43:13.762318 (MainThread): Parsing macros/materializations/table.sql
2020-12-30 18:43:13.766266 (MainThread): Parsing macros/materializations/merge.sql
2020-12-30 18:43:13.768331 (MainThread): Parsing macros/materializations/view.sql
2020-12-30 18:43:13.769903 (MainThread): Parsing macros/materializations/incremental.sql
2020-12-30 18:43:13.779970 (MainThread): Parsing macros/core.sql
2020-12-30 18:43:13.783700 (MainThread): Parsing macros/adapters/common.sql
2020-12-30 18:43:13.829007 (MainThread): Parsing macros/materializations/helpers.sql
2020-12-30 18:43:13.837951 (MainThread): Parsing macros/materializations/table/table.sql
2020-12-30 18:43:13.844740 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-12-30 18:43:13.865368 (MainThread): Parsing macros/materializations/view/view.sql
2020-12-30 18:43:13.871652 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-12-30 18:43:13.876692 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-12-30 18:43:13.878606 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-12-30 18:43:13.884673 (MainThread): Parsing macros/materializations/common/merge.sql
2020-12-30 18:43:13.898592 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-12-30 18:43:13.915005 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-12-30 18:43:13.916823 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-12-30 18:43:13.945011 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-12-30 18:43:13.947055 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-12-30 18:43:13.948634 (MainThread): Parsing macros/schema_tests/unique.sql
2020-12-30 18:43:13.950402 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-12-30 18:43:13.953124 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-12-30 18:43:13.954830 (MainThread): Parsing macros/etc/query.sql
2020-12-30 18:43:13.955934 (MainThread): Parsing macros/etc/datetime.sql
2020-12-30 18:43:13.964679 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-12-30 18:43:13.965709 (MainThread): Parsing macros/etc/is_incremental.sql
2020-12-30 18:43:13.967342 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-12-30 18:43:13.980387 (Thread-1408): handling poll request
2020-12-30 18:43:13.980933 (Thread-1408): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ee74c0>]}
2020-12-30 18:43:13.987652 (Thread-1408): sending response (<Response 10754 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:43:13.986738 (MainThread): Parsing macros/logger/pretty_time.sql
2020-12-30 18:43:13.991181 (MainThread): Parsing macros/logger/log_info.sql
2020-12-30 18:43:13.995475 (MainThread): Parsing macros/logger/pretty_log_format.sql
2020-12-30 18:43:13.999907 (MainThread): Parsing macros/sql/pivot.sql
2020-12-30 18:43:14.006224 (MainThread): Parsing macros/sql/star.sql
2020-12-30 18:43:14.012455 (MainThread): Parsing macros/sql/surrogate_key.sql
2020-12-30 18:43:14.019336 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2020-12-30 18:43:14.024750 (MainThread): Parsing macros/sql/get_column_values.sql
2020-12-30 18:43:14.032519 (MainThread): Parsing macros/sql/groupby.sql
2020-12-30 18:43:14.042149 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2020-12-30 18:43:14.054303 (MainThread): Parsing macros/sql/nullcheck_table.sql
2020-12-30 18:43:14.059741 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-12-30 18:43:14.065239 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2020-12-30 18:43:14.073220 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2020-12-30 18:43:14.081434 (MainThread): Parsing macros/sql/safe_add.sql
2020-12-30 18:43:14.086280 (MainThread): Parsing macros/sql/unpivot.sql
2020-12-30 18:43:14.096276 (MainThread): Parsing macros/sql/generate_series.sql
2020-12-30 18:43:14.103062 (MainThread): Parsing macros/sql/nullcheck.sql
2020-12-30 18:43:14.107578 (MainThread): Parsing macros/sql/union.sql
2020-12-30 18:43:14.119085 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2020-12-30 18:43:14.145880 (MainThread): Parsing macros/web/get_url_parameter.sql
2020-12-30 18:43:14.150699 (MainThread): Parsing macros/web/get_url_path.sql
2020-12-30 18:43:14.157000 (MainThread): Parsing macros/web/get_url_host.sql
2020-12-30 18:43:14.161893 (MainThread): Parsing macros/datetime/date_spine.sql
2020-12-30 18:43:14.168552 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2020-12-30 18:43:14.173087 (MainThread): Parsing macros/schema_tests/not_constant.sql
2020-12-30 18:43:14.178272 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2020-12-30 18:43:14.183550 (MainThread): Parsing macros/schema_tests/equality.sql
2020-12-30 18:43:14.191200 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2020-12-30 18:43:14.197666 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2020-12-30 18:43:14.202674 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2020-12-30 18:43:14.208657 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-12-30 18:43:14.217822 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2020-12-30 18:43:14.223514 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-12-30 18:43:14.229717 (MainThread): Parsing macros/schema_tests/recency.sql
2020-12-30 18:43:14.234466 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2020-12-30 18:43:14.239452 (MainThread): Parsing macros/geo/haversine_distance.sql
2020-12-30 18:43:14.243867 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2020-12-30 18:43:14.249337 (MainThread): Parsing macros/cross_db_utils/length.sql
2020-12-30 18:43:14.254120 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2020-12-30 18:43:14.261012 (MainThread): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2020-12-30 18:43:14.266091 (MainThread): Parsing macros/cross_db_utils/right.sql
2020-12-30 18:43:14.271971 (MainThread): Parsing macros/cross_db_utils/hash.sql
2020-12-30 18:43:14.277215 (MainThread): Parsing macros/cross_db_utils/replace.sql
2020-12-30 18:43:14.281986 (MainThread): Parsing macros/cross_db_utils/concat.sql
2020-12-30 18:43:14.287993 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2020-12-30 18:43:14.293181 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2020-12-30 18:43:14.298585 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2020-12-30 18:43:14.311938 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2020-12-30 18:43:14.318172 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2020-12-30 18:43:14.328633 (MainThread): Parsing macros/cross_db_utils/position.sql
2020-12-30 18:43:14.334266 (MainThread): Parsing macros/cross_db_utils/literal.sql
2020-12-30 18:43:14.338910 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2020-12-30 18:43:14.345185 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2020-12-30 18:43:14.354502 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2020-12-30 18:43:14.359639 (MainThread): Parsing macros/cross_db_utils/except.sql
2020-12-30 18:43:14.366035 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2020-12-30 18:43:14.371565 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2020-12-30 18:43:14.378036 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2020-12-30 18:43:14.387782 (MainThread): Parsing macros/get_date_dimension.sql
2020-12-30 18:43:14.403221 (MainThread): Parsing macros/get_base_dates.sql
2020-12-30 18:43:14.409092 (MainThread): Parsing macros/calendar_date/n_weeks_ago.sql
2020-12-30 18:43:14.413875 (MainThread): Parsing macros/calendar_date/to_unixtimestamp.sql
2020-12-30 18:43:14.419078 (MainThread): Parsing macros/calendar_date/yesterday.sql
2020-12-30 18:43:14.423458 (MainThread): Parsing macros/calendar_date/month_name.sql
2020-12-30 18:43:14.436254 (MainThread): Parsing macros/calendar_date/day_name.sql
2020-12-30 18:43:14.441879 (MainThread): Parsing macros/calendar_date/_get_utils_namespaces.sql
2020-12-30 18:43:14.446937 (MainThread): Parsing macros/calendar_date/date_part.sql
2020-12-30 18:43:14.453207 (MainThread): Parsing macros/calendar_date/n_days_ago.sql
2020-12-30 18:43:14.458613 (MainThread): Parsing macros/calendar_date/now.sql
2020-12-30 18:43:14.463213 (MainThread): Parsing macros/calendar_date/n_months_ago.sql
2020-12-30 18:43:14.469108 (MainThread): Parsing macros/calendar_date/this_week.sql
2020-12-30 18:43:14.474055 (MainThread): Parsing macros/calendar_date/convert_timezone.sql
2020-12-30 18:43:14.481890 (MainThread): Parsing macros/calendar_date/periods_since.sql
2020-12-30 18:43:14.486879 (MainThread): Parsing macros/calendar_date/n_months_away.sql
2020-12-30 18:43:14.492318 (MainThread): Parsing macros/calendar_date/n_days_away.sql
2020-12-30 18:43:14.497835 (MainThread): Parsing macros/calendar_date/last_week.sql
2020-12-30 18:43:14.503058 (MainThread): Parsing macros/calendar_date/n_weeks_away.sql
2020-12-30 18:43:14.508697 (MainThread): Parsing macros/calendar_date/tomorrow.sql
2020-12-30 18:43:14.513309 (MainThread): Parsing macros/calendar_date/today.sql
2020-12-30 18:43:14.518124 (MainThread): Parsing macros/fiscal_date/get_fiscal_periods.sql
2020-12-30 18:43:14.525135 (MainThread): Parsing macros/fiscal_date/get_fiscal_year_dates.sql
2020-12-30 18:43:14.553300 (MainThread): Partial parsing not enabled
2020-12-30 18:43:14.634714 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-30 18:43:14.659568 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-30 18:43:14.675762 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-30 18:43:14.690227 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Address".
2020-12-30 18:43:14.703999 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-30 18:43:14.718362 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-30 18:43:14.732875 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-30 18:43:14.747438 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-30 18:43:14.761968 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Employee".
2020-12-30 18:43:14.778071 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-30 18:43:14.797152 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-30 18:43:14.816233 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.VW_Account".
2020-12-30 18:43:14.836486 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Product".
2020-12-30 18:43:14.853858 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Product model triggered this warning. 
2020-12-30 18:43:14.879156 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.test_metrics".
2020-12-30 18:43:14.919414 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:43:14.926075 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity model triggered this warning. 
2020-12-30 18:43:14.937582 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:43:14.943221 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Account model triggered this warning. 
2020-12-30 18:43:14.954753 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:43:14.992397 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Calc".
2020-12-30 18:43:15.006480 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2020-12-30 18:43:15.056783 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2020-12-30 18:43:15.077264 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.test".
2020-12-30 18:43:15.102252 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-30 18:43:15.120185 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:43:15.230055 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:43:15.235673 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Lead model triggered this warning. 
2020-12-30 18:43:15.247670 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-30 18:43:15.253588 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-30 18:43:15.255136 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-30 18:43:15.267296 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales".
2020-12-30 18:43:15.284107 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:43:15.289185 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Contact model triggered this warning. 
2020-12-30 18:43:15.301272 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:43:15.306765 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Employee model triggered this warning. 
2020-12-30 18:43:15.318823 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:43:15.323849 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity_Stage model triggered this warning. 
2020-12-30 18:43:15.335450 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:43:15.341265 (MainThread): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Campaign model triggered this warning. 
2020-12-30 18:43:15.353581 (MainThread): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:43:15.466928 (Thread-1409): handling poll request
2020-12-30 18:43:15.467363 (Thread-1409): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4ee4ca0>]}
2020-12-30 18:43:15.477528 (Thread-1409): sending response (<Response 37724 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:43:15.589168 (MainThread): Acquiring new snowflake connection "model.dbt_date.dim_date_fiscal".
2020-12-30 18:43:15.616198 (MainThread): Acquiring new snowflake connection "model.dbt_date.dim_date".
2020-12-30 18:43:15.635857 (MainThread): Acquiring new snowflake connection "model.dbt_date.dates".
2020-12-30 18:43:15.860025 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Tables
- models.sales_dataflo.Views
- seeds.sales_dataflo

2020-12-30 18:43:15.916472 (MainThread): Found 31 models, 0 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 0 seed files, 0 sources
2020-12-30 18:43:15.918163 (MainThread): 
2020-12-30 18:43:15.918440 (MainThread): Acquiring new snowflake connection "master".
2020-12-30 18:43:15.950347 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DATAFLOTEST_DATABASE".
2020-12-30 18:43:15.959549 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DATAFLOTEST_DATABASE".
2020-12-30 18:43:15.959626 (ThreadPoolExecutor-0_0): On list_DATAFLOTEST_DATABASE: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "list_DATAFLOTEST_DATABASE"} */

    show terse schemas in database DATAFLOTEST_DATABASE
    limit 10000
2020-12-30 18:43:15.959684 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-12-30 18:43:16.593405 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 18 in 0.63 seconds
2020-12-30 18:43:16.595592 (ThreadPoolExecutor-0_0): On list_DATAFLOTEST_DATABASE: Close
2020-12-30 18:43:16.700779 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DATAFLOTEST_DATABASE_dbt_salesdataflo".
2020-12-30 18:43:16.708214 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DATAFLOTEST_DATABASE_dbt_salesdataflo".
2020-12-30 18:43:16.708294 (ThreadPoolExecutor-1_0): On list_DATAFLOTEST_DATABASE_dbt_salesdataflo: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "connection_name": "list_DATAFLOTEST_DATABASE_dbt_salesdataflo"} */

    show terse objects in DATAFLOTEST_DATABASE.dbt_salesdataflo
2020-12-30 18:43:16.708352 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-12-30 18:43:17.196514 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 26 in 0.49 seconds
2020-12-30 18:43:17.219340 (ThreadPoolExecutor-1_0): On list_DATAFLOTEST_DATABASE_dbt_salesdataflo: Close
2020-12-30 18:43:17.303209 (MainThread): Using snowflake connection "master".
2020-12-30 18:43:17.303322 (MainThread): On master: BEGIN
2020-12-30 18:43:17.303384 (MainThread): Opening a new connection, currently in state init
2020-12-30 18:43:17.487525 (Thread-1410): handling poll request
2020-12-30 18:43:17.487944 (Thread-1410): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45bae20>]}
2020-12-30 18:43:17.490458 (Thread-1410): sending response (<Response 7405 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:43:17.809386 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2020-12-30 18:43:17.809580 (MainThread): On master: COMMIT
2020-12-30 18:43:17.809714 (MainThread): Using snowflake connection "master".
2020-12-30 18:43:17.809787 (MainThread): On master: COMMIT
2020-12-30 18:43:17.933233 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2020-12-30 18:43:17.933399 (MainThread): On master: Close
2020-12-30 18:43:17.997824 (MainThread): 18:43:17 | Concurrency: 1 threads (target='default')
2020-12-30 18:43:17.997956 (MainThread): 18:43:17 | 
2020-12-30 18:43:17.999633 (Thread-1): Began running node model.sales_dataflo.Dim_Calendar
2020-12-30 18:43:18.000743 (Thread-1): 18:43:17 | 1 of 30 START table model dbt_salesdataflo.Dim_Calendar.............. [RUN]
2020-12-30 18:43:18.001003 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:43:18.001122 (Thread-1): Compiling model.sales_dataflo.Dim_Calendar
2020-12-30 18:43:18.023813 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:43:18.023903 (Thread-1): On model.sales_dataflo.Dim_Calendar: BEGIN
2020-12-30 18:43:18.023963 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:18.345894 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-12-30 18:43:18.346039 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:43:18.346087 (Thread-1): On model.sales_dataflo.Dim_Calendar: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Calendar"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2015', 'dd/mm/yyyy'),
        dateadd(week, 53, current_date)
        )
2020-12-30 18:43:18.407809 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:43:18.415875 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Calendar"
2020-12-30 18:43:18.452257 (Thread-1): finished collecting timing info
2020-12-30 18:43:18.480539 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Calendar"
2020-12-30 18:43:18.522019 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:43:18.522142 (Thread-1): On model.sales_dataflo.Dim_Calendar: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Calendar"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Calendar  as
      (



with source as 
(

    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
     + 
    
    p10.generated_number * pow(2, 10)
     + 
    
    p11.generated_number * pow(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2561
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2015', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= dateadd(week, 53, current_date)

)

select * from filtered


) ,Dim_Calendar as(
select
      d.date_day AS Calendar_ID,
      d.date_day as cldr_date,
      cast(
    date_trunc('month', d.date_day)
 as date) as cldr_mnth_strt_dt,    
       cast(
  cast(
        
  

    dateadd(
        day,
        -1,
        
  

    dateadd(
        month,
        1,
        
    date_trunc('month', d.date_day)

        )



        )



        as date)
 as date) as cldr_mnth_end_dt,
        cast(
    date_trunc('quarter', d.date_day)
 as date) as cldr_qtr_strt_dt,
        cast(
  cast(
        
  

    dateadd(
        day,
        -1,
        
  

    dateadd(
        quarter,
        1,
        
    date_trunc('quarter', d.date_day)

        )



        )



        as date)
 as date) as cldr_qtr_end_dt,
        cast(
    date_trunc('year', d.date_day)
 as date) as cldr_year_start_dt,
        cast(
  cast(
        
  

    dateadd(
        day,
        -1,
        
  

    dateadd(
        year,
        1,
        
    date_trunc('year', d.date_day)

        )



        )



        as date)
 as date) as cldr_year_end_dt,
        cast(
    date_trunc('week', d.date_day)
 as date) as week_start_date,
        cast(
  cast(
        
  

    dateadd(
        day,
        -1,
        
  

    dateadd(
        week,
        1,
        
    date_trunc('week', d.date_day)

        )



        )



        as date)
 as date) as week_end_date,
        to_char(d.date_day, 'Dy') as day_short_name,
      to_char(d.date_day, 'MON') as month_short_name,
        cast(to_char(d.date_day, 'MMMM') as varchar(20))as month_name,
        cast(date_part('day', d.date_day) as 
    int
) as cldr_day_num,
        cast(date_part('week', d.date_day) as 
    int
) as cldr_week_num,
        'Q' || cast(date_part('quarter', d.date_day) as 
    int
) as cldr_qtr,
        cast(date_part('year', d.date_day) as 
    int
) as year,
        cast(
            case
                when date_part('dayofweek', d.date_day) = 0 then 7
                else date_part('dayofweek', d.date_day)
            end as 
    int

            ) as day_of_week,
        case
            when date_part('dayofweek', d.date_day) = 0 then 'Y'
            else 'N'
        end as weekend_flag,   
      
    current_timestamp::
    timestamp_ntz

 as DW_INS_UPD_DTS,
      'D_CALENDAR_DIM_LOAD' as DW_SESSION_NM
from
    source  d
order by 2)

select * from Dim_Calendar
      );
2020-12-30 18:43:18.978933 (Thread-1411): handling poll request
2020-12-30 18:43:18.979432 (Thread-1411): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf29f8e0>]}
2020-12-30 18:43:18.982242 (Thread-1411): sending response (<Response 13325 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:43:20.399285 (Thread-1412): handling poll request
2020-12-30 18:43:20.399706 (Thread-1412): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf2985e0>]}
2020-12-30 18:43:20.400608 (Thread-1412): sending response (<Response 284 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:43:21.824250 (Thread-1413): handling poll request
2020-12-30 18:43:21.824700 (Thread-1413): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf298040>]}
2020-12-30 18:43:21.935142 (Thread-1413): sending response (<Response 284 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:43:23.383088 (Thread-1414): handling poll request
2020-12-30 18:43:23.383533 (Thread-1414): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48e9610>]}
2020-12-30 18:43:23.384401 (Thread-1414): sending response (<Response 285 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:43:24.817522 (Thread-1415): handling poll request
2020-12-30 18:43:24.817987 (Thread-1415): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48e9610>]}
2020-12-30 18:43:24.819009 (Thread-1415): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:43:25.204728 (Thread-1): SQL status: SUCCESS 1 in 6.68 seconds
2020-12-30 18:43:25.205868 (Thread-1): On model.sales_dataflo.Dim_Calendar: COMMIT
2020-12-30 18:43:25.206006 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-30 18:43:25.206063 (Thread-1): On model.sales_dataflo.Dim_Calendar: COMMIT
2020-12-30 18:43:25.258930 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:43:25.271131 (Thread-1): finished collecting timing info
2020-12-30 18:43:25.271363 (Thread-1): On model.sales_dataflo.Dim_Calendar: Close
2020-12-30 18:43:25.350506 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfab2fd60>]}
2020-12-30 18:43:25.352006 (Thread-1): 18:43:25 | 1 of 30 OK created table model dbt_salesdataflo.Dim_Calendar......... [SUCCESS 1 in 7.35s]
2020-12-30 18:43:25.352101 (Thread-1): Finished running node model.sales_dataflo.Dim_Calendar
2020-12-30 18:43:25.352209 (Thread-1): Began running node model.sales_dataflo.Dim_Employee
2020-12-30 18:43:25.353000 (Thread-1): 18:43:25 | 2 of 30 START incremental model dbt_salesdataflo.Dim_Employee........ [RUN]
2020-12-30 18:43:25.353257 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:43:25.353337 (Thread-1): Compiling model.sales_dataflo.Dim_Employee
2020-12-30 18:43:25.362230 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Employee model triggered this warning. 
2020-12-30 18:43:25.364695 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Employee"
2020-12-30 18:43:25.385668 (Thread-1): finished collecting timing info
2020-12-30 18:43:25.412704 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Employee"
2020-12-30 18:43:25.432989 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:43:25.433120 (Thread-1): On model.sales_dataflo.Dim_Employee: BEGIN
2020-12-30 18:43:25.433186 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:25.736955 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-12-30 18:43:25.737119 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:43:25.737170 (Thread-1): On model.sales_dataflo.Dim_Employee: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Employee"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  as
      (



With user AS(
    select *  from DBT_TEST_LIVEDATA_RK.user
),usr_role AS(
    select *  from DBT_TEST_LIVEDATA_RK.user_role
),Dim_Employee AS(
 SELECT
   md5(cast(
    
    coalesce(cast(user.id as 
    varchar
), '')

 as 
    varchar
)) AS employee_id,
   ACCOUNT_ID AS emp_account_id,
   user.id AS source_Emp_id,
   cast('FIVETRAN_SF' as varchar(50)) AS Entity_id, 
   COMPANY_NAME AS org_name,
   EMPLOYEE_NUMBER AS employee_code,
   FIRST_NAME AS first_name,
   NULL AS middle_name,
   LAST_NAME AS last_name,
   user.NAME AS emp_full_nm,
   USER_ROLE_ID AS emp_role_id,
   usr_role. NAME AS emp_position_level,
   NULL  AS emp_gender,
   PHONE AS emp_phone_number,
   EMAIL AS emp_email,
   NULL AS sales_branch_id,
   NULL AS sales_branch_name,
   NULL AS sales_region_id,
   NULL AS sales_region_name,
   NULL AS sales_zone_id,
   NULL AS sales_zone_name,
   NULL AS business_unit_id,
   DEPARTMENT AS business_unit_name,
   CREATED_DATE AS emp_create_dt,
   user.LAST_MODIFIED_DATE AS emp_last_update_dt,
   MANAGER_ID AS mngr_emp_id,
   usr_role.NAME AS mngr_position_level,
   USER_ROLE_ID AS mngr_role_id,
   NULL AS emp_financial_year_start,
   NULL AS emp_start_of_week,
   NULL AS Weekly_working_days,
   IS_ACTIVE AS  emp_active,
     'SF'  as Source_type,
   'D_EMPLOYEE_DIM_LOAD' AS DW_SESSION_NM,
   
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
  FROM
      user left join usr_role  on user.USER_ROLE_ID = usr_role.ID
)

select * from Dim_Employee
      );
2020-12-30 18:43:26.279958 (Thread-1416): handling poll request
2020-12-30 18:43:26.280382 (Thread-1416): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf293100>]}
2020-12-30 18:43:26.283155 (Thread-1416): sending response (<Response 11203 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:43:26.569151 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2020-12-30 18:43:26.570137 (Thread-1): On model.sales_dataflo.Dim_Employee: COMMIT
2020-12-30 18:43:26.570249 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-30 18:43:26.570297 (Thread-1): On model.sales_dataflo.Dim_Employee: COMMIT
2020-12-30 18:43:26.624761 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:43:26.627783 (Thread-1): finished collecting timing info
2020-12-30 18:43:26.627989 (Thread-1): On model.sales_dataflo.Dim_Employee: Close
2020-12-30 18:43:26.695705 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfae9bf40>]}
2020-12-30 18:43:26.696788 (Thread-1): 18:43:26 | 2 of 30 OK created incremental model dbt_salesdataflo.Dim_Employee... [SUCCESS 1 in 1.34s]
2020-12-30 18:43:26.696882 (Thread-1): Finished running node model.sales_dataflo.Dim_Employee
2020-12-30 18:43:26.696985 (Thread-1): Began running node model.sales_dataflo.Dim_Account
2020-12-30 18:43:26.697822 (Thread-1): 18:43:26 | 3 of 30 START incremental model dbt_salesdataflo.Dim_Account......... [RUN]
2020-12-30 18:43:26.698042 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:43:26.698116 (Thread-1): Compiling model.sales_dataflo.Dim_Account
2020-12-30 18:43:26.706733 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Account model triggered this warning. 
2020-12-30 18:43:26.708707 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Account"
2020-12-30 18:43:26.728352 (Thread-1): finished collecting timing info
2020-12-30 18:43:26.734349 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:43:26.734431 (Thread-1): On model.sales_dataflo.Dim_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Account"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account__dbt_tmp  as
      (



WITH source AS
 (
 select * from DBT_TEST_LIVEDATA_RK.Account
  ),
DIM_ACCOUNT as (
      select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
          'SF'  as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM source
    )
select * from DIM_ACCOUNT
      );
2020-12-30 18:43:26.734492 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:27.815380 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2020-12-30 18:43:27.824822 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:43:27.824924 (Thread-1): On model.sales_dataflo.Dim_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Account"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account__dbt_tmp
2020-12-30 18:43:27.835920 (Thread-1417): handling poll request
2020-12-30 18:43:27.836357 (Thread-1417): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf29fca0>]}
2020-12-30 18:43:27.839006 (Thread-1417): sending response (<Response 10283 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:43:27.903387 (Thread-1): SQL status: SUCCESS 12 in 0.08 seconds
2020-12-30 18:43:27.907179 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:43:27.907258 (Thread-1): On model.sales_dataflo.Dim_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Account"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account
2020-12-30 18:43:27.967426 (Thread-1): SQL status: SUCCESS 12 in 0.06 seconds
2020-12-30 18:43:27.970810 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:43:27.970888 (Thread-1): On model.sales_dataflo.Dim_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Account"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account
2020-12-30 18:43:28.034188 (Thread-1): SQL status: SUCCESS 12 in 0.06 seconds
2020-12-30 18:43:28.053733 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Account"
2020-12-30 18:43:28.073563 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:43:28.073646 (Thread-1): On model.sales_dataflo.Dim_Account: BEGIN
2020-12-30 18:43:28.142869 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:43:28.142999 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:43:28.143047 (Thread-1): On model.sales_dataflo.Dim_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Account"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.Account_ID = DBT_INTERNAL_DEST.Account_ID
        

    
    when matched then update set
        "ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","ACCOUNT_NAME" = DBT_INTERNAL_SOURCE."ACCOUNT_NAME","ACCOUNT_TYPE" = DBT_INTERNAL_SOURCE."ACCOUNT_TYPE","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","INDUSTRY" = DBT_INTERNAL_SOURCE."INDUSTRY","ANNUAL_REVENUE" = DBT_INTERNAL_SOURCE."ANNUAL_REVENUE","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","INITIAL_CREATE_DT" = DBT_INTERNAL_SOURCE."INITIAL_CREATE_DT","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("ACCOUNT_ID", "ACCOUNT_NAME", "ACCOUNT_TYPE", "SOURCE_ID", "ACTIVE_FLAG", "INDUSTRY", "ANNUAL_REVENUE", "EMPLOYEE_ID", "INITIAL_CREATE_DT", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("ACCOUNT_ID", "ACCOUNT_NAME", "ACCOUNT_TYPE", "SOURCE_ID", "ACTIVE_FLAG", "INDUSTRY", "ANNUAL_REVENUE", "EMPLOYEE_ID", "INITIAL_CREATE_DT", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:43:29.318853 (Thread-1418): handling poll request
2020-12-30 18:43:29.319260 (Thread-1418): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb1cac0>]}
2020-12-30 18:43:29.321389 (Thread-1418): sending response (<Response 6707 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:43:29.333476 (Thread-1): SQL status: SUCCESS 16234 in 1.19 seconds
2020-12-30 18:43:29.334413 (Thread-1): On model.sales_dataflo.Dim_Account: COMMIT
2020-12-30 18:43:29.334538 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-30 18:43:29.334585 (Thread-1): On model.sales_dataflo.Dim_Account: COMMIT
2020-12-30 18:43:29.545510 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-12-30 18:43:29.548542 (Thread-1): finished collecting timing info
2020-12-30 18:43:29.548761 (Thread-1): On model.sales_dataflo.Dim_Account: Close
2020-12-30 18:43:29.629234 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfab73ee0>]}
2020-12-30 18:43:29.630312 (Thread-1): 18:43:29 | 3 of 30 OK created incremental model dbt_salesdataflo.Dim_Account.... [SUCCESS 16234 in 2.93s]
2020-12-30 18:43:29.630404 (Thread-1): Finished running node model.sales_dataflo.Dim_Account
2020-12-30 18:43:29.630508 (Thread-1): Began running node model.sales_dataflo.Dim_Lead
2020-12-30 18:43:29.631296 (Thread-1): 18:43:29 | 4 of 30 START incremental model dbt_salesdataflo.Dim_Lead............ [RUN]
2020-12-30 18:43:29.631507 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:43:29.631579 (Thread-1): Compiling model.sales_dataflo.Dim_Lead
2020-12-30 18:43:29.639647 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Lead model triggered this warning. 
2020-12-30 18:43:29.641843 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Lead"
2020-12-30 18:43:29.662369 (Thread-1): finished collecting timing info
2020-12-30 18:43:29.668451 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:43:29.668526 (Thread-1): On model.sales_dataflo.Dim_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Lead"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead__dbt_tmp  as
      (



    WITH lead AS (
       select *  from DBT_TEST_LIVEDATA_RK.Lead
    ),opportunity as(
        select *  from DBT_TEST_LIVEDATA_RK.Opportunity 
    ),Dim_Lead as(
    SELECT
        md5(cast(
    
    coalesce(cast(lead.id as 
    varchar
), '')

 as 
    varchar
)) AS lead_id,
        lead.LEAD_SOURCE AS LEAD_SOURCE,
        lead.ID AS source_id,
        concat(COALESCE(lead.street,' ',lead.city,' ',lead.state,' ',lead.postal_code,' ',lead.country)) AS lead_contact_address,
        lead.STATUS AS STATUS,
        opportunity.STAGE_NAME AS STAGE_NAME,
        NULL AS product_id,
        NULL AS campaign_id,
        lead.IS_CONVERTED AS lead_to_opp_flag,
        null AS lead_lost_flag,
        lead.CONVERTED_DATE AS lead_CONVERTED_DATE,
        lead.CONVERTED_OPPORTUNITY_ID AS CONVERTED_OPPORTUNITY_ID,
        NULL AS lead_lost_dt,
        NULL AS lead_lost_reason,
        lead.INDUSTRY AS Industry,
        LEAD.owner_id AS employee_id,
        lead.CREATED_DATE as INITIAL_CREATE_DT,
        lead.LAST_MODIFIED_DATE as lead_LAST_MODIFIED_DATE,
          'SF'  as Source_type,
        'D_LEAD_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
        FROM
          lead left join opportunity on lead.CONVERTED_OPPORTUNITY_ID = opportunity.id 
    )    
 
select * from Dim_Lead
      );
2020-12-30 18:43:29.668586 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:30.785478 (Thread-1419): handling poll request
2020-12-30 18:43:30.785889 (Thread-1419): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d47214c0>]}
2020-12-30 18:43:30.788312 (Thread-1419): sending response (<Response 9633 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:43:31.801546 (Thread-1): SQL status: SUCCESS 1 in 2.13 seconds
2020-12-30 18:43:31.804463 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:43:31.804555 (Thread-1): On model.sales_dataflo.Dim_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Lead"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead__dbt_tmp
2020-12-30 18:43:31.881676 (Thread-1): SQL status: SUCCESS 21 in 0.08 seconds
2020-12-30 18:43:31.885401 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:43:31.885483 (Thread-1): On model.sales_dataflo.Dim_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Lead"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead
2020-12-30 18:43:31.946885 (Thread-1): SQL status: SUCCESS 21 in 0.06 seconds
2020-12-30 18:43:31.950615 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:43:31.950689 (Thread-1): On model.sales_dataflo.Dim_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Lead"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead
2020-12-30 18:43:32.081214 (Thread-1): SQL status: SUCCESS 21 in 0.13 seconds
2020-12-30 18:43:32.084209 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Lead"
2020-12-30 18:43:32.104196 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:43:32.104297 (Thread-1): On model.sales_dataflo.Dim_Lead: BEGIN
2020-12-30 18:43:32.182059 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2020-12-30 18:43:32.182192 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:43:32.182242 (Thread-1): On model.sales_dataflo.Dim_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Lead"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.lead_id = DBT_INTERNAL_DEST.lead_id
        

    
    when matched then update set
        "LEAD_ID" = DBT_INTERNAL_SOURCE."LEAD_ID","LEAD_SOURCE" = DBT_INTERNAL_SOURCE."LEAD_SOURCE","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","LEAD_CONTACT_ADDRESS" = DBT_INTERNAL_SOURCE."LEAD_CONTACT_ADDRESS","STATUS" = DBT_INTERNAL_SOURCE."STATUS","STAGE_NAME" = DBT_INTERNAL_SOURCE."STAGE_NAME","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","LEAD_TO_OPP_FLAG" = DBT_INTERNAL_SOURCE."LEAD_TO_OPP_FLAG","LEAD_LOST_FLAG" = DBT_INTERNAL_SOURCE."LEAD_LOST_FLAG","LEAD_CONVERTED_DATE" = DBT_INTERNAL_SOURCE."LEAD_CONVERTED_DATE","CONVERTED_OPPORTUNITY_ID" = DBT_INTERNAL_SOURCE."CONVERTED_OPPORTUNITY_ID","LEAD_LOST_DT" = DBT_INTERNAL_SOURCE."LEAD_LOST_DT","LEAD_LOST_REASON" = DBT_INTERNAL_SOURCE."LEAD_LOST_REASON","INDUSTRY" = DBT_INTERNAL_SOURCE."INDUSTRY","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","INITIAL_CREATE_DT" = DBT_INTERNAL_SOURCE."INITIAL_CREATE_DT","LEAD_LAST_MODIFIED_DATE" = DBT_INTERNAL_SOURCE."LEAD_LAST_MODIFIED_DATE","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("LEAD_ID", "LEAD_SOURCE", "SOURCE_ID", "LEAD_CONTACT_ADDRESS", "STATUS", "STAGE_NAME", "PRODUCT_ID", "CAMPAIGN_ID", "LEAD_TO_OPP_FLAG", "LEAD_LOST_FLAG", "LEAD_CONVERTED_DATE", "CONVERTED_OPPORTUNITY_ID", "LEAD_LOST_DT", "LEAD_LOST_REASON", "INDUSTRY", "EMPLOYEE_ID", "INITIAL_CREATE_DT", "LEAD_LAST_MODIFIED_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("LEAD_ID", "LEAD_SOURCE", "SOURCE_ID", "LEAD_CONTACT_ADDRESS", "STATUS", "STAGE_NAME", "PRODUCT_ID", "CAMPAIGN_ID", "LEAD_TO_OPP_FLAG", "LEAD_LOST_FLAG", "LEAD_CONVERTED_DATE", "CONVERTED_OPPORTUNITY_ID", "LEAD_LOST_DT", "LEAD_LOST_REASON", "INDUSTRY", "EMPLOYEE_ID", "INITIAL_CREATE_DT", "LEAD_LAST_MODIFIED_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:43:32.238942 (Thread-1420): handling poll request
2020-12-30 18:43:32.239379 (Thread-1420): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4721760>]}
2020-12-30 18:43:32.241566 (Thread-1420): sending response (<Response 8767 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:43:33.660913 (Thread-1421): handling poll request
2020-12-30 18:43:33.661384 (Thread-1421): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb1c040>]}
2020-12-30 18:43:33.662528 (Thread-1421): sending response (<Response 283 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:43:34.133693 (Thread-1): SQL status: SUCCESS 114992 in 1.95 seconds
2020-12-30 18:43:34.134638 (Thread-1): On model.sales_dataflo.Dim_Lead: COMMIT
2020-12-30 18:43:34.134773 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-30 18:43:34.134821 (Thread-1): On model.sales_dataflo.Dim_Lead: COMMIT
2020-12-30 18:43:34.334742 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-12-30 18:43:34.337922 (Thread-1): finished collecting timing info
2020-12-30 18:43:34.338163 (Thread-1): On model.sales_dataflo.Dim_Lead: Close
2020-12-30 18:43:34.408556 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfabfb4f0>]}
2020-12-30 18:43:34.409589 (Thread-1): 18:43:34 | 4 of 30 OK created incremental model dbt_salesdataflo.Dim_Lead....... [SUCCESS 114992 in 4.78s]
2020-12-30 18:43:34.409680 (Thread-1): Finished running node model.sales_dataflo.Dim_Lead
2020-12-30 18:43:34.409787 (Thread-1): Began running node model.sales_dataflo.Dim_Opportunity
2020-12-30 18:43:34.410594 (Thread-1): 18:43:34 | 5 of 30 START incremental model dbt_salesdataflo.Dim_Opportunity..... [RUN]
2020-12-30 18:43:34.410900 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:43:34.411015 (Thread-1): Compiling model.sales_dataflo.Dim_Opportunity
2020-12-30 18:43:34.420017 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity model triggered this warning. 
2020-12-30 18:43:34.421973 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Opportunity"
2020-12-30 18:43:34.464393 (Thread-1): finished collecting timing info
2020-12-30 18:43:34.473279 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:43:34.473359 (Thread-1): On model.sales_dataflo.Dim_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity__dbt_tmp  as
      (



    WITH OPPORTUNITY AS (
       select *  from DBT_TEST_LIVEDATA_RK.opportunity 
    ),contact AS(
        select *  from DBT_TEST_LIVEDATA_RK.contact    
    ),
    emp AS(
        select *  from DBT_TEST_LIVEDATA_RK.user    
    ),
    --OPPORTUNITY_LINE_ITEM AS(
    --      select OPPORTUNITY_ID,PRODUCT_2_ID ,PRODUCT_CODE,TOTAL_PRICE from DBT_TEST_LIVEDATA_RK.OPPORTUNITY_LINE_ITEM
     --),
    OPPORTUNITY_STAGE AS(
        select *  from DBT_TEST_LIVEDATA_RK.opportunity_stage  
    )
    ,Dim_Opportunity as(
    SELECT
        md5(cast(
    
    coalesce(cast(OPPORTUNITY.id as 
    varchar
), '')

 as 
    varchar
)) AS opportunity_id,
        OPPORTUNITY.NAME AS opportunity_NAME,
        OPPORTUNITY.TYPE AS opportunity_Type, 
        OPPORTUNITY.ACCOUNT_ID AS ACCOUNT_ID,        
        OPPORTUNITY.OWNER_ID AS employee_id,
        OPPORTUNITY.ID AS Source_id,
        OPPORTUNITY_STAGE.SORT_ORDER AS stage_id,
        OPPORTUNITY.IS_WON as IS_WON,
        OPPORTUNITY.IS_CLOSED as IS_CLOSED,
        OPPORTUNITY.stage_name AS stage_name,
        --   OPPORTUNITY.PROBABILITY as PROBABILITY,        
        OPPORTUNITY.FORECAST_CATEGORY as FORECAST_CATEGORY,
        OPPORTUNITY.AMOUNT AS AMOUNT,
        --OPPORTUNITY.EXPECTED_REVENUE as EXPECTED_REVENUE,
        NULL AS amount_without_disc,
        NULL AS expectd_Clouser_Dt,
        OPPORTUNITY.CONTACT_ID AS Contact_id,
        contact.NAME AS contact_name,
        contact.PHONE AS contact_number,
        contact.EMAIL AS contact_email,
        contact.MAILING_STREET AS contact_address,
        OPPORTUNITY.CREATED_DATE AS initial_create_dt,
        OPPORTUNITY.LAST_MODIFIED_DATE AS last_updated_dt,
        OPPORTUNITY.CLOSE_DATE AS CLOSE_DATE,
        NULL AS prospect_Dt,
        NULL AS stage_calc_id,
        OPPORTUNITY_STAGE.CREATED_DATE AS stage_start_dt,
        NULL AS stage_end_dt,        
        NULL AS lead_lost_reason,
        --OPPORTUNITY.CAMPAIGN_ID AS campaign_id,
        NULL AS competitor,
        NULL AS on_hold_flag,
        --OPPORTUNITY_LINE_ITEM. PRODUCT_2_ID AS product_id,
        --OPPORTUNITY_LINE_ITEM. PRODUCT_CODE AS product_name,
        NULL AS sub_product_id,
        NULL AS sub_product_name,
        --OPPORTUNITY_LINE_ITEM. TOTAL_PRICE AS product_amount,
        NULL AS prd_amount_without_disc,
        NULL AS prd_discount,
        OPPORTUNITY. IS_DELETED AS active_flag,
        NULL AS DW_CURR_FLG,
        NULL AS EFFCT_START_DATE,
        NULL AS EFFCT_END_DATE,
          'SF'  as Source_type,
        'D_OPPORTUNITY_DIM_LOAD'  AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
      FROM
        OPPORTUNITY 
        left join emp on OPPORTUNITY.Owner_id  =  emp.id
        left join contact on emp.contact_id  =  contact.id
        --left join OPPORTUNITY_LINE_ITEM on OPPORTUNITY.ID = OPPORTUNITY_LINE_ITEM.OPPORTUNITY_ID
        left join OPPORTUNITY_STAGE on OPPORTUNITY.stage_name = OPPORTUNITY_STAGE.MASTER_LABEL
     
    )    
    

select * from Dim_Opportunity
      );
2020-12-30 18:43:34.473418 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:35.120380 (Thread-1422): handling poll request
2020-12-30 18:43:35.120798 (Thread-1422): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d538f970>]}
2020-12-30 18:43:35.123538 (Thread-1422): sending response (<Response 11481 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:43:36.586134 (Thread-1423): handling poll request
2020-12-30 18:43:36.586564 (Thread-1423): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf28ce20>]}
2020-12-30 18:43:36.587431 (Thread-1423): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:43:36.782024 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2020-12-30 18:43:36.785875 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:43:36.785974 (Thread-1): On model.sales_dataflo.Dim_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity__dbt_tmp
2020-12-30 18:43:36.865973 (Thread-1): SQL status: SUCCESS 40 in 0.08 seconds
2020-12-30 18:43:36.870591 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:43:36.870670 (Thread-1): On model.sales_dataflo.Dim_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity
2020-12-30 18:43:36.940934 (Thread-1): SQL status: SUCCESS 40 in 0.07 seconds
2020-12-30 18:43:36.945587 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:43:36.945659 (Thread-1): On model.sales_dataflo.Dim_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity
2020-12-30 18:43:37.006524 (Thread-1): SQL status: SUCCESS 40 in 0.06 seconds
2020-12-30 18:43:37.011087 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Opportunity"
2020-12-30 18:43:37.032416 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:43:37.032496 (Thread-1): On model.sales_dataflo.Dim_Opportunity: BEGIN
2020-12-30 18:43:37.103156 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:43:37.103284 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:43:37.103337 (Thread-1): On model.sales_dataflo.Dim_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.opportunity_id = DBT_INTERNAL_DEST.opportunity_id
        

    
    when matched then update set
        "OPPORTUNITY_ID" = DBT_INTERNAL_SOURCE."OPPORTUNITY_ID","OPPORTUNITY_NAME" = DBT_INTERNAL_SOURCE."OPPORTUNITY_NAME","OPPORTUNITY_TYPE" = DBT_INTERNAL_SOURCE."OPPORTUNITY_TYPE","ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","STAGE_ID" = DBT_INTERNAL_SOURCE."STAGE_ID","IS_WON" = DBT_INTERNAL_SOURCE."IS_WON","IS_CLOSED" = DBT_INTERNAL_SOURCE."IS_CLOSED","STAGE_NAME" = DBT_INTERNAL_SOURCE."STAGE_NAME","FORECAST_CATEGORY" = DBT_INTERNAL_SOURCE."FORECAST_CATEGORY","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AMOUNT_WITHOUT_DISC" = DBT_INTERNAL_SOURCE."AMOUNT_WITHOUT_DISC","EXPECTD_CLOUSER_DT" = DBT_INTERNAL_SOURCE."EXPECTD_CLOUSER_DT","CONTACT_ID" = DBT_INTERNAL_SOURCE."CONTACT_ID","CONTACT_NAME" = DBT_INTERNAL_SOURCE."CONTACT_NAME","CONTACT_NUMBER" = DBT_INTERNAL_SOURCE."CONTACT_NUMBER","CONTACT_EMAIL" = DBT_INTERNAL_SOURCE."CONTACT_EMAIL","CONTACT_ADDRESS" = DBT_INTERNAL_SOURCE."CONTACT_ADDRESS","INITIAL_CREATE_DT" = DBT_INTERNAL_SOURCE."INITIAL_CREATE_DT","LAST_UPDATED_DT" = DBT_INTERNAL_SOURCE."LAST_UPDATED_DT","CLOSE_DATE" = DBT_INTERNAL_SOURCE."CLOSE_DATE","PROSPECT_DT" = DBT_INTERNAL_SOURCE."PROSPECT_DT","STAGE_CALC_ID" = DBT_INTERNAL_SOURCE."STAGE_CALC_ID","STAGE_START_DT" = DBT_INTERNAL_SOURCE."STAGE_START_DT","STAGE_END_DT" = DBT_INTERNAL_SOURCE."STAGE_END_DT","LEAD_LOST_REASON" = DBT_INTERNAL_SOURCE."LEAD_LOST_REASON","COMPETITOR" = DBT_INTERNAL_SOURCE."COMPETITOR","ON_HOLD_FLAG" = DBT_INTERNAL_SOURCE."ON_HOLD_FLAG","SUB_PRODUCT_ID" = DBT_INTERNAL_SOURCE."SUB_PRODUCT_ID","SUB_PRODUCT_NAME" = DBT_INTERNAL_SOURCE."SUB_PRODUCT_NAME","PRD_AMOUNT_WITHOUT_DISC" = DBT_INTERNAL_SOURCE."PRD_AMOUNT_WITHOUT_DISC","PRD_DISCOUNT" = DBT_INTERNAL_SOURCE."PRD_DISCOUNT","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","DW_CURR_FLG" = DBT_INTERNAL_SOURCE."DW_CURR_FLG","EFFCT_START_DATE" = DBT_INTERNAL_SOURCE."EFFCT_START_DATE","EFFCT_END_DATE" = DBT_INTERNAL_SOURCE."EFFCT_END_DATE","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("OPPORTUNITY_ID", "OPPORTUNITY_NAME", "OPPORTUNITY_TYPE", "ACCOUNT_ID", "EMPLOYEE_ID", "SOURCE_ID", "STAGE_ID", "IS_WON", "IS_CLOSED", "STAGE_NAME", "FORECAST_CATEGORY", "AMOUNT", "AMOUNT_WITHOUT_DISC", "EXPECTD_CLOUSER_DT", "CONTACT_ID", "CONTACT_NAME", "CONTACT_NUMBER", "CONTACT_EMAIL", "CONTACT_ADDRESS", "INITIAL_CREATE_DT", "LAST_UPDATED_DT", "CLOSE_DATE", "PROSPECT_DT", "STAGE_CALC_ID", "STAGE_START_DT", "STAGE_END_DT", "LEAD_LOST_REASON", "COMPETITOR", "ON_HOLD_FLAG", "SUB_PRODUCT_ID", "SUB_PRODUCT_NAME", "PRD_AMOUNT_WITHOUT_DISC", "PRD_DISCOUNT", "ACTIVE_FLAG", "DW_CURR_FLG", "EFFCT_START_DATE", "EFFCT_END_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("OPPORTUNITY_ID", "OPPORTUNITY_NAME", "OPPORTUNITY_TYPE", "ACCOUNT_ID", "EMPLOYEE_ID", "SOURCE_ID", "STAGE_ID", "IS_WON", "IS_CLOSED", "STAGE_NAME", "FORECAST_CATEGORY", "AMOUNT", "AMOUNT_WITHOUT_DISC", "EXPECTD_CLOUSER_DT", "CONTACT_ID", "CONTACT_NAME", "CONTACT_NUMBER", "CONTACT_EMAIL", "CONTACT_ADDRESS", "INITIAL_CREATE_DT", "LAST_UPDATED_DT", "CLOSE_DATE", "PROSPECT_DT", "STAGE_CALC_ID", "STAGE_START_DT", "STAGE_END_DT", "LEAD_LOST_REASON", "COMPETITOR", "ON_HOLD_FLAG", "SUB_PRODUCT_ID", "SUB_PRODUCT_NAME", "PRD_AMOUNT_WITHOUT_DISC", "PRD_DISCOUNT", "ACTIVE_FLAG", "DW_CURR_FLG", "EFFCT_START_DATE", "EFFCT_END_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:43:37.996936 (Thread-1): SQL status: SUCCESS 11459 in 0.89 seconds
2020-12-30 18:43:37.997917 (Thread-1): On model.sales_dataflo.Dim_Opportunity: COMMIT
2020-12-30 18:43:37.998042 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-30 18:43:37.998089 (Thread-1): On model.sales_dataflo.Dim_Opportunity: COMMIT
2020-12-30 18:43:38.022965 (Thread-1424): handling poll request
2020-12-30 18:43:38.023363 (Thread-1424): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4742250>]}
2020-12-30 18:43:38.025848 (Thread-1424): sending response (<Response 12148 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:43:38.219558 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-12-30 18:43:38.222655 (Thread-1): finished collecting timing info
2020-12-30 18:43:38.222874 (Thread-1): On model.sales_dataflo.Dim_Opportunity: Close
2020-12-30 18:43:38.298064 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfae5b2e0>]}
2020-12-30 18:43:38.299064 (Thread-1): 18:43:38 | 5 of 30 OK created incremental model dbt_salesdataflo.Dim_Opportunity [SUCCESS 11459 in 3.89s]
2020-12-30 18:43:38.299155 (Thread-1): Finished running node model.sales_dataflo.Dim_Opportunity
2020-12-30 18:43:38.299256 (Thread-1): Began running node model.sales_dataflo.Dim_Contact
2020-12-30 18:43:38.300034 (Thread-1): 18:43:38 | 6 of 30 START incremental model dbt_salesdataflo.Dim_Contact......... [RUN]
2020-12-30 18:43:38.300238 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:43:38.300310 (Thread-1): Compiling model.sales_dataflo.Dim_Contact
2020-12-30 18:43:38.308027 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Contact model triggered this warning. 
2020-12-30 18:43:38.310095 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Contact"
2020-12-30 18:43:38.330508 (Thread-1): finished collecting timing info
2020-12-30 18:43:38.336510 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:43:38.336585 (Thread-1): On model.sales_dataflo.Dim_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Contact"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact__dbt_tmp  as
      (



WITH contacts AS (
       select *  from DBT_TEST_LIVEDATA_RK.Contact 
    ),
Dim_Contact as(
      SELECT 
        md5(cast(
    
    coalesce(cast(contacts.id as 
    varchar
), '')

 as 
    varchar
)) AS contact_id, 
        contacts.salutation AS salutation, 
        contacts.NAME AS contact_name, 
        contacts.last_name AS last_name, 
        contacts.first_name AS first_name, 
        contacts.phone AS contact_number, 
        contacts.mobile_phone AS mobile_phone, 
        contacts.home_phone AS home_phone, 
        contacts.email AS contact_email, 
        contacts.id AS source_id, 
        contacts.department AS department, 
        contacts.lead_source AS lead_source, 
        null AS organization_id, 
        contacts.owner_ID AS employee_id, 
        contacts.account_id AS account_id, 
        NULL AS contact_age_group, 
        NULL AS contact_income, 
        NULL AS dependent, 
        NULL AS contact_type, 
        contacts.IS_DELETED AS active,
        CREATED_DATE as INITIAL_CREATE_DT,
          'SF'  as Source_type,
        'D_CONTACT_DIM_LOAD' AS dw_session_nm, 
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
     FROM 
       contacts
    )    
    
select * from Dim_Contact
      );
2020-12-30 18:43:38.336644 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:39.440810 (Thread-1425): handling poll request
2020-12-30 18:43:39.441261 (Thread-1425): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb10760>]}
2020-12-30 18:43:39.443403 (Thread-1425): sending response (<Response 8326 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:43:40.153573 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2020-12-30 18:43:40.156519 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:43:40.156621 (Thread-1): On model.sales_dataflo.Dim_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Contact"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact__dbt_tmp
2020-12-30 18:43:40.247397 (Thread-1): SQL status: SUCCESS 24 in 0.09 seconds
2020-12-30 18:43:40.251337 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:43:40.251431 (Thread-1): On model.sales_dataflo.Dim_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Contact"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact
2020-12-30 18:43:40.321528 (Thread-1): SQL status: SUCCESS 24 in 0.07 seconds
2020-12-30 18:43:40.326546 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:43:40.326630 (Thread-1): On model.sales_dataflo.Dim_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Contact"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact
2020-12-30 18:43:40.410352 (Thread-1): SQL status: SUCCESS 24 in 0.08 seconds
2020-12-30 18:43:40.416116 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Contact"
2020-12-30 18:43:40.438012 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:43:40.438108 (Thread-1): On model.sales_dataflo.Dim_Contact: BEGIN
2020-12-30 18:43:40.520336 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2020-12-30 18:43:40.520523 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:43:40.520606 (Thread-1): On model.sales_dataflo.Dim_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Contact"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.contact_id = DBT_INTERNAL_DEST.contact_id
        

    
    when matched then update set
        "CONTACT_ID" = DBT_INTERNAL_SOURCE."CONTACT_ID","SALUTATION" = DBT_INTERNAL_SOURCE."SALUTATION","CONTACT_NAME" = DBT_INTERNAL_SOURCE."CONTACT_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","CONTACT_NUMBER" = DBT_INTERNAL_SOURCE."CONTACT_NUMBER","MOBILE_PHONE" = DBT_INTERNAL_SOURCE."MOBILE_PHONE","HOME_PHONE" = DBT_INTERNAL_SOURCE."HOME_PHONE","CONTACT_EMAIL" = DBT_INTERNAL_SOURCE."CONTACT_EMAIL","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","DEPARTMENT" = DBT_INTERNAL_SOURCE."DEPARTMENT","LEAD_SOURCE" = DBT_INTERNAL_SOURCE."LEAD_SOURCE","ORGANIZATION_ID" = DBT_INTERNAL_SOURCE."ORGANIZATION_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","CONTACT_AGE_GROUP" = DBT_INTERNAL_SOURCE."CONTACT_AGE_GROUP","CONTACT_INCOME" = DBT_INTERNAL_SOURCE."CONTACT_INCOME","DEPENDENT" = DBT_INTERNAL_SOURCE."DEPENDENT","CONTACT_TYPE" = DBT_INTERNAL_SOURCE."CONTACT_TYPE","ACTIVE" = DBT_INTERNAL_SOURCE."ACTIVE","INITIAL_CREATE_DT" = DBT_INTERNAL_SOURCE."INITIAL_CREATE_DT","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("CONTACT_ID", "SALUTATION", "CONTACT_NAME", "LAST_NAME", "FIRST_NAME", "CONTACT_NUMBER", "MOBILE_PHONE", "HOME_PHONE", "CONTACT_EMAIL", "SOURCE_ID", "DEPARTMENT", "LEAD_SOURCE", "ORGANIZATION_ID", "EMPLOYEE_ID", "ACCOUNT_ID", "CONTACT_AGE_GROUP", "CONTACT_INCOME", "DEPENDENT", "CONTACT_TYPE", "ACTIVE", "INITIAL_CREATE_DT", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("CONTACT_ID", "SALUTATION", "CONTACT_NAME", "LAST_NAME", "FIRST_NAME", "CONTACT_NUMBER", "MOBILE_PHONE", "HOME_PHONE", "CONTACT_EMAIL", "SOURCE_ID", "DEPARTMENT", "LEAD_SOURCE", "ORGANIZATION_ID", "EMPLOYEE_ID", "ACCOUNT_ID", "CONTACT_AGE_GROUP", "CONTACT_INCOME", "DEPENDENT", "CONTACT_TYPE", "ACTIVE", "INITIAL_CREATE_DT", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:43:40.879128 (Thread-1426): handling poll request
2020-12-30 18:43:40.879550 (Thread-1426): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d47251c0>]}
2020-12-30 18:43:40.881677 (Thread-1426): sending response (<Response 9001 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:43:42.344093 (Thread-1427): handling poll request
2020-12-30 18:43:42.344532 (Thread-1427): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4725790>]}
2020-12-30 18:43:42.345448 (Thread-1427): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:43:43.796818 (Thread-1428): handling poll request
2020-12-30 18:43:43.797279 (Thread-1428): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d497f400>]}
2020-12-30 18:43:43.798370 (Thread-1428): sending response (<Response 285 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:43:44.198917 (Thread-1): SQL status: SUCCESS 237706 in 3.68 seconds
2020-12-30 18:43:44.200206 (Thread-1): On model.sales_dataflo.Dim_Contact: COMMIT
2020-12-30 18:43:44.200341 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-30 18:43:44.200390 (Thread-1): On model.sales_dataflo.Dim_Contact: COMMIT
2020-12-30 18:43:44.410959 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-12-30 18:43:44.414327 (Thread-1): finished collecting timing info
2020-12-30 18:43:44.414541 (Thread-1): On model.sales_dataflo.Dim_Contact: Close
2020-12-30 18:43:44.502356 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfac691f0>]}
2020-12-30 18:43:44.504096 (Thread-1): 18:43:44 | 6 of 30 OK created incremental model dbt_salesdataflo.Dim_Contact.... [SUCCESS 237706 in 6.20s]
2020-12-30 18:43:44.504236 (Thread-1): Finished running node model.sales_dataflo.Dim_Contact
2020-12-30 18:43:44.504385 (Thread-1): Began running node model.sales_dataflo.Dim_Address
2020-12-30 18:43:44.505605 (Thread-1): 18:43:44 | 7 of 30 START table model dbt_salesdataflo.Dim_Address............... [RUN]
2020-12-30 18:43:44.505927 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-30 18:43:44.506033 (Thread-1): Compiling model.sales_dataflo.Dim_Address
2020-12-30 18:43:44.519321 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-30 18:43:44.521117 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-30 18:43:44.524293 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Address"
2020-12-30 18:43:44.543512 (Thread-1): finished collecting timing info
2020-12-30 18:43:44.550780 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Address"
2020-12-30 18:43:44.572964 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-30 18:43:44.573097 (Thread-1): On model.sales_dataflo.Dim_Address: BEGIN
2020-12-30 18:43:44.573185 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:45.080927 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-12-30 18:43:45.081099 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-30 18:43:45.081155 (Thread-1): On model.sales_dataflo.Dim_Address: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Address"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Address  as
      (



WITH source AS (
       select *  from DBT_TEST_LIVEDATA_RK.Contact 
    ),Dim_Address AS(
        SELECT 
            md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
)) AS  address_id,
            account_id AS account_id,
            id as source_id,
            MAILING_STREET AS STREET,
            MAILING_CITY AS CITY,
            MAILING_STATE AS STATE,
            MAILING_POSTAL_CODE AS POSTAL_CODE,
            MAILING_COUNTRY AS COUNTRY,
            'Billing' as address_type,
              'SF'  as Source_type,
             'D_ADDRESS_DIM_LOAD' AS DW_SESSION_NM,
            
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
            from source
        union 
        SELECT
            md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
)) AS  address_id,
            account_id AS account_id,
            id as source_id,
            OTHER_STREET AS STREET,
            OTHER_CITY AS CITY,
            OTHER_STATE AS STATE,
            OTHER_POSTAL_CODE AS POSTAL_CODE,
            OTHER_COUNTRY As COUNTRY, 
            'Shipping' as address_type,
              'SF'  as Source_type,
             'D_ADDRESS_DIM_LOAD' AS DW_SESSION_NM,
            
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
             from source
    )
    
select * from Dim_Address
      );
2020-12-30 18:43:45.246768 (Thread-1429): handling poll request
2020-12-30 18:43:45.247248 (Thread-1429): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4725f40>]}
2020-12-30 18:43:45.250080 (Thread-1429): sending response (<Response 11581 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:43:46.690145 (Thread-1430): handling poll request
2020-12-30 18:43:46.690647 (Thread-1430): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf29fb80>]}
2020-12-30 18:43:46.691518 (Thread-1430): sending response (<Response 285 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:43:47.567499 (Thread-1): SQL status: SUCCESS 1 in 2.49 seconds
2020-12-30 18:43:47.568465 (Thread-1): On model.sales_dataflo.Dim_Address: COMMIT
2020-12-30 18:43:47.568580 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-30 18:43:47.568626 (Thread-1): On model.sales_dataflo.Dim_Address: COMMIT
2020-12-30 18:43:47.621339 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:43:47.623239 (Thread-1): finished collecting timing info
2020-12-30 18:43:47.623444 (Thread-1): On model.sales_dataflo.Dim_Address: Close
2020-12-30 18:43:47.693265 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfabccd60>]}
2020-12-30 18:43:47.694338 (Thread-1): 18:43:47 | 7 of 30 OK created table model dbt_salesdataflo.Dim_Address.......... [SUCCESS 1 in 3.19s]
2020-12-30 18:43:47.694426 (Thread-1): Finished running node model.sales_dataflo.Dim_Address
2020-12-30 18:43:47.694533 (Thread-1): Began running node model.sales_dataflo.Dim_Campaign
2020-12-30 18:43:47.695667 (Thread-1): 18:43:47 | 8 of 30 START incremental model dbt_salesdataflo.Dim_Campaign........ [RUN]
2020-12-30 18:43:47.695875 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:43:47.695945 (Thread-1): Compiling model.sales_dataflo.Dim_Campaign
2020-12-30 18:43:47.704236 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Campaign model triggered this warning. 
2020-12-30 18:43:47.706171 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Campaign"
2020-12-30 18:43:47.727551 (Thread-1): finished collecting timing info
2020-12-30 18:43:47.734142 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:43:47.734220 (Thread-1): On model.sales_dataflo.Dim_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Campaign"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign__dbt_tmp  as
      (



WITH source AS (
    select * from DBT_TEST_LIVEDATA_RK.Campaign 
    ),
Dim_Campaign as (

      SELECT
        NULL AS Account_ID,
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
)) AS Campaign_ID,
        NAME AS Campaign_Name,
        IS_ACTIVE AS active_flag,
        ID AS Source_ID,
        TYPE AS TYPE,
        STATUS AS STATUS,
        START_DATE AS START_DATE,
        END_DATE AS END_DATE,
        EXPECTED_REVENUE AS EXPECTED_REVENUE,
        BUDGETED_COST AS BUDGETED_COST,
        ACTUAL_COST AS ACTUAL_COST,
        EXPECTED_RESPONSE AS EXPECTED_RESPONSE,
        NUMBER_SENT AS NUMBER_SENT,
        NUMBER_OF_LEADS AS NUMBER_OF_LEADS,
        NUMBER_OF_CONVERTED_LEADS AS NUMBER_OF_CONVERTED_LEADS,
        NUMBER_OF_CONTACTS AS NUMBER_OF_CONTACTS,
        NUMBER_OF_RESPONSES AS NUMBER_OF_RESPONSES,
        NUMBER_OF_OPPORTUNITIES AS NUMBER_OF_OPPORTUNITIES,
        NUMBER_OF_WON_OPPORTUNITIES AS NUMBER_OF_WON_OPPORTUNITIES,
        AMOUNT_ALL_OPPORTUNITIES AS AMOUNT_ALL_OPPORTUNITIES,
        AMOUNT_WON_OPPORTUNITIES AS AMOUNT_WON_OPPORTUNITIES,
           'SF'  as Source_type,
        'D_CAMPAIGN_DIM_LOAD'  AS 	DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
     FROM
        source     
      )

  select * from  Dim_Campaign
      );
2020-12-30 18:43:47.734279 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:48.121685 (Thread-1431): handling poll request
2020-12-30 18:43:48.122108 (Thread-1431): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d497fc70>]}
2020-12-30 18:43:48.126132 (Thread-1431): sending response (<Response 9706 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:43:49.003758 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2020-12-30 18:43:49.007025 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:43:49.007134 (Thread-1): On model.sales_dataflo.Dim_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Campaign"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign__dbt_tmp
2020-12-30 18:43:49.092361 (Thread-1): SQL status: SUCCESS 25 in 0.09 seconds
2020-12-30 18:43:49.096653 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:43:49.096744 (Thread-1): On model.sales_dataflo.Dim_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Campaign"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign
2020-12-30 18:43:49.163243 (Thread-1): SQL status: SUCCESS 25 in 0.07 seconds
2020-12-30 18:43:49.167152 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:43:49.167227 (Thread-1): On model.sales_dataflo.Dim_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Campaign"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign
2020-12-30 18:43:49.228327 (Thread-1): SQL status: SUCCESS 25 in 0.06 seconds
2020-12-30 18:43:49.232503 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Campaign"
2020-12-30 18:43:49.261575 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:43:49.261658 (Thread-1): On model.sales_dataflo.Dim_Campaign: BEGIN
2020-12-30 18:43:49.340328 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2020-12-30 18:43:49.340436 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:43:49.340483 (Thread-1): On model.sales_dataflo.Dim_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Campaign"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.Campaign_ID = DBT_INTERNAL_DEST.Campaign_ID
        

    
    when matched then update set
        "ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","CAMPAIGN_NAME" = DBT_INTERNAL_SOURCE."CAMPAIGN_NAME","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","TYPE" = DBT_INTERNAL_SOURCE."TYPE","STATUS" = DBT_INTERNAL_SOURCE."STATUS","START_DATE" = DBT_INTERNAL_SOURCE."START_DATE","END_DATE" = DBT_INTERNAL_SOURCE."END_DATE","EXPECTED_REVENUE" = DBT_INTERNAL_SOURCE."EXPECTED_REVENUE","BUDGETED_COST" = DBT_INTERNAL_SOURCE."BUDGETED_COST","ACTUAL_COST" = DBT_INTERNAL_SOURCE."ACTUAL_COST","EXPECTED_RESPONSE" = DBT_INTERNAL_SOURCE."EXPECTED_RESPONSE","NUMBER_SENT" = DBT_INTERNAL_SOURCE."NUMBER_SENT","NUMBER_OF_LEADS" = DBT_INTERNAL_SOURCE."NUMBER_OF_LEADS","NUMBER_OF_CONVERTED_LEADS" = DBT_INTERNAL_SOURCE."NUMBER_OF_CONVERTED_LEADS","NUMBER_OF_CONTACTS" = DBT_INTERNAL_SOURCE."NUMBER_OF_CONTACTS","NUMBER_OF_RESPONSES" = DBT_INTERNAL_SOURCE."NUMBER_OF_RESPONSES","NUMBER_OF_OPPORTUNITIES" = DBT_INTERNAL_SOURCE."NUMBER_OF_OPPORTUNITIES","NUMBER_OF_WON_OPPORTUNITIES" = DBT_INTERNAL_SOURCE."NUMBER_OF_WON_OPPORTUNITIES","AMOUNT_ALL_OPPORTUNITIES" = DBT_INTERNAL_SOURCE."AMOUNT_ALL_OPPORTUNITIES","AMOUNT_WON_OPPORTUNITIES" = DBT_INTERNAL_SOURCE."AMOUNT_WON_OPPORTUNITIES","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("ACCOUNT_ID", "CAMPAIGN_ID", "CAMPAIGN_NAME", "ACTIVE_FLAG", "SOURCE_ID", "TYPE", "STATUS", "START_DATE", "END_DATE", "EXPECTED_REVENUE", "BUDGETED_COST", "ACTUAL_COST", "EXPECTED_RESPONSE", "NUMBER_SENT", "NUMBER_OF_LEADS", "NUMBER_OF_CONVERTED_LEADS", "NUMBER_OF_CONTACTS", "NUMBER_OF_RESPONSES", "NUMBER_OF_OPPORTUNITIES", "NUMBER_OF_WON_OPPORTUNITIES", "AMOUNT_ALL_OPPORTUNITIES", "AMOUNT_WON_OPPORTUNITIES", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("ACCOUNT_ID", "CAMPAIGN_ID", "CAMPAIGN_NAME", "ACTIVE_FLAG", "SOURCE_ID", "TYPE", "STATUS", "START_DATE", "END_DATE", "EXPECTED_REVENUE", "BUDGETED_COST", "ACTUAL_COST", "EXPECTED_RESPONSE", "NUMBER_SENT", "NUMBER_OF_LEADS", "NUMBER_OF_CONVERTED_LEADS", "NUMBER_OF_CONTACTS", "NUMBER_OF_RESPONSES", "NUMBER_OF_OPPORTUNITIES", "NUMBER_OF_WON_OPPORTUNITIES", "AMOUNT_ALL_OPPORTUNITIES", "AMOUNT_WON_OPPORTUNITIES", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:43:49.593749 (Thread-1432): handling poll request
2020-12-30 18:43:49.594196 (Thread-1432): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4a95ee0>]}
2020-12-30 18:43:49.596364 (Thread-1432): sending response (<Response 9419 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:43:50.189674 (Thread-1): SQL status: SUCCESS 1268 in 0.85 seconds
2020-12-30 18:43:50.190885 (Thread-1): On model.sales_dataflo.Dim_Campaign: COMMIT
2020-12-30 18:43:50.191008 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-30 18:43:50.191055 (Thread-1): On model.sales_dataflo.Dim_Campaign: COMMIT
2020-12-30 18:43:50.414147 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-12-30 18:43:50.418489 (Thread-1): finished collecting timing info
2020-12-30 18:43:50.418873 (Thread-1): On model.sales_dataflo.Dim_Campaign: Close
2020-12-30 18:43:50.498768 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfae85d00>]}
2020-12-30 18:43:50.500076 (Thread-1): 18:43:50 | 8 of 30 OK created incremental model dbt_salesdataflo.Dim_Campaign... [SUCCESS 1268 in 2.80s]
2020-12-30 18:43:50.500218 (Thread-1): Finished running node model.sales_dataflo.Dim_Campaign
2020-12-30 18:43:50.500378 (Thread-1): Began running node model.sales_dataflo.Dim_Entity
2020-12-30 18:43:50.501725 (Thread-1): 18:43:50 | 9 of 30 START table model dbt_salesdataflo.Dim_Entity................ [RUN]
2020-12-30 18:43:50.502055 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-30 18:43:50.502168 (Thread-1): Compiling model.sales_dataflo.Dim_Entity
2020-12-30 18:43:50.509911 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Entity"
2020-12-30 18:43:50.535181 (Thread-1): finished collecting timing info
2020-12-30 18:43:50.540384 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Entity"
2020-12-30 18:43:50.562306 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-30 18:43:50.562384 (Thread-1): On model.sales_dataflo.Dim_Entity: BEGIN
2020-12-30 18:43:50.562444 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:50.941905 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2020-12-30 18:43:50.942049 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-30 18:43:50.942099 (Thread-1): On model.sales_dataflo.Dim_Entity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Entity"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Entity  as
      (

select * from (
Select 1 entity_id,'DBT_TEST_LIVEDATA_RK' entity_name,'D_ENTITY_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 2 entity_id,'SALESFORCE_FREETRAILS' entity_name,'D_ENTITY_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
)
      );
2020-12-30 18:43:51.024986 (Thread-1433): handling poll request
2020-12-30 18:43:51.025412 (Thread-1433): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf27fd00>]}
2020-12-30 18:43:51.028025 (Thread-1433): sending response (<Response 9335 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:43:51.602948 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2020-12-30 18:43:51.604452 (Thread-1): On model.sales_dataflo.Dim_Entity: COMMIT
2020-12-30 18:43:51.604629 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-30 18:43:51.604728 (Thread-1): On model.sales_dataflo.Dim_Entity: COMMIT
2020-12-30 18:43:51.655165 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:43:51.658288 (Thread-1): finished collecting timing info
2020-12-30 18:43:51.658601 (Thread-1): On model.sales_dataflo.Dim_Entity: Close
2020-12-30 18:43:51.725195 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfae97940>]}
2020-12-30 18:43:51.726841 (Thread-1): 18:43:51 | 9 of 30 OK created table model dbt_salesdataflo.Dim_Entity........... [SUCCESS 1 in 1.22s]
2020-12-30 18:43:51.726972 (Thread-1): Finished running node model.sales_dataflo.Dim_Entity
2020-12-30 18:43:51.727144 (Thread-1): Began running node model.sales_dataflo.Dim_Opportunity_Stage
2020-12-30 18:43:51.728502 (Thread-1): 18:43:51 | 10 of 30 START incremental model dbt_salesdataflo.Dim_Opportunity_Stage [RUN]
2020-12-30 18:43:51.728831 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:43:51.728946 (Thread-1): Compiling model.sales_dataflo.Dim_Opportunity_Stage
2020-12-30 18:43:51.744660 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity_Stage model triggered this warning. 
2020-12-30 18:43:51.748077 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Opportunity_Stage"
2020-12-30 18:43:51.771655 (Thread-1): finished collecting timing info
2020-12-30 18:43:51.777771 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:43:51.777852 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity_Stage"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage__dbt_tmp  as
      (



WITH source AS (
       select *  from DBT_TEST_LIVEDATA_RK.Opportunity_stage 
    ),Dim_Opportunity_stage as(
        SELECT
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS stage_id,
        MASTER_LABEL AS stage_name,
        SORT_ORDER AS stage_position,
        NULL AS account_id,
        IS_ACTIVE AS active_flag,
        ID AS Source_id,
        FORECAST_CATEGORY AS FORECAST_CATEGORY,
        NULL AS lead_opp_flag,
        IS_CLOSED AS IS_CLOSED,
        IS_WON AS IS_WON,
        DEFAULT_PROBABILITY AS OPPORTUNITY_STAGE,
          'SF'  as Source_type,
        'D_OPPORTUNITYSTAGES_DIM_LOAD'  AS 	DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
     FROM
       source
    )    

select * from Dim_Opportunity_stage
      );
2020-12-30 18:43:51.777911 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:52.463875 (Thread-1434): handling poll request
2020-12-30 18:43:52.464511 (Thread-1434): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4a1f160>]}
2020-12-30 18:43:52.467078 (Thread-1434): sending response (<Response 9356 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:43:53.611995 (Thread-1): SQL status: SUCCESS 1 in 1.83 seconds
2020-12-30 18:43:53.614913 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:43:53.615017 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity_Stage"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage__dbt_tmp
2020-12-30 18:43:53.696761 (Thread-1): SQL status: SUCCESS 14 in 0.08 seconds
2020-12-30 18:43:53.700147 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:43:53.700228 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity_Stage"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage
2020-12-30 18:43:53.765377 (Thread-1): SQL status: SUCCESS 14 in 0.07 seconds
2020-12-30 18:43:53.768725 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:43:53.768815 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity_Stage"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage
2020-12-30 18:43:53.830499 (Thread-1): SQL status: SUCCESS 14 in 0.06 seconds
2020-12-30 18:43:53.833420 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Opportunity_Stage"
2020-12-30 18:43:53.853587 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:43:53.853668 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: BEGIN
2020-12-30 18:43:53.891110 (Thread-1435): handling poll request
2020-12-30 18:43:53.891619 (Thread-1435): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4a95e50>]}
2020-12-30 18:43:53.893680 (Thread-1435): sending response (<Response 5527 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:43:53.935812 (Thread-1): SQL status: SUCCESS 1 in 0.08 seconds
2020-12-30 18:43:53.935944 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:43:53.935992 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Opportunity_Stage"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.Stage_id = DBT_INTERNAL_DEST.Stage_id
        

    
    when matched then update set
        "STAGE_ID" = DBT_INTERNAL_SOURCE."STAGE_ID","STAGE_NAME" = DBT_INTERNAL_SOURCE."STAGE_NAME","STAGE_POSITION" = DBT_INTERNAL_SOURCE."STAGE_POSITION","ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","FORECAST_CATEGORY" = DBT_INTERNAL_SOURCE."FORECAST_CATEGORY","LEAD_OPP_FLAG" = DBT_INTERNAL_SOURCE."LEAD_OPP_FLAG","IS_CLOSED" = DBT_INTERNAL_SOURCE."IS_CLOSED","IS_WON" = DBT_INTERNAL_SOURCE."IS_WON","OPPORTUNITY_STAGE" = DBT_INTERNAL_SOURCE."OPPORTUNITY_STAGE","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("STAGE_ID", "STAGE_NAME", "STAGE_POSITION", "ACCOUNT_ID", "ACTIVE_FLAG", "SOURCE_ID", "FORECAST_CATEGORY", "LEAD_OPP_FLAG", "IS_CLOSED", "IS_WON", "OPPORTUNITY_STAGE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("STAGE_ID", "STAGE_NAME", "STAGE_POSITION", "ACCOUNT_ID", "ACTIVE_FLAG", "SOURCE_ID", "FORECAST_CATEGORY", "LEAD_OPP_FLAG", "IS_CLOSED", "IS_WON", "OPPORTUNITY_STAGE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:43:54.660641 (Thread-1): SQL status: SUCCESS 1 in 0.72 seconds
2020-12-30 18:43:54.661585 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: COMMIT
2020-12-30 18:43:54.661706 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-30 18:43:54.661752 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: COMMIT
2020-12-30 18:43:55.173728 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-12-30 18:43:55.177863 (Thread-1): finished collecting timing info
2020-12-30 18:43:55.178206 (Thread-1): On model.sales_dataflo.Dim_Opportunity_Stage: Close
2020-12-30 18:43:55.252278 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfacbeeb0>]}
2020-12-30 18:43:55.253380 (Thread-1): 18:43:55 | 10 of 30 OK created incremental model dbt_salesdataflo.Dim_Opportunity_Stage [SUCCESS 1 in 3.52s]
2020-12-30 18:43:55.253482 (Thread-1): Finished running node model.sales_dataflo.Dim_Opportunity_Stage
2020-12-30 18:43:55.253592 (Thread-1): Began running node model.sales_dataflo.Dim_Metrics
2020-12-30 18:43:55.254380 (Thread-1): 18:43:55 | 11 of 30 START table model dbt_salesdataflo.Dim_Metrics.............. [RUN]
2020-12-30 18:43:55.254591 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-30 18:43:55.254676 (Thread-1): Compiling model.sales_dataflo.Dim_Metrics
2020-12-30 18:43:55.263085 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Metrics"
2020-12-30 18:43:55.293996 (Thread-1): finished collecting timing info
2020-12-30 18:43:55.298473 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Metrics"
2020-12-30 18:43:55.325131 (Thread-1436): handling poll request
2020-12-30 18:43:55.325515 (Thread-1436): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf28c100>]}
2020-12-30 18:43:55.327973 (Thread-1436): sending response (<Response 9896 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:43:55.340291 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-30 18:43:55.340383 (Thread-1): On model.sales_dataflo.Dim_Metrics: BEGIN
2020-12-30 18:43:55.340444 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:55.656340 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-12-30 18:43:55.656533 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-30 18:43:55.656619 (Thread-1): On model.sales_dataflo.Dim_Metrics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Metrics"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Metrics  as
      (

select * from(
Select 1 METRIC_ID,'Opportunities Won Revenue' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage ""is equal to Closed Won"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Opportunities Won Revenue during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 2 METRIC_ID,'Key Metrics' METRIC_NAME,5 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'' METRICCRITERIA,'This is a multi-metric Datablock with the following metrics: Avg Case Close Time, Converted Leads, Expected revenue, New Cases, New Leads, Opportunities Lost Count, Open Opportunities Count, Opportunities Won Count, Opportunities Won Revenue.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 3 METRIC_ID,'Converted Leads' METRIC_NAME,4 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Status ""is equal to Converted"" and Lead owner ""is equal to logged in employee""' METRICCRITERIA,'Number of Converted Leads during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 4 METRIC_ID,'New Leads' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Name ""is not empty"" and Lead owner ""is equal to logged in employee""' METRICCRITERIA,'Number of New Leads during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 5 METRIC_ID,'Open Opportunity by stage' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Sales stage ""is not equal to Closed Won"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Total Open Opportunities Count during the specified Date Range split up by Owner. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 6 METRIC_ID,'Top Sales Rep' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Sum ' RESULT_TYPE,'' METRICCRITERIA,'This is a multi-metric Datablock with the following metrics: Opportunities Won Amount by Owner, Opportunities Won Count by Owner.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 7 METRIC_ID,'New Leads by industry' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'' METRICCRITERIA,'Number of New Leads during the specified Date Range split up by Industry.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 8 METRIC_ID,'Return On Investment Amount by Campaign' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'' METRICCRITERIA,'Total Return On Investment Amount during the specified Date Range split up by Campaign Type. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 9 METRIC_ID,'Return On Investment by Campaign Type' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'' METRICCRITERIA,'Total Return On Investment during the specified Date Range split up by Campaign Type. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 10 METRIC_ID,'Opportunities Lost' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Sales stage ""is equal to Closed Lost"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Opportunities Lost Count during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 11 METRIC_ID,'Opportunities Lost Amount by Owner' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage ""is equal to Closed Lost""' METRICCRITERIA,'Opportunities Lost Amount during the specified Date Range split up by Owner.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 12 METRIC_ID,'Opportunities Lost by Owner' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage ""is equal to Closed Lost""' METRICCRITERIA,'Opportunities Lost Count during the specified Date Range split up by Owner.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 13 METRIC_ID,'Average Case Close Time' METRIC_NAME,6 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'' METRICCRITERIA,'Average Case Close Time during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 14 METRIC_ID,'Opportunities Lost Amount by Opp Name' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage ""is equal to Closed Lost"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Opportunities Lost Amount during the specified Date Range split up by Opportunity Name.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 15 METRIC_ID,'Closed Cases' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Status ""is equal to Closed"" and case owner ""is equal to logged in employee""' METRICCRITERIA,'Number of Closed Cases during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 16 METRIC_ID,'Opportunities Won Revenue by Product Family' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'' METRICCRITERIA,'Opportunities Won Revenue during the specified Date Range split up by Product Family.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 17 METRIC_ID,'Expected Revenue' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Closed Date "is not empty" and Sales stage "is not equal to Closed Won, closed Lost"' METRICCRITERIA,'Expected Revenue during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 18 METRIC_ID,'New Leads by Lead Source' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Lead Source ""is not empty""' METRICCRITERIA,'Number of New Leads during the specified Date Range split up by Lead Source.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 19 METRIC_ID,'New Leads by Lead Status' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Lead Status ""is not empty""' METRICCRITERIA,'Number of New Leads during the specified Date Range split up by Lead Status.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 20 METRIC_ID,'New Cases' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Case # ""is not empty""' METRICCRITERIA,'Number of New Cases during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 21 METRIC_ID,'Opportunities Won' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Sales stage ""is equal to Closed Won"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Opportunities Won Count during the specified Date Range.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 22 METRIC_ID,'Opportunities Won Amount by Opp Name' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage ""is equal to Closed Won"" and Opportunity owner ""is equal to logged in employee""' METRICCRITERIA,'Opportunities Won Amount during the specified Date Range split up by Opportunity Name.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 23 METRIC_ID,'Open Opportunities' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Sales stage "is not equal to Closed Won, closed Lost" and Opportunity owner "is equal to logged in employee"' METRICCRITERIA,'Total Open Opportunities Count during the specified Date Range. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 24 METRIC_ID,'Opportunities Overview' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'' METRICCRITERIA,'This is a multi-metric Datablock with the following metrics: Opportunities Lost Count, Open Opportunities Count, Opportunities Won Count.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 25 METRIC_ID,'Open Opportunities Amount by Stage Name' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'Sales stage "is not equal to Closed Won, closed Lost" and Opportunity owner "is equal to logged in employee"' METRICCRITERIA,'Total Open Opportunities Amount during the specified Date Range split up by Owner. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 26 METRIC_ID,'Open Opportunities Amount by Opp Name' METRIC_NAME,1 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Sum' RESULT_TYPE,'' METRICCRITERIA,'Total Open Opportunities Amount during the specified Date Range split up by Opportunity Name. Daily totals are not available for this metric. Instead, the total current value of this metric will be visualized cumulatively. No historical data is available from the initial connection.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 27 METRIC_ID,'Accounts' METRIC_NAME,5 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Account Name "is not empty" and Account Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of accounts by annual revenue.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 28 METRIC_ID,'Accounts by Type' METRIC_NAME,5 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Account Type "is not empty" and Account Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of accounts by type.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 29 METRIC_ID,'Contacts' METRIC_NAME,6 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,' Name "is not empty" and Contact Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of all your contacts by department including name, phone, title, and more.' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 30 METRIC_ID,'Leads' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,' Name "is not empty" and Lead Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of leads (for this quarter).' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 31 METRIC_ID,'Leads by location' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,' Address "is not empty" and Lead Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of leads by location (for the last 7 days).' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 32 METRIC_ID,'Opportunities by type' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Type "is not empty" and Opportunity Owner is equal to "Logged in employee"' METRICCRITERIA,'Get the number of opportunities by type (for this year or for the last two quarters).' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 33 METRIC_ID,'Leads by status' METRIC_NAME,3 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'TRUE' SEGMENT_FLAG,'Count' RESULT_TYPE,'Lead status "is not empty" and Lead Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of new leads by status (for this month).' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 34 METRIC_ID,'Opportunities (for this quarter)' METRIC_NAME,2 METRIC_CATEGORY_ID,'TRUE' ACTIVE_FLAG,'' SEGMENT_FLAG,'Count' RESULT_TYPE,'Opportunity Name "is not empty" and Opportunity Owner is equal to "Logged in employee"' METRICCRITERIA,'Get a list of opportunities (for this quarter).' DESCRIPTION,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
)
      );
2020-12-30 18:43:56.775949 (Thread-1437): handling poll request
2020-12-30 18:43:56.776373 (Thread-1437): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4750f70>]}
2020-12-30 18:43:56.777855 (Thread-1437): sending response (<Response 16521 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:43:57.066090 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2020-12-30 18:43:57.067583 (Thread-1): On model.sales_dataflo.Dim_Metrics: COMMIT
2020-12-30 18:43:57.067758 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-30 18:43:57.067841 (Thread-1): On model.sales_dataflo.Dim_Metrics: COMMIT
2020-12-30 18:43:57.124617 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:43:57.127919 (Thread-1): finished collecting timing info
2020-12-30 18:43:57.128257 (Thread-1): On model.sales_dataflo.Dim_Metrics: Close
2020-12-30 18:43:57.209339 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfab2cd30>]}
2020-12-30 18:43:57.210994 (Thread-1): 18:43:57 | 11 of 30 OK created table model dbt_salesdataflo.Dim_Metrics......... [SUCCESS 1 in 1.95s]
2020-12-30 18:43:57.211127 (Thread-1): Finished running node model.sales_dataflo.Dim_Metrics
2020-12-30 18:43:57.211288 (Thread-1): Began running node model.sales_dataflo.Dim_Metrics_Category
2020-12-30 18:43:57.212619 (Thread-1): 18:43:57 | 12 of 30 START table model dbt_salesdataflo.Dim_Metrics_Category..... [RUN]
2020-12-30 18:43:57.212951 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-30 18:43:57.213085 (Thread-1): Compiling model.sales_dataflo.Dim_Metrics_Category
2020-12-30 18:43:57.224794 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Metrics_Category"
2020-12-30 18:43:57.245356 (Thread-1): finished collecting timing info
2020-12-30 18:43:57.252847 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Metrics_Category"
2020-12-30 18:43:57.274787 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-30 18:43:57.274906 (Thread-1): On model.sales_dataflo.Dim_Metrics_Category: BEGIN
2020-12-30 18:43:57.275006 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:57.619949 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2020-12-30 18:43:57.620096 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-30 18:43:57.620147 (Thread-1): On model.sales_dataflo.Dim_Metrics_Category: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Metrics_Category"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Metrics_Category  as
      (

select *from (
Select 1 metric_category_id,'Productivity' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 2 metric_category_id,'Opportunity Generation' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 3 metric_category_id,'Lead Generation' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 4 metric_category_id,'Conversion' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 5 metric_category_id,'Account' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 6 metric_category_id,'Contact' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 7 metric_category_id,'Sub-list' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
union
Select 8 metric_category_id,'Funnel' metrics_category,'D_METRICS_DIM_LOAD' DW_SESSION_NM,CURRENT_TIMESTAMP DW_INS_UPD_DTS
)
      );
2020-12-30 18:43:58.237003 (Thread-1438): handling poll request
2020-12-30 18:43:58.237566 (Thread-1438): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4750ee0>]}
2020-12-30 18:43:58.240184 (Thread-1438): sending response (<Response 10403 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:43:58.280191 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2020-12-30 18:43:58.281205 (Thread-1): On model.sales_dataflo.Dim_Metrics_Category: COMMIT
2020-12-30 18:43:58.281356 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-30 18:43:58.281413 (Thread-1): On model.sales_dataflo.Dim_Metrics_Category: COMMIT
2020-12-30 18:43:58.328843 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:43:58.330847 (Thread-1): finished collecting timing info
2020-12-30 18:43:58.331055 (Thread-1): On model.sales_dataflo.Dim_Metrics_Category: Close
2020-12-30 18:43:58.397214 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfac9ceb0>]}
2020-12-30 18:43:58.398637 (Thread-1): 18:43:58 | 12 of 30 OK created table model dbt_salesdataflo.Dim_Metrics_Category [SUCCESS 1 in 1.18s]
2020-12-30 18:43:58.398728 (Thread-1): Finished running node model.sales_dataflo.Dim_Metrics_Category
2020-12-30 18:43:58.398833 (Thread-1): Began running node model.sales_dataflo.Dim_Product
2020-12-30 18:43:58.399632 (Thread-1): 18:43:58 | 13 of 30 START incremental model dbt_salesdataflo.Dim_Product........ [RUN]
2020-12-30 18:43:58.399842 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Product".
2020-12-30 18:43:58.399915 (Thread-1): Compiling model.sales_dataflo.Dim_Product
2020-12-30 18:43:58.408481 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Product model triggered this warning. 
2020-12-30 18:43:58.411814 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Product"
2020-12-30 18:43:58.433988 (Thread-1): finished collecting timing info
2020-12-30 18:43:58.439049 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Product"
2020-12-30 18:43:58.461841 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Product".
2020-12-30 18:43:58.461924 (Thread-1): On model.sales_dataflo.Dim_Product: BEGIN
2020-12-30 18:43:58.461986 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:58.946344 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-12-30 18:43:58.946488 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Product".
2020-12-30 18:43:58.946538 (Thread-1): On model.sales_dataflo.Dim_Product: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Product"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Product  as
      (
/*



    WITH source AS (
        SELECT * from DBT_TEST_LIVEDATA_RK.product
    ),Dim_Product as(
        SELECT
            NULL AS account_id,
            md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
)) AS product_id,
            ID AS Source_id,
            PRODUCT_CODE AS product_code,
            NAME AS product_name,
            IS_ACTIVE AS active_flag,
            QUANTITY_UNIT_OF_MEASURE AS Quantity_UOM,
               'SF'  as Source_type,
            'D_PRODUCT_DIM_LOAD'  AS DW_SESSION_NM,
            
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
         FROM
            source 
     
    )    
select * from Dim_Product
*/
      );
2020-12-30 18:43:59.013200 (Thread-1): Snowflake query id: 019947a3-0024-3e2b-0000-5eb100103666
2020-12-30 18:43:59.013322 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 39 at position 6 unexpected ')'.
2020-12-30 18:43:59.013450 (Thread-1): finished collecting timing info
2020-12-30 18:43:59.013689 (Thread-1): On model.sales_dataflo.Dim_Product: ROLLBACK
2020-12-30 18:43:59.136429 (Thread-1): On model.sales_dataflo.Dim_Product: Close
2020-12-30 18:43:59.205031 (Thread-1): Database Error in model Dim_Product (ETL/Target/Tables/Dim_Product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 39 at position 6 unexpected ')'.
  compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Product.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 39 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 120, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model Dim_Product (ETL/Target/Tables/Dim_Product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 39 at position 6 unexpected ')'.
  compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Product.sql
2020-12-30 18:43:59.207018 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfac25eb0>]}
2020-12-30 18:43:59.208157 (Thread-1): 18:43:59 | 13 of 30 ERROR creating incremental model dbt_salesdataflo.Dim_Product [ERROR in 0.81s]
2020-12-30 18:43:59.208250 (Thread-1): Finished running node model.sales_dataflo.Dim_Product
2020-12-30 18:43:59.208356 (Thread-1): Began running node model.sales_dataflo.Dim_TimeFrame
2020-12-30 18:43:59.209184 (Thread-1): 18:43:59 | 14 of 30 START table model dbt_salesdataflo.Dim_TimeFrame............ [RUN]
2020-12-30 18:43:59.209409 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-30 18:43:59.209484 (Thread-1): Compiling model.sales_dataflo.Dim_TimeFrame
2020-12-30 18:43:59.220064 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_TimeFrame"
2020-12-30 18:43:59.238219 (Thread-1): finished collecting timing info
2020-12-30 18:43:59.242581 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_TimeFrame"
2020-12-30 18:43:59.264161 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-30 18:43:59.264241 (Thread-1): On model.sales_dataflo.Dim_TimeFrame: BEGIN
2020-12-30 18:43:59.264300 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:43:59.637881 (Thread-1439): handling poll request
2020-12-30 18:43:59.638290 (Thread-1439): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48edd90>]}
2020-12-30 18:43:59.644087 (Thread-1439): sending response (<Response 22708 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:43:59.756821 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2020-12-30 18:43:59.756961 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-30 18:43:59.757011 (Thread-1): On model.sales_dataflo.Dim_TimeFrame: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_TimeFrame"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame  as
      (



with year_data as 
(
    select * from DBT_TEST_LIVEDATA_RK.period 
    where type ='Year'
),
qutr_data as 
(
    select * from DBT_TEST_LIVEDATA_RK.period 
    where type ='Quarter'
),
 Dates AS 
(
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Calendar
)   
,Dim_TimeFrame as(
select
    d.Calendar_ID AS TimeFrameID,
    'D' as TimeFrameType,
    d.Calendar_ID as calendar_id,
    d.cldr_date as day_start,
    d.cldr_date as day_end,
    d.week_start_date as week_Start,
    d.week_end_date as week_end,
    'W' || d.cldr_week_num as week_num,
    d.cldr_mnth_strt_dt as month_start,
    d.cldr_mnth_end_dt as month_end, 
    d.month_name as month_name,
     'Q' || s.number as qutr_number,
    s.start_date as quarter_start,
    s.end_date as quarter_end,
    d.year as year,
    y.start_date as year_start,
    y.end_date as year_end,
      'SF'  as Source_type,
    'D_TIMEFRAME_DIM_LOAD' AS DW_SESSION_NM,
    
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS     
from
    dates d
    left join qutr_data s
    on d.cldr_date between s.start_date and s.end_date
    left join year_data y
    on d.cldr_date between y.start_date and y.end_date
order by 2)

select * from Dim_TimeFrame
      );
2020-12-30 18:44:00.685206 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2020-12-30 18:44:00.686539 (Thread-1): On model.sales_dataflo.Dim_TimeFrame: COMMIT
2020-12-30 18:44:00.686713 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-30 18:44:00.686792 (Thread-1): On model.sales_dataflo.Dim_TimeFrame: COMMIT
2020-12-30 18:44:00.755887 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:44:00.757848 (Thread-1): finished collecting timing info
2020-12-30 18:44:00.758061 (Thread-1): On model.sales_dataflo.Dim_TimeFrame: Close
2020-12-30 18:44:00.829042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfac25340>]}
2020-12-30 18:44:00.830589 (Thread-1): 18:44:00 | 14 of 30 OK created table model dbt_salesdataflo.Dim_TimeFrame....... [SUCCESS 1 in 1.62s]
2020-12-30 18:44:00.830692 (Thread-1): Finished running node model.sales_dataflo.Dim_TimeFrame
2020-12-30 18:44:00.830797 (Thread-1): Began running node model.sales_dataflo.Dim_Employee_Hier
2020-12-30 18:44:00.831579 (Thread-1): 18:44:00 | 15 of 30 START view model dbt_salesdataflo.Dim_Employee_Hier......... [RUN]
2020-12-30 18:44:00.831801 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2020-12-30 18:44:00.831874 (Thread-1): Compiling model.sales_dataflo.Dim_Employee_Hier
2020-12-30 18:44:00.862300 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Dim_Employee_Hier"
2020-12-30 18:44:00.889357 (Thread-1): finished collecting timing info
2020-12-30 18:44:00.908570 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Dim_Employee_Hier"
2020-12-30 18:44:00.935372 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2020-12-30 18:44:00.935489 (Thread-1): On model.sales_dataflo.Dim_Employee_Hier: BEGIN
2020-12-30 18:44:00.935589 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:01.074542 (Thread-1440): handling poll request
2020-12-30 18:44:01.074952 (Thread-1440): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4750220>]}
2020-12-30 18:44:01.077651 (Thread-1440): sending response (<Response 11577 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:44:01.441191 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-12-30 18:44:01.441336 (Thread-1): Using snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2020-12-30 18:44:01.441384 (Thread-1): On model.sales_dataflo.Dim_Employee_Hier: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Dim_Employee_Hier"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee_Hier  as (
    
with recursive Emp_Hier as (
 select * from 
 (
 select distinct 
 a.entity_id,
 b.source_Emp_id as employee_id, 
 b.emp_position_level, 
 b.emp_role_id,
 a.mngr_emp_id
 a.mngr_position_level,
 a.mngr_role_id
 from 
 DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee a
 join DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee b
 on a.source_Emp_id = b.mngr_emp_id
 ) rslt
 where not exists 
 (Select 1 from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee e where rslt.employee_id = e.source_Emp_id and rslt.mngr_emp_id = e.mngr_emp_id)
 )
  union all 

with recursive Emp_Hier as (
 select * from 
 (
 select distinct 
 a.entity_id,
 b.source_Emp_id as employee_id, 
 b.emp_position_level, 
 b.emp_role_id,
 a.mngr_emp_id
 a.mngr_position_level,
 a.mngr_role_id
 from 
 DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee a
 join DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee b
 on a.source_Emp_id = b.mngr_emp_id
 ) rslt
 where not exists 
 (Select 1 from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee e where rslt.employee_id = e.source_Emp_id and rslt.mngr_emp_id = e.mngr_emp_id)
 )
  union all 

with recursive Emp_Hier as (
 select * from 
 (
 select distinct 
 a.entity_id,
 b.source_Emp_id as employee_id, 
 b.emp_position_level, 
 b.emp_role_id,
 a.mngr_emp_id
 a.mngr_position_level,
 a.mngr_role_id
 from 
 DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee a
 join DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee b
 on a.source_Emp_id = b.mngr_emp_id
 ) rslt
 where not exists 
 (Select 1 from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee e where rslt.employee_id = e.source_Emp_id and rslt.mngr_emp_id = e.mngr_emp_id)
 )
  union all 

with recursive Emp_Hier as (
 select * from 
 (
 select distinct 
 a.entity_id,
 b.source_Emp_id as employee_id, 
 b.emp_position_level, 
 b.emp_role_id,
 a.mngr_emp_id
 a.mngr_position_level,
 a.mngr_role_id
 from 
 DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee a
 join DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee b
 on a.source_Emp_id = b.mngr_emp_id
 ) rslt
 where not exists 
 (Select 1 from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee e where rslt.employee_id = e.source_Emp_id and rslt.mngr_emp_id = e.mngr_emp_id)
 )
  union all 

with recursive Emp_Hier as (
 select * from 
 (
 select distinct 
 a.entity_id,
 b.source_Emp_id as employee_id, 
 b.emp_position_level, 
 b.emp_role_id,
 a.mngr_emp_id
 a.mngr_position_level,
 a.mngr_role_id
 from 
 DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee a
 join DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee b
 on a.source_Emp_id = b.mngr_emp_id
 ) rslt
 where not exists 
 (Select 1 from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee e where rslt.employee_id = e.source_Emp_id and rslt.mngr_emp_id = e.mngr_emp_id)
 )
  union all 

with recursive Emp_Hier as (
 select * from 
 (
 select distinct 
 a.entity_id,
 b.source_Emp_id as employee_id, 
 b.emp_position_level, 
 b.emp_role_id,
 a.mngr_emp_id
 a.mngr_position_level,
 a.mngr_role_id
 from 
 DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee a
 join DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee b
 on a.source_Emp_id = b.mngr_emp_id
 ) rslt
 where not exists 
 (Select 1 from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee e where rslt.employee_id = e.source_Emp_id and rslt.mngr_emp_id = e.mngr_emp_id)
 )
  union all 

with recursive Emp_Hier as (
 select * from 
 (
 select distinct 
 a.entity_id,
 b.source_Emp_id as employee_id, 
 b.emp_position_level, 
 b.emp_role_id,
 a.mngr_emp_id
 a.mngr_position_level,
 a.mngr_role_id
 from 
 DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee a
 join DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee b
 on a.source_Emp_id = b.mngr_emp_id
 ) rslt
 where not exists 
 (Select 1 from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee e where rslt.employee_id = e.source_Emp_id and rslt.mngr_emp_id = e.mngr_emp_id)
 )
  union all 

with recursive Emp_Hier as (
 select * from 
 (
 select distinct 
 a.entity_id,
 b.source_Emp_id as employee_id, 
 b.emp_position_level, 
 b.emp_role_id,
 a.mngr_emp_id
 a.mngr_position_level,
 a.mngr_role_id
 from 
 DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee a
 join DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee b
 on a.source_Emp_id = b.mngr_emp_id
 ) rslt
 where not exists 
 (Select 1 from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee e where rslt.employee_id = e.source_Emp_id and rslt.mngr_emp_id = e.mngr_emp_id)
 )
  union all 

with recursive Emp_Hier as (
 select * from 
 (
 select distinct 
 a.entity_id,
 b.source_Emp_id as employee_id, 
 b.emp_position_level, 
 b.emp_role_id,
 a.mngr_emp_id
 a.mngr_position_level,
 a.mngr_role_id
 from 
 DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee a
 join DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee b
 on a.source_Emp_id = b.mngr_emp_id
 ) rslt
 where not exists 
 (Select 1 from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee e where rslt.employee_id = e.source_Emp_id and rslt.mngr_emp_id = e.mngr_emp_id)
 )
  union all 

with recursive Emp_Hier as (
 select * from 
 (
 select distinct 
 a.entity_id,
 b.source_Emp_id as employee_id, 
 b.emp_position_level, 
 b.emp_role_id,
 a.mngr_emp_id
 a.mngr_position_level,
 a.mngr_role_id
 from 
 DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee a
 join DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee b
 on a.source_Emp_id = b.mngr_emp_id
 ) rslt
 where not exists 
 (Select 1 from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee e where rslt.employee_id = e.source_Emp_id and rslt.mngr_emp_id = e.mngr_emp_id)
 )
 


 select * from Emp_Hier
  );
2020-12-30 18:44:01.512256 (Thread-1): Snowflake query id: 019947a4-004a-33f6-0000-5eb10010465e
2020-12-30 18:44:01.512375 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 2 unexpected '.'.
syntax error line 14 at position 1 unexpected 'from'.
syntax error line 18 at position 3 unexpected 'rslt'.
syntax error line 21 at position 1 unexpected ')'.
2020-12-30 18:44:01.512503 (Thread-1): finished collecting timing info
2020-12-30 18:44:01.512795 (Thread-1): On model.sales_dataflo.Dim_Employee_Hier: ROLLBACK
2020-12-30 18:44:01.608603 (Thread-1): On model.sales_dataflo.Dim_Employee_Hier: Close
2020-12-30 18:44:01.684744 (Thread-1): Database Error in model Dim_Employee_Hier (ETL/Target/Tables/Dim_Employee_Hier.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '.'.
  syntax error line 14 at position 1 unexpected 'from'.
  syntax error line 18 at position 3 unexpected 'rslt'.
  syntax error line 21 at position 1 unexpected ')'.
  compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Employee_Hier.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 12 at position 2 unexpected '.'.
syntax error line 14 at position 1 unexpected 'from'.
syntax error line 18 at position 3 unexpected 'rslt'.
syntax error line 21 at position 1 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model Dim_Employee_Hier (ETL/Target/Tables/Dim_Employee_Hier.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '.'.
  syntax error line 14 at position 1 unexpected 'from'.
  syntax error line 18 at position 3 unexpected 'rslt'.
  syntax error line 21 at position 1 unexpected ')'.
  compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Employee_Hier.sql
2020-12-30 18:44:01.685578 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfac9c190>]}
2020-12-30 18:44:01.687183 (Thread-1): 18:44:01 | 15 of 30 ERROR creating view model dbt_salesdataflo.Dim_Employee_Hier [ERROR in 0.85s]
2020-12-30 18:44:01.687302 (Thread-1): Finished running node model.sales_dataflo.Dim_Employee_Hier
2020-12-30 18:44:01.687438 (Thread-1): Began running node model.sales_dataflo.VW_Employee
2020-12-30 18:44:01.688702 (Thread-1): 18:44:01 | 16 of 30 START view model dbt_salesdataflo.VW_Employee............... [RUN]
2020-12-30 18:44:01.688947 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Employee".
2020-12-30 18:44:01.689024 (Thread-1): Compiling model.sales_dataflo.VW_Employee
2020-12-30 18:44:01.697496 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Employee"
2020-12-30 18:44:01.718138 (Thread-1): finished collecting timing info
2020-12-30 18:44:01.725540 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Employee"
2020-12-30 18:44:01.748240 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Employee".
2020-12-30 18:44:01.748341 (Thread-1): On model.sales_dataflo.VW_Employee: BEGIN
2020-12-30 18:44:01.748405 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:02.205784 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2020-12-30 18:44:02.205926 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Employee".
2020-12-30 18:44:02.205977 (Thread-1): On model.sales_dataflo.VW_Employee: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Employee"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Employee  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
  );
2020-12-30 18:44:02.452627 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-12-30 18:44:02.453615 (Thread-1): On model.sales_dataflo.VW_Employee: COMMIT
2020-12-30 18:44:02.453736 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Employee".
2020-12-30 18:44:02.453783 (Thread-1): On model.sales_dataflo.VW_Employee: COMMIT
2020-12-30 18:44:02.480723 (Thread-1441): handling poll request
2020-12-30 18:44:02.481150 (Thread-1441): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d497f790>]}
2020-12-30 18:44:02.484668 (Thread-1441): sending response (<Response 23940 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:44:02.504619 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:44:02.507889 (Thread-1): finished collecting timing info
2020-12-30 18:44:02.508104 (Thread-1): On model.sales_dataflo.VW_Employee: Close
2020-12-30 18:44:02.581312 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf853c9d0>]}
2020-12-30 18:44:02.582352 (Thread-1): 18:44:02 | 16 of 30 OK created view model dbt_salesdataflo.VW_Employee.......... [SUCCESS 1 in 0.89s]
2020-12-30 18:44:02.582441 (Thread-1): Finished running node model.sales_dataflo.VW_Employee
2020-12-30 18:44:02.582546 (Thread-1): Began running node model.sales_dataflo.VW_Account
2020-12-30 18:44:02.583326 (Thread-1): 18:44:02 | 17 of 30 START view model dbt_salesdataflo.VW_Account................ [RUN]
2020-12-30 18:44:02.583542 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Account".
2020-12-30 18:44:02.583614 (Thread-1): Compiling model.sales_dataflo.VW_Account
2020-12-30 18:44:02.591493 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Account"
2020-12-30 18:44:02.609787 (Thread-1): finished collecting timing info
2020-12-30 18:44:02.614108 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Account"
2020-12-30 18:44:02.633488 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Account".
2020-12-30 18:44:02.633573 (Thread-1): On model.sales_dataflo.VW_Account: BEGIN
2020-12-30 18:44:02.633632 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:02.940966 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-12-30 18:44:02.941138 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Account".
2020-12-30 18:44:02.941191 (Thread-1): On model.sales_dataflo.VW_Account: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Account"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Account  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account
  );
2020-12-30 18:44:03.168932 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-12-30 18:44:03.170166 (Thread-1): On model.sales_dataflo.VW_Account: COMMIT
2020-12-30 18:44:03.170290 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Account".
2020-12-30 18:44:03.170336 (Thread-1): On model.sales_dataflo.VW_Account: COMMIT
2020-12-30 18:44:03.226355 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:03.230580 (Thread-1): finished collecting timing info
2020-12-30 18:44:03.230787 (Thread-1): On model.sales_dataflo.VW_Account: Close
2020-12-30 18:44:03.307638 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfac7e2b0>]}
2020-12-30 18:44:03.308676 (Thread-1): 18:44:03 | 17 of 30 OK created view model dbt_salesdataflo.VW_Account........... [SUCCESS 1 in 0.72s]
2020-12-30 18:44:03.308767 (Thread-1): Finished running node model.sales_dataflo.VW_Account
2020-12-30 18:44:03.308873 (Thread-1): Began running node model.sales_dataflo.VW_Lead
2020-12-30 18:44:03.309677 (Thread-1): 18:44:03 | 18 of 30 START view model dbt_salesdataflo.VW_Lead................... [RUN]
2020-12-30 18:44:03.309886 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-30 18:44:03.309978 (Thread-1): Compiling model.sales_dataflo.VW_Lead
2020-12-30 18:44:03.318660 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Lead"
2020-12-30 18:44:03.337978 (Thread-1): finished collecting timing info
2020-12-30 18:44:03.342631 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Lead"
2020-12-30 18:44:03.362629 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-30 18:44:03.362717 (Thread-1): On model.sales_dataflo.VW_Lead: BEGIN
2020-12-30 18:44:03.362780 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:03.662547 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-12-30 18:44:03.662695 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-30 18:44:03.662746 (Thread-1): On model.sales_dataflo.VW_Lead: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Lead"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Lead  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead
  );
2020-12-30 18:44:03.915606 (Thread-1442): handling poll request
2020-12-30 18:44:03.916016 (Thread-1442): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf2415e0>]}
2020-12-30 18:44:03.920193 (Thread-1442): sending response (<Response 16527 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:44:03.921043 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-12-30 18:44:03.922017 (Thread-1): On model.sales_dataflo.VW_Lead: COMMIT
2020-12-30 18:44:03.922140 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-30 18:44:03.922186 (Thread-1): On model.sales_dataflo.VW_Lead: COMMIT
2020-12-30 18:44:03.973942 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:44:03.977019 (Thread-1): finished collecting timing info
2020-12-30 18:44:03.977282 (Thread-1): On model.sales_dataflo.VW_Lead: Close
2020-12-30 18:44:04.049408 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf854a2b0>]}
2020-12-30 18:44:04.050496 (Thread-1): 18:44:04 | 18 of 30 OK created view model dbt_salesdataflo.VW_Lead.............. [SUCCESS 1 in 0.74s]
2020-12-30 18:44:04.050589 (Thread-1): Finished running node model.sales_dataflo.VW_Lead
2020-12-30 18:44:04.050694 (Thread-1): Began running node model.sales_dataflo.VW_Opportunity
2020-12-30 18:44:04.051486 (Thread-1): 18:44:04 | 19 of 30 START view model dbt_salesdataflo.VW_Opportunity............ [RUN]
2020-12-30 18:44:04.051698 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-30 18:44:04.051772 (Thread-1): Compiling model.sales_dataflo.VW_Opportunity
2020-12-30 18:44:04.059635 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Opportunity"
2020-12-30 18:44:04.080782 (Thread-1): finished collecting timing info
2020-12-30 18:44:04.085920 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Opportunity"
2020-12-30 18:44:04.110909 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-30 18:44:04.111059 (Thread-1): On model.sales_dataflo.VW_Opportunity: BEGIN
2020-12-30 18:44:04.111150 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:04.439180 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2020-12-30 18:44:04.439341 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-30 18:44:04.439392 (Thread-1): On model.sales_dataflo.VW_Opportunity: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Opportunity"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Opportunity  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity
  );
2020-12-30 18:44:04.670878 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-12-30 18:44:04.671857 (Thread-1): On model.sales_dataflo.VW_Opportunity: COMMIT
2020-12-30 18:44:04.671992 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-30 18:44:04.672040 (Thread-1): On model.sales_dataflo.VW_Opportunity: COMMIT
2020-12-30 18:44:04.731454 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:04.734914 (Thread-1): finished collecting timing info
2020-12-30 18:44:04.735128 (Thread-1): On model.sales_dataflo.VW_Opportunity: Close
2020-12-30 18:44:04.803334 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfae5bc10>]}
2020-12-30 18:44:04.804381 (Thread-1): 18:44:04 | 19 of 30 OK created view model dbt_salesdataflo.VW_Opportunity....... [SUCCESS 1 in 0.75s]
2020-12-30 18:44:04.804470 (Thread-1): Finished running node model.sales_dataflo.VW_Opportunity
2020-12-30 18:44:04.804575 (Thread-1): Began running node model.sales_dataflo.VW_Contact
2020-12-30 18:44:04.805391 (Thread-1): 18:44:04 | 20 of 30 START view model dbt_salesdataflo.VW_Contact................ [RUN]
2020-12-30 18:44:04.805606 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-30 18:44:04.805677 (Thread-1): Compiling model.sales_dataflo.VW_Contact
2020-12-30 18:44:04.813651 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Contact"
2020-12-30 18:44:04.833087 (Thread-1): finished collecting timing info
2020-12-30 18:44:04.839576 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Contact"
2020-12-30 18:44:04.857114 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-30 18:44:04.857234 (Thread-1): On model.sales_dataflo.VW_Contact: BEGIN
2020-12-30 18:44:04.857335 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:05.219029 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2020-12-30 18:44:05.219169 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-30 18:44:05.219219 (Thread-1): On model.sales_dataflo.VW_Contact: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Contact"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Contact  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact
  );
2020-12-30 18:44:05.347720 (Thread-1443): handling poll request
2020-12-30 18:44:05.348336 (Thread-1443): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48cd6a0>]}
2020-12-30 18:44:05.457945 (Thread-1443): sending response (<Response 18034 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:44:05.462853 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-12-30 18:44:05.463807 (Thread-1): On model.sales_dataflo.VW_Contact: COMMIT
2020-12-30 18:44:05.463937 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-30 18:44:05.463984 (Thread-1): On model.sales_dataflo.VW_Contact: COMMIT
2020-12-30 18:44:05.520737 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:05.524032 (Thread-1): finished collecting timing info
2020-12-30 18:44:05.524297 (Thread-1): On model.sales_dataflo.VW_Contact: Close
2020-12-30 18:44:05.598655 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf84dcee0>]}
2020-12-30 18:44:05.600100 (Thread-1): 18:44:05 | 20 of 30 OK created view model dbt_salesdataflo.VW_Contact........... [SUCCESS 1 in 0.79s]
2020-12-30 18:44:05.600193 (Thread-1): Finished running node model.sales_dataflo.VW_Contact
2020-12-30 18:44:05.600299 (Thread-1): Began running node model.sales_dataflo.VW_Address
2020-12-30 18:44:05.601108 (Thread-1): 18:44:05 | 21 of 30 START view model dbt_salesdataflo.VW_Address................ [RUN]
2020-12-30 18:44:05.601318 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Address".
2020-12-30 18:44:05.601390 (Thread-1): Compiling model.sales_dataflo.VW_Address
2020-12-30 18:44:05.608256 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Address"
2020-12-30 18:44:05.626240 (Thread-1): finished collecting timing info
2020-12-30 18:44:05.630579 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Address"
2020-12-30 18:44:05.651548 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Address".
2020-12-30 18:44:05.651633 (Thread-1): On model.sales_dataflo.VW_Address: BEGIN
2020-12-30 18:44:05.651695 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:05.959241 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-12-30 18:44:05.959390 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Address".
2020-12-30 18:44:05.959441 (Thread-1): On model.sales_dataflo.VW_Address: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Address"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Address  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Address
  );
2020-12-30 18:44:06.235037 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2020-12-30 18:44:06.236069 (Thread-1): On model.sales_dataflo.VW_Address: COMMIT
2020-12-30 18:44:06.236200 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Address".
2020-12-30 18:44:06.236248 (Thread-1): On model.sales_dataflo.VW_Address: COMMIT
2020-12-30 18:44:06.290837 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:44:06.293918 (Thread-1): finished collecting timing info
2020-12-30 18:44:06.294133 (Thread-1): On model.sales_dataflo.VW_Address: Close
2020-12-30 18:44:06.362130 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfac305b0>]}
2020-12-30 18:44:06.363216 (Thread-1): 18:44:06 | 21 of 30 OK created view model dbt_salesdataflo.VW_Address........... [SUCCESS 1 in 0.76s]
2020-12-30 18:44:06.363308 (Thread-1): Finished running node model.sales_dataflo.VW_Address
2020-12-30 18:44:06.363414 (Thread-1): Began running node model.sales_dataflo.VW_Campaign
2020-12-30 18:44:06.365124 (Thread-1): 18:44:06 | 22 of 30 START view model dbt_salesdataflo.VW_Campaign............... [RUN]
2020-12-30 18:44:06.365362 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-30 18:44:06.365436 (Thread-1): Compiling model.sales_dataflo.VW_Campaign
2020-12-30 18:44:06.373077 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Campaign"
2020-12-30 18:44:06.391719 (Thread-1): finished collecting timing info
2020-12-30 18:44:06.396692 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Campaign"
2020-12-30 18:44:06.415441 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-30 18:44:06.415521 (Thread-1): On model.sales_dataflo.VW_Campaign: BEGIN
2020-12-30 18:44:06.415582 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:06.734204 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-12-30 18:44:06.734350 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-30 18:44:06.734400 (Thread-1): On model.sales_dataflo.VW_Campaign: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Campaign"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Campaign  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Campaign
  );
2020-12-30 18:44:06.964708 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-12-30 18:44:06.965690 (Thread-1): On model.sales_dataflo.VW_Campaign: COMMIT
2020-12-30 18:44:06.965813 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-30 18:44:06.965860 (Thread-1): On model.sales_dataflo.VW_Campaign: COMMIT
2020-12-30 18:44:06.977773 (Thread-1444): handling poll request
2020-12-30 18:44:06.978161 (Thread-1444): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48cd3a0>]}
2020-12-30 18:44:06.982852 (Thread-1444): sending response (<Response 19235 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:44:07.019873 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:44:07.022832 (Thread-1): finished collecting timing info
2020-12-30 18:44:07.023031 (Thread-1): On model.sales_dataflo.VW_Campaign: Close
2020-12-30 18:44:07.087016 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfabd10d0>]}
2020-12-30 18:44:07.088043 (Thread-1): 18:44:07 | 22 of 30 OK created view model dbt_salesdataflo.VW_Campaign.......... [SUCCESS 1 in 0.72s]
2020-12-30 18:44:07.088130 (Thread-1): Finished running node model.sales_dataflo.VW_Campaign
2020-12-30 18:44:07.088231 (Thread-1): Began running node model.sales_dataflo.test
2020-12-30 18:44:07.089016 (Thread-1): 18:44:07 | 23 of 30 START incremental model dbt_salesdataflo.test............... [RUN]
2020-12-30 18:44:07.089250 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test".
2020-12-30 18:44:07.089321 (Thread-1): Compiling model.sales_dataflo.test
2020-12-30 18:44:07.099357 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:44:07.099441 (Thread-1): On model.sales_dataflo.test: BEGIN
2020-12-30 18:44:07.099500 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:07.418995 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-12-30 18:44:07.419215 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:44:07.419303 (Thread-1): On model.sales_dataflo.test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.test"} */
select
                entity_name as value

            from "DATAFLOTEST_DATABASE"."DBT_SALESDATAFLO"."DIM_ENTITY"
            group by 1
            order by count(*) desc
2020-12-30 18:44:07.618777 (Thread-1): SQL status: SUCCESS 2 in 0.20 seconds
2020-12-30 18:44:07.619422 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.test model triggered this warning. 
2020-12-30 18:44:07.620522 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.test model triggered this warning. 
2020-12-30 18:44:07.623316 (Thread-1): Writing injected SQL for node "model.sales_dataflo.test"
2020-12-30 18:44:07.644985 (Thread-1): finished collecting timing info
2020-12-30 18:44:07.652790 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:44:07.652877 (Thread-1): On model.sales_dataflo.test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.test"} */

    

      create or replace temporary table DATAFLOTEST_DATABASE.dbt_salesdataflo.test__dbt_tmp  as
      (







  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        'DBT_TEST_LIVEDATA_RK' as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM DBT_TEST_LIVEDATA_RK.Account


            UNION ALL
        
  select
        md5(cast(
    
    coalesce(cast(id as 
    varchar
), '')

 as 
    varchar
))  AS Account_ID,
        NAME AS Account_Name,
        TYPE AS Account_Type,
        ID AS Source_ID,
        IS_DELETED AS Active_Flag,
        --ACCOUNT_NUMBER AS ACCOUNT_NUMBER,
        INDUSTRY AS INDUSTRY,
        ANNUAL_REVENUE AS ANNUAL_REVENUE,
        OWNER_ID AS Employee_ID,
        CREATED_DATE as INITIAL_CREATE_DT,
        'SALESFORCE_FREETRAILS' as Source_type,
        'D_ACCOUNT_DIM_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
    FROM SALESFORCE_FREETRAILS.Account

      );
2020-12-30 18:44:08.413302 (Thread-1445): handling poll request
2020-12-30 18:44:08.413710 (Thread-1445): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45c0f10>]}
2020-12-30 18:44:08.416378 (Thread-1445): sending response (<Response 10995 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:44:08.460252 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2020-12-30 18:44:08.463502 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:44:08.463596 (Thread-1): On model.sales_dataflo.test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.test"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.test__dbt_tmp
2020-12-30 18:44:08.546449 (Thread-1): SQL status: SUCCESS 12 in 0.08 seconds
2020-12-30 18:44:08.550495 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:44:08.550587 (Thread-1): On model.sales_dataflo.test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.test"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.test
2020-12-30 18:44:08.632193 (Thread-1): SQL status: SUCCESS 12 in 0.08 seconds
2020-12-30 18:44:08.635807 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:44:08.635935 (Thread-1): On model.sales_dataflo.test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.test"} */

    describe table DATAFLOTEST_DATABASE.dbt_salesdataflo.test
2020-12-30 18:44:08.700890 (Thread-1): SQL status: SUCCESS 12 in 0.06 seconds
2020-12-30 18:44:08.703142 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.test"
2020-12-30 18:44:08.723114 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:44:08.723213 (Thread-1): On model.sales_dataflo.test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.test"} */

        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.test as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.test__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.Account_ID = DBT_INTERNAL_DEST.Account_ID
        

    
    when matched then update set
        "ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","ACCOUNT_NAME" = DBT_INTERNAL_SOURCE."ACCOUNT_NAME","ACCOUNT_TYPE" = DBT_INTERNAL_SOURCE."ACCOUNT_TYPE","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","INDUSTRY" = DBT_INTERNAL_SOURCE."INDUSTRY","ANNUAL_REVENUE" = DBT_INTERNAL_SOURCE."ANNUAL_REVENUE","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","INITIAL_CREATE_DT" = DBT_INTERNAL_SOURCE."INITIAL_CREATE_DT","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("ACCOUNT_ID", "ACCOUNT_NAME", "ACCOUNT_TYPE", "SOURCE_ID", "ACTIVE_FLAG", "INDUSTRY", "ANNUAL_REVENUE", "EMPLOYEE_ID", "INITIAL_CREATE_DT", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("ACCOUNT_ID", "ACCOUNT_NAME", "ACCOUNT_TYPE", "SOURCE_ID", "ACTIVE_FLAG", "INDUSTRY", "ANNUAL_REVENUE", "EMPLOYEE_ID", "INITIAL_CREATE_DT", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
2020-12-30 18:44:09.511106 (Thread-1): SQL status: SUCCESS 16248 in 0.79 seconds
2020-12-30 18:44:09.512063 (Thread-1): On model.sales_dataflo.test: COMMIT
2020-12-30 18:44:09.512193 (Thread-1): Using snowflake connection "model.sales_dataflo.test".
2020-12-30 18:44:09.512240 (Thread-1): On model.sales_dataflo.test: COMMIT
2020-12-30 18:44:09.731654 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-12-30 18:44:09.734739 (Thread-1): finished collecting timing info
2020-12-30 18:44:09.734958 (Thread-1): On model.sales_dataflo.test: Close
2020-12-30 18:44:09.815125 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfacb7ca0>]}
2020-12-30 18:44:09.816331 (Thread-1): 18:44:09 | 23 of 30 OK created incremental model dbt_salesdataflo.test.......... [SUCCESS 16248 in 2.73s]
2020-12-30 18:44:09.816432 (Thread-1): Finished running node model.sales_dataflo.test
2020-12-30 18:44:09.816534 (Thread-1): Began running node model.sales_dataflo.VW_Opportunity_Stage
2020-12-30 18:44:09.817440 (Thread-1): 18:44:09 | 24 of 30 START view model dbt_salesdataflo.VW_Opportunity_Stage...... [RUN]
2020-12-30 18:44:09.817668 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-30 18:44:09.817743 (Thread-1): Compiling model.sales_dataflo.VW_Opportunity_Stage
2020-12-30 18:44:09.825390 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_Opportunity_Stage"
2020-12-30 18:44:09.844485 (Thread-1446): handling poll request
2020-12-30 18:44:09.844838 (Thread-1446): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb389a0>]}
2020-12-30 18:44:09.848423 (Thread-1446): sending response (<Response 12506 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:44:09.846197 (Thread-1): finished collecting timing info
2020-12-30 18:44:09.850870 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_Opportunity_Stage"
2020-12-30 18:44:09.870479 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-30 18:44:09.870563 (Thread-1): On model.sales_dataflo.VW_Opportunity_Stage: BEGIN
2020-12-30 18:44:09.870624 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:10.347883 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-12-30 18:44:10.348027 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-30 18:44:10.348076 (Thread-1): On model.sales_dataflo.VW_Opportunity_Stage: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_Opportunity_Stage"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_Opportunity_Stage  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage
  );
2020-12-30 18:44:10.587826 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-12-30 18:44:10.588798 (Thread-1): On model.sales_dataflo.VW_Opportunity_Stage: COMMIT
2020-12-30 18:44:10.588924 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-30 18:44:10.588971 (Thread-1): On model.sales_dataflo.VW_Opportunity_Stage: COMMIT
2020-12-30 18:44:10.641171 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:44:10.644121 (Thread-1): finished collecting timing info
2020-12-30 18:44:10.644349 (Thread-1): On model.sales_dataflo.VW_Opportunity_Stage: Close
2020-12-30 18:44:10.715945 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf8500250>]}
2020-12-30 18:44:10.717105 (Thread-1): 18:44:10 | 24 of 30 OK created view model dbt_salesdataflo.VW_Opportunity_Stage. [SUCCESS 1 in 0.90s]
2020-12-30 18:44:10.717202 (Thread-1): Finished running node model.sales_dataflo.VW_Opportunity_Stage
2020-12-30 18:44:10.717305 (Thread-1): Began running node model.sales_dataflo.Fact_Sales_History
2020-12-30 18:44:10.718125 (Thread-1): 18:44:10 | 25 of 30 START table model dbt_salesdataflo.Fact_Sales_History....... [RUN]
2020-12-30 18:44:10.718339 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:10.718412 (Thread-1): Compiling model.sales_dataflo.Fact_Sales_History
2020-12-30 18:44:10.728955 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:10.729040 (Thread-1): On model.sales_dataflo.Fact_Sales_History: BEGIN
2020-12-30 18:44:10.729120 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:11.235198 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-12-30 18:44:11.235349 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:11.235404 (Thread-1): On model.sales_dataflo.Fact_Sales_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:11.267982 (Thread-1447): handling poll request
2020-12-30 18:44:11.268671 (Thread-1447): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d494d910>]}
2020-12-30 18:44:11.273617 (Thread-1447): sending response (<Response 12235 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:44:11.295385 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:11.301536 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:11.301666 (Thread-1): On model.sales_dataflo.Fact_Sales_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:11.363459 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:11.368829 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:11.368938 (Thread-1): On model.sales_dataflo.Fact_Sales_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:11.427785 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:11.432780 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:11.432873 (Thread-1): On model.sales_dataflo.Fact_Sales_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:11.491202 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:11.495091 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:11.495178 (Thread-1): On model.sales_dataflo.Fact_Sales_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:11.547697 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:44:11.551439 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:11.551521 (Thread-1): On model.sales_dataflo.Fact_Sales_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:11.612024 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:11.616027 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:11.616111 (Thread-1): On model.sales_dataflo.Fact_Sales_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:11.688535 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:44:11.693311 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Fact_Sales_History"
2020-12-30 18:44:11.738614 (Thread-1): finished collecting timing info
2020-12-30 18:44:11.743636 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Fact_Sales_History"
2020-12-30 18:44:11.800130 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:11.800243 (Thread-1): On model.sales_dataflo.Fact_Sales_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_History"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Fact_Sales_History  as
      (
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity  Where upper(IS_WON) = 'TRUE' )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('1' as number) as METRIC_ID,
        cast('1' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        sum( Amount  ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type, 'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity  Where upper(IS_WON) = 'FALSE' and upper(IS_CLOSED) = 'TRUE' )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('10' as number) as METRIC_ID,
        cast('1' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        sum( Amount  ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type, 'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead  Where upper(lead_to_opp_flag) = 'TRUE' )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('3' as number) as METRIC_ID,
        cast('4' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type, 'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('4' as number) as METRIC_ID,
        cast('4' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type, 'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity  Where upper(IS_CLOSED) = 'FALSE' )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('23' as number) as METRIC_ID,
        cast('2' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        sum( Amount  ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type, 'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('27' as number) as METRIC_ID,
        cast('5' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type, 'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Contact  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('29' as number) as METRIC_ID,
        cast('6' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type, 'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        
      );
2020-12-30 18:44:12.687955 (Thread-1448): handling poll request
2020-12-30 18:44:12.688406 (Thread-1448): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb2bb80>]}
2020-12-30 18:44:12.691623 (Thread-1448): sending response (<Response 35113 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:44:14.107691 (Thread-1449): handling poll request
2020-12-30 18:44:14.108116 (Thread-1449): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49931c0>]}
2020-12-30 18:44:14.109015 (Thread-1449): sending response (<Response 284 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:44:15.554837 (Thread-1450): handling poll request
2020-12-30 18:44:15.555276 (Thread-1450): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49938e0>]}
2020-12-30 18:44:15.556149 (Thread-1450): sending response (<Response 285 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:44:17.013775 (Thread-1451): handling poll request
2020-12-30 18:44:17.014215 (Thread-1451): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993bb0>]}
2020-12-30 18:44:17.015107 (Thread-1451): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:44:18.447518 (Thread-1452): handling poll request
2020-12-30 18:44:18.447941 (Thread-1452): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993f70>]}
2020-12-30 18:44:18.448795 (Thread-1452): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:44:19.860301 (Thread-1453): handling poll request
2020-12-30 18:44:19.860718 (Thread-1453): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690bb0>]}
2020-12-30 18:44:19.861615 (Thread-1453): sending response (<Response 285 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:44:21.326535 (Thread-1454): handling poll request
2020-12-30 18:44:21.326979 (Thread-1454): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690550>]}
2020-12-30 18:44:21.327843 (Thread-1454): sending response (<Response 285 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:44:22.791679 (Thread-1455): handling poll request
2020-12-30 18:44:22.792091 (Thread-1455): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46908b0>]}
2020-12-30 18:44:22.792961 (Thread-1455): sending response (<Response 285 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:44:24.208235 (Thread-1456): handling poll request
2020-12-30 18:44:24.208673 (Thread-1456): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690b80>]}
2020-12-30 18:44:24.209789 (Thread-1456): sending response (<Response 285 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:44:25.765031 (Thread-1457): handling poll request
2020-12-30 18:44:25.770625 (Thread-1457): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690ee0>]}
2020-12-30 18:44:25.771511 (Thread-1457): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:44:27.195917 (Thread-1458): handling poll request
2020-12-30 18:44:27.196359 (Thread-1458): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690cd0>]}
2020-12-30 18:44:27.197242 (Thread-1458): sending response (<Response 285 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:44:28.613749 (Thread-1459): handling poll request
2020-12-30 18:44:28.614166 (Thread-1459): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993a90>]}
2020-12-30 18:44:28.615036 (Thread-1459): sending response (<Response 285 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:44:30.047846 (Thread-1460): handling poll request
2020-12-30 18:44:30.048264 (Thread-1460): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993c10>]}
2020-12-30 18:44:30.049166 (Thread-1460): sending response (<Response 285 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:44:31.482756 (Thread-1461): handling poll request
2020-12-30 18:44:31.483173 (Thread-1461): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993220>]}
2020-12-30 18:44:31.484073 (Thread-1461): sending response (<Response 284 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:44:32.896301 (Thread-1462): handling poll request
2020-12-30 18:44:32.896719 (Thread-1462): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993ee0>]}
2020-12-30 18:44:32.897612 (Thread-1462): sending response (<Response 285 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:44:34.311300 (Thread-1463): handling poll request
2020-12-30 18:44:34.311745 (Thread-1463): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb2b700>]}
2020-12-30 18:44:34.312629 (Thread-1463): sending response (<Response 285 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:44:34.362956 (Thread-1): SQL status: SUCCESS 1 in 22.56 seconds
2020-12-30 18:44:34.363993 (Thread-1): On model.sales_dataflo.Fact_Sales_History: COMMIT
2020-12-30 18:44:34.364113 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-30 18:44:34.364160 (Thread-1): On model.sales_dataflo.Fact_Sales_History: COMMIT
2020-12-30 18:44:34.430344 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:44:34.432207 (Thread-1): finished collecting timing info
2020-12-30 18:44:34.432414 (Thread-1): On model.sales_dataflo.Fact_Sales_History: Close
2020-12-30 18:44:34.523898 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfaab0fd0>]}
2020-12-30 18:44:34.524994 (Thread-1): 18:44:34 | 25 of 30 OK created table model dbt_salesdataflo.Fact_Sales_History.. [SUCCESS 1 in 23.81s]
2020-12-30 18:44:34.525119 (Thread-1): Finished running node model.sales_dataflo.Fact_Sales_History
2020-12-30 18:44:34.525224 (Thread-1): Began running node model.sales_dataflo.Fact_Sales_Segmented_History
2020-12-30 18:44:34.526047 (Thread-1): 18:44:34 | 26 of 30 START table model dbt_salesdataflo.Fact_Sales_Segmented_History [RUN]
2020-12-30 18:44:34.526282 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:34.526357 (Thread-1): Compiling model.sales_dataflo.Fact_Sales_Segmented_History
2020-12-30 18:44:34.538858 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:34.538932 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: BEGIN
2020-12-30 18:44:34.538991 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:44:35.053451 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-12-30 18:44:35.053591 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.053640 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.116689 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:35.120992 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.121095 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.183107 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:35.187619 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.187705 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.244256 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:35.248152 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.248259 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.306278 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:35.310173 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.310244 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.371828 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:35.375421 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.375497 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.426602 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:44:35.430466 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.430545 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.489938 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:35.493921 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.494003 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.553168 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:35.557000 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.557103 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.609298 (Thread-1): SQL status: SUCCESS 1 in 0.05 seconds
2020-12-30 18:44:35.616435 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.616548 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.675098 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:35.678993 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.679074 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.734512 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:35.738032 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.738104 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:44:35.743862 (Thread-1464): handling poll request
2020-12-30 18:44:35.744268 (Thread-1464): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb2ba60>]}
2020-12-30 18:44:35.749967 (Thread-1464): sending response (<Response 25090 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:44:35.800946 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:44:35.806481 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Fact_Sales_Segmented_History"
2020-12-30 18:44:35.853159 (Thread-1): finished collecting timing info
2020-12-30 18:44:35.857662 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Fact_Sales_Segmented_History"
2020-12-30 18:44:35.935740 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:44:35.935865 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented_History"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Fact_Sales_Segmented_History  as
      (
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity  Where upper(IS_CLOSED) = 'FALSE' )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('5' as number) as METRIC_ID,
        cast('2' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(STAGE_NAME as varchar(1000)) As Segment_name,
        sum( Amount  ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('7' as number) as METRIC_ID,
        cast('3' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(INDUSTRY as varchar(1000)) As Segment_name,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity  Where upper(IS_WON) = 'FALSE' and upper(IS_CLOSED) = 'TRUE' )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('11' as number) as METRIC_ID,
        cast('2' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(EMPLOYEE_ID as varchar(1000)) As Segment_name,
        sum( Amount  ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity  Where upper(IS_WON) = 'FALSE' and upper(IS_CLOSED) = 'TRUE' )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('14' as number) as METRIC_ID,
        cast('1' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(OPPORTUNITY_NAME as varchar(1000)) As Segment_name,
        sum( Amount  ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('18' as number) as METRIC_ID,
        cast('3' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(LEAD_SOURCE as varchar(1000)) As Segment_name,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('19' as number) as METRIC_ID,
        cast('3' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(STATUS as varchar(1000)) As Segment_name,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity  Where upper(IS_WON) = 'TRUE' )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('22' as number) as METRIC_ID,
        cast('1' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(OPPORTUNITY_NAME as varchar(1000)) As Segment_name,
        sum( Amount  ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity  Where upper(IS_CLOSED) = 'FALSE' )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('26' as number) as METRIC_ID,
        cast('1' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(OPPORTUNITY_NAME as varchar(1000)) As Segment_name,
        sum( Amount  ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('28' as number) as METRIC_ID,
        cast('5' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(EMPLOYEE_ID as varchar(1000)) As Segment_name,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('30' as number) as METRIC_ID,
        cast('3' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(EMPLOYEE_ID as varchar(1000)) As Segment_name,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Lead  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('31' as number) as METRIC_ID,
        cast('3' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(LEAD_CONTACT_ADDRESS as varchar(1000)) As Segment_name,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        union all
        
        (
             with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('32' as number) as METRIC_ID,
        cast('2' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        cast(OPPORTUNITY_TYPE as varchar(1000)) As Segment_name,
        sum( Amount  ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_name
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID, Segment_name,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type,'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
        )

        
      );
2020-12-30 18:44:37.207848 (Thread-1465): handling poll request
2020-12-30 18:44:37.208268 (Thread-1465): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb2b340>]}
2020-12-30 18:44:37.209866 (Thread-1465): sending response (<Response 45748 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:44:38.663248 (Thread-1466): handling poll request
2020-12-30 18:44:38.663660 (Thread-1466): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993f40>]}
2020-12-30 18:44:38.664510 (Thread-1466): sending response (<Response 285 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:44:40.085955 (Thread-1467): handling poll request
2020-12-30 18:44:40.086375 (Thread-1467): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49939d0>]}
2020-12-30 18:44:40.087237 (Thread-1467): sending response (<Response 285 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:44:41.619132 (Thread-1468): handling poll request
2020-12-30 18:44:41.619566 (Thread-1468): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993f70>]}
2020-12-30 18:44:41.620432 (Thread-1468): sending response (<Response 285 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:44:44.105301 (Thread-1469): handling poll request
2020-12-30 18:44:44.105738 (Thread-1469): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690040>]}
2020-12-30 18:44:44.106613 (Thread-1469): sending response (<Response 285 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:44:45.515117 (Thread-1470): handling poll request
2020-12-30 18:44:45.515528 (Thread-1470): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690460>]}
2020-12-30 18:44:45.516367 (Thread-1470): sending response (<Response 285 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:44:46.952928 (Thread-1471): handling poll request
2020-12-30 18:44:46.953430 (Thread-1471): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690af0>]}
2020-12-30 18:44:46.954355 (Thread-1471): sending response (<Response 285 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:44:48.383262 (Thread-1472): handling poll request
2020-12-30 18:44:48.383681 (Thread-1472): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46bedf0>]}
2020-12-30 18:44:48.384542 (Thread-1472): sending response (<Response 285 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:44:49.835282 (Thread-1473): handling poll request
2020-12-30 18:44:49.835694 (Thread-1473): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46be850>]}
2020-12-30 18:44:49.941704 (Thread-1473): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:44:51.413797 (Thread-1474): handling poll request
2020-12-30 18:44:51.414231 (Thread-1474): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46daac0>]}
2020-12-30 18:44:51.415136 (Thread-1474): sending response (<Response 285 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:44:52.828320 (Thread-1475): handling poll request
2020-12-30 18:44:52.828730 (Thread-1475): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690ca0>]}
2020-12-30 18:44:52.829628 (Thread-1475): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:44:54.243680 (Thread-1476): handling poll request
2020-12-30 18:44:54.244093 (Thread-1476): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690670>]}
2020-12-30 18:44:54.244984 (Thread-1476): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:44:55.722756 (Thread-1477): handling poll request
2020-12-30 18:44:55.723172 (Thread-1477): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690040>]}
2020-12-30 18:44:55.724037 (Thread-1477): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:44:57.142892 (Thread-1478): handling poll request
2020-12-30 18:44:57.143316 (Thread-1478): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48bbb50>]}
2020-12-30 18:44:57.144215 (Thread-1478): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:44:58.594168 (Thread-1479): handling poll request
2020-12-30 18:44:58.594631 (Thread-1479): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46be0a0>]}
2020-12-30 18:44:58.595568 (Thread-1479): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:45:00.017124 (Thread-1480): handling poll request
2020-12-30 18:45:00.017537 (Thread-1480): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46be340>]}
2020-12-30 18:45:00.018404 (Thread-1480): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:45:01.447042 (Thread-1481): handling poll request
2020-12-30 18:45:01.447462 (Thread-1481): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46be2b0>]}
2020-12-30 18:45:01.448394 (Thread-1481): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:45:02.882159 (Thread-1482): handling poll request
2020-12-30 18:45:02.882578 (Thread-1482): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46beb20>]}
2020-12-30 18:45:02.883451 (Thread-1482): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:45:04.323117 (Thread-1483): handling poll request
2020-12-30 18:45:04.323536 (Thread-1483): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46becd0>]}
2020-12-30 18:45:04.324533 (Thread-1483): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:45:05.731087 (Thread-1484): handling poll request
2020-12-30 18:45:05.731495 (Thread-1484): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4800760>]}
2020-12-30 18:45:05.732347 (Thread-1484): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:45:07.257906 (Thread-1485): handling poll request
2020-12-30 18:45:07.258334 (Thread-1485): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48004c0>]}
2020-12-30 18:45:07.259195 (Thread-1485): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:45:08.837688 (Thread-1486): handling poll request
2020-12-30 18:45:08.838111 (Thread-1486): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4800940>]}
2020-12-30 18:45:08.838979 (Thread-1486): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:45:10.285288 (Thread-1487): handling poll request
2020-12-30 18:45:10.285825 (Thread-1487): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4800040>]}
2020-12-30 18:45:10.287062 (Thread-1487): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:45:11.728248 (Thread-1488): handling poll request
2020-12-30 18:45:11.728681 (Thread-1488): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4800640>]}
2020-12-30 18:45:11.729603 (Thread-1488): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:45:13.012738 (Thread-1): SQL status: SUCCESS 1 in 37.08 seconds
2020-12-30 18:45:13.013736 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: COMMIT
2020-12-30 18:45:13.013855 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-30 18:45:13.013903 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: COMMIT
2020-12-30 18:45:13.075385 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:45:13.078164 (Thread-1): finished collecting timing info
2020-12-30 18:45:13.078475 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented_History: Close
2020-12-30 18:45:13.158808 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfadc7520>]}
2020-12-30 18:45:13.160402 (Thread-1): 18:45:13 | 26 of 30 OK created table model dbt_salesdataflo.Fact_Sales_Segmented_History [SUCCESS 1 in 38.63s]
2020-12-30 18:45:13.160535 (Thread-1): Finished running node model.sales_dataflo.Fact_Sales_Segmented_History
2020-12-30 18:45:13.160688 (Thread-1): Began running node model.sales_dataflo.VW_TimeFrame
2020-12-30 18:45:13.161945 (Thread-1): 18:45:13 | 27 of 30 START view model dbt_salesdataflo.VW_TimeFrame.............. [RUN]
2020-12-30 18:45:13.162272 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-30 18:45:13.162383 (Thread-1): Compiling model.sales_dataflo.VW_TimeFrame
2020-12-30 18:45:13.173845 (Thread-1): Writing injected SQL for node "model.sales_dataflo.VW_TimeFrame"
2020-12-30 18:45:13.202095 (Thread-1489): handling poll request
2020-12-30 18:45:13.202522 (Thread-1489): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb2bfd0>]}
2020-12-30 18:45:13.204969 (Thread-1489): sending response (<Response 6321 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:45:13.204267 (Thread-1): finished collecting timing info
2020-12-30 18:45:13.209394 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.VW_TimeFrame"
2020-12-30 18:45:13.236105 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-30 18:45:13.236207 (Thread-1): On model.sales_dataflo.VW_TimeFrame: BEGIN
2020-12-30 18:45:13.236270 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:45:13.797215 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2020-12-30 18:45:13.797362 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-30 18:45:13.797412 (Thread-1): On model.sales_dataflo.VW_TimeFrame: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.VW_TimeFrame"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.VW_TimeFrame  as (
    SELECT * FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame
  );
2020-12-30 18:45:14.050586 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-12-30 18:45:14.051549 (Thread-1): On model.sales_dataflo.VW_TimeFrame: COMMIT
2020-12-30 18:45:14.051672 (Thread-1): Using snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-30 18:45:14.051719 (Thread-1): On model.sales_dataflo.VW_TimeFrame: COMMIT
2020-12-30 18:45:14.112151 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:45:14.116823 (Thread-1): finished collecting timing info
2020-12-30 18:45:14.117159 (Thread-1): On model.sales_dataflo.VW_TimeFrame: Close
2020-12-30 18:45:14.186981 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfae6dbb0>]}
2020-12-30 18:45:14.188764 (Thread-1): 18:45:14 | 27 of 30 OK created view model dbt_salesdataflo.VW_TimeFrame......... [SUCCESS 1 in 1.02s]
2020-12-30 18:45:14.188916 (Thread-1): Finished running node model.sales_dataflo.VW_TimeFrame
2020-12-30 18:45:14.189100 (Thread-1): Began running node model.sales_dataflo.test_metrics
2020-12-30 18:45:14.190451 (Thread-1): 18:45:14 | 28 of 30 START view model dbt_salesdataflo.test_metrics.............. [RUN]
2020-12-30 18:45:14.190773 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test_metrics".
2020-12-30 18:45:14.190883 (Thread-1): Compiling model.sales_dataflo.test_metrics
2020-12-30 18:45:14.199263 (Thread-1): Using snowflake connection "model.sales_dataflo.test_metrics".
2020-12-30 18:45:14.199335 (Thread-1): On model.sales_dataflo.test_metrics: BEGIN
2020-12-30 18:45:14.199393 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:45:14.552839 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2020-12-30 18:45:14.552981 (Thread-1): Using snowflake connection "model.sales_dataflo.test_metrics".
2020-12-30 18:45:14.553029 (Thread-1): On model.sales_dataflo.test_metrics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.test_metrics"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:45:14.610748 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:45:14.615185 (Thread-1): Writing injected SQL for node "model.sales_dataflo.test_metrics"
2020-12-30 18:45:14.627501 (Thread-1490): handling poll request
2020-12-30 18:45:14.626935 (Thread-1): finished collecting timing info
2020-12-30 18:45:14.628119 (Thread-1490): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46be850>]}
2020-12-30 18:45:14.631452 (Thread-1490): sending response (<Response 12332 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:45:14.631996 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.test_metrics"
2020-12-30 18:45:14.647503 (Thread-1): Using snowflake connection "model.sales_dataflo.test_metrics".
2020-12-30 18:45:14.647595 (Thread-1): On model.sales_dataflo.test_metrics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.test_metrics"} */

  create or replace  view DATAFLOTEST_DATABASE.dbt_salesdataflo.test_metrics  as (
    with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ), 
Emp AS
( SELECT source_Emp_id as Emp_id, Entity_id as Emp_Entity_id , TimeFrameID join_Date FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee  
cross join timeframe
),

 Source AS
   ( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Account  Where 1 = 1 )
 
,Metrics_Calc AS(
    SELECT
        TimeFrameID AS Report_Dt,
        Emp_Entity_id  AS entity_code,
        Emp_id AS employee_code,
        cast('27' as number) as METRIC_ID,
        cast('5' as number)  AS METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        sum( 0   ) as AMOUNT,
        count(INITIAL_CREATE_DT)  as Count
     from Emp 
          join timeframe 
          on join_Date = TimeFrameID
          left join Source 
          on Emp.Emp_id = source.employee_id
          and cast( INITIAL_CREATE_DT as date) between timeframe.Day_START and timeframe.Day_END 
          join date_range
          on TimeFrameID = date_range.date_day
         group by
        Report_Dt,
        entity_code,
        employee_code,
        METRIC_ID,
        METRIC_CATEGORY_ID
        )
 SELECT Report_Dt, entity_code, employee_code,METRIC_ID,METRIC_CATEGORY_ID,nvl(amount,0) as Amount, count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average , 'D' TimeFrame_Type, 'D_SALES_FACT_LOAD' AS DW_SESSION_NM,
        
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS from Metrics_Calc
      order by Report_Dt, METRIC_ID, TimeFrame_Type
  );
2020-12-30 18:45:15.114280 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2020-12-30 18:45:15.115751 (Thread-1): On model.sales_dataflo.test_metrics: COMMIT
2020-12-30 18:45:15.115928 (Thread-1): Using snowflake connection "model.sales_dataflo.test_metrics".
2020-12-30 18:45:15.116010 (Thread-1): On model.sales_dataflo.test_metrics: COMMIT
2020-12-30 18:45:15.171960 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:45:15.176872 (Thread-1): finished collecting timing info
2020-12-30 18:45:15.177412 (Thread-1): On model.sales_dataflo.test_metrics: Close
2020-12-30 18:45:15.241238 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfae28700>]}
2020-12-30 18:45:15.242245 (Thread-1): 18:45:15 | 28 of 30 OK created view model dbt_salesdataflo.test_metrics......... [SUCCESS 1 in 1.05s]
2020-12-30 18:45:15.242332 (Thread-1): Finished running node model.sales_dataflo.test_metrics
2020-12-30 18:45:15.242436 (Thread-1): Began running node model.sales_dataflo.Fact_Sales
2020-12-30 18:45:15.243212 (Thread-1): 18:45:15 | 29 of 30 START table model dbt_salesdataflo.Fact_Sales............... [RUN]
2020-12-30 18:45:15.243418 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales".
2020-12-30 18:45:15.243489 (Thread-1): Compiling model.sales_dataflo.Fact_Sales
2020-12-30 18:45:15.251115 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales".
2020-12-30 18:45:15.251186 (Thread-1): On model.sales_dataflo.Fact_Sales: BEGIN
2020-12-30 18:45:15.251244 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:45:15.721495 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2020-12-30 18:45:15.721636 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales".
2020-12-30 18:45:15.721684 (Thread-1): On model.sales_dataflo.Fact_Sales: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:45:15.778616 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:45:15.782115 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Fact_Sales"
2020-12-30 18:45:15.818335 (Thread-1): finished collecting timing info
2020-12-30 18:45:15.826495 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Fact_Sales"
2020-12-30 18:45:15.867152 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales".
2020-12-30 18:45:15.867283 (Thread-1): On model.sales_dataflo.Fact_Sales: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Fact_Sales  as
      (

with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ),  
Source AS
( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Fact_Sales_History
),
Metrics_Calc AS(
    SELECT
        TimeFrameID as Report_Date,
        entity_code  AS entity_id,
        employee_code AS employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        'D' as TimeFrame_Type,
        sum(AMOUNT) as AMOUNT,
        sum(count) as COUNT,  
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
    from Source 
        join timeframe 
        on Report_Dt between timeframe.DAY_START and timeframe.DAY_END
        join date_range
        on TimeFrameID = date_range.date_day
    group by
        Report_Date,
        entity_id,
        employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        TimeFrame_Type,
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
     Union
        SELECT
        TimeFrameID as Report_Date,
        entity_code  AS entity_id,
        employee_code AS employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        'W' as TimeFrame_Type,
        sum(AMOUNT) as AMOUNT,
        sum(count) as COUNT,  
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
    from Source 
        join timeframe 
        on Report_Dt between timeframe.WEEK_START and timeframe.WEEK_END
        and Report_Dt <= TimeFrameID
        join date_range
        on TimeFrameID = date_range.date_day        
    group by
        Report_Date,
        entity_id,
        employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        TimeFrame_Type,
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
     Union
        SELECT
        TimeFrameID as Report_Date,
        entity_code  AS entity_id,
        employee_code AS employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        'M' as TimeFrame_Type,
        sum(AMOUNT) as AMOUNT,
        sum(count) as COUNT,  
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
    from Source 
        join timeframe 
        on Report_Dt between timeframe.MONTH_START and timeframe.MONTH_END
        and Report_Dt <= TimeFrameID
        join date_range
        on TimeFrameID = date_range.date_day        
    group by
        Report_Date,
        entity_id,
        employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        TimeFrame_Type,
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
     Union
        SELECT
        TimeFrameID as Report_Date,
        entity_code  AS entity_id,
        employee_code AS employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        'Q' as TimeFrame_Type,
        sum(AMOUNT) as AMOUNT,
        sum(count) as COUNT,  
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
    from Source 
        join timeframe 
        on Report_Dt between timeframe.QUARTER_START and timeframe.QUARTER_END
        and Report_Dt <= TimeFrameID
        join date_range
        on TimeFrameID = date_range.date_day        
    group by
        Report_Date,
        entity_id,
        employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        TimeFrame_Type,
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
     Union
        SELECT
        TimeFrameID as Report_Date,
        entity_code  AS entity_id,
        employee_code AS employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        'Y' as TimeFrame_Type,
        sum(AMOUNT) as AMOUNT,
        sum(count) as COUNT,  
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
    from Source 
        join timeframe 
        on Report_Dt between timeframe.YEAR_START and timeframe.YEAR_END
        and Report_Dt <= TimeFrameID
        join date_range
        on TimeFrameID = date_range.date_day        
    group by
        Report_Date,
        entity_id,
        employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        TimeFrame_Type,
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS                        
 )
 
SELECT Report_Date, entity_id, employee_id, METRIC_ID, METRIC_CATEGORY_ID, TimeFrame_Type, AMOUNT, Count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average,  DW_SESSION_NM, DW_INS_UPD_DTS from Metrics_Calc
order by Report_Date, METRIC_ID, TimeFrame_Type
      );
2020-12-30 18:45:16.100182 (Thread-1491): handling poll request
2020-12-30 18:45:16.100644 (Thread-1491): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48e9820>]}
2020-12-30 18:45:16.103828 (Thread-1491): sending response (<Response 21321 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:45:17.535669 (Thread-1492): handling poll request
2020-12-30 18:45:17.536087 (Thread-1492): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ed00>]}
2020-12-30 18:45:17.536935 (Thread-1492): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:45:18.980570 (Thread-1493): handling poll request
2020-12-30 18:45:18.981021 (Thread-1493): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e280>]}
2020-12-30 18:45:18.981880 (Thread-1493): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:45:20.417263 (Thread-1494): handling poll request
2020-12-30 18:45:20.417682 (Thread-1494): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403d7c0>]}
2020-12-30 18:45:20.418735 (Thread-1494): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:45:21.833258 (Thread-1495): handling poll request
2020-12-30 18:45:21.833675 (Thread-1495): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb2ba60>]}
2020-12-30 18:45:21.834523 (Thread-1495): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:45:23.278921 (Thread-1496): handling poll request
2020-12-30 18:45:23.279448 (Thread-1496): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dae20>]}
2020-12-30 18:45:23.280320 (Thread-1496): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:45:24.793226 (Thread-1497): handling poll request
2020-12-30 18:45:24.793661 (Thread-1497): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48e9190>]}
2020-12-30 18:45:24.794609 (Thread-1497): sending response (<Response 285 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:45:26.229809 (Thread-1498): handling poll request
2020-12-30 18:45:26.230250 (Thread-1498): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690f40>]}
2020-12-30 18:45:26.231134 (Thread-1498): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:45:27.664264 (Thread-1499): handling poll request
2020-12-30 18:45:27.664844 (Thread-1499): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46be1c0>]}
2020-12-30 18:45:27.666062 (Thread-1499): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:45:29.235005 (Thread-1500): handling poll request
2020-12-30 18:45:29.235430 (Thread-1500): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4800c40>]}
2020-12-30 18:45:29.236360 (Thread-1500): sending response (<Response 285 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:45:30.701283 (Thread-1501): handling poll request
2020-12-30 18:45:30.701713 (Thread-1501): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403d100>]}
2020-12-30 18:45:30.702585 (Thread-1501): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:45:32.132211 (Thread-1502): handling poll request
2020-12-30 18:45:32.132785 (Thread-1502): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403dd00>]}
2020-12-30 18:45:32.134045 (Thread-1502): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:45:33.580135 (Thread-1503): handling poll request
2020-12-30 18:45:33.580558 (Thread-1503): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ddc0>]}
2020-12-30 18:45:33.712797 (Thread-1503): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:45:35.122039 (Thread-1504): handling poll request
2020-12-30 18:45:35.122656 (Thread-1504): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052b20>]}
2020-12-30 18:45:35.123715 (Thread-1504): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:45:36.575367 (Thread-1505): handling poll request
2020-12-30 18:45:36.575803 (Thread-1505): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4020940>]}
2020-12-30 18:45:36.576729 (Thread-1505): sending response (<Response 285 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:45:37.988551 (Thread-1506): handling poll request
2020-12-30 18:45:37.988982 (Thread-1506): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562be0>]}
2020-12-30 18:45:37.989912 (Thread-1506): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:45:39.423711 (Thread-1507): handling poll request
2020-12-30 18:45:39.424260 (Thread-1507): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562370>]}
2020-12-30 18:45:39.425494 (Thread-1507): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:45:40.872725 (Thread-1508): handling poll request
2020-12-30 18:45:40.873180 (Thread-1508): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45626d0>]}
2020-12-30 18:45:40.874078 (Thread-1508): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:45:42.347228 (Thread-1509): handling poll request
2020-12-30 18:45:42.347672 (Thread-1509): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45628e0>]}
2020-12-30 18:45:42.348547 (Thread-1509): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:45:43.798786 (Thread-1510): handling poll request
2020-12-30 18:45:43.799204 (Thread-1510): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ee20>]}
2020-12-30 18:45:43.800058 (Thread-1510): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:45:45.253091 (Thread-1511): handling poll request
2020-12-30 18:45:45.253550 (Thread-1511): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e0a0>]}
2020-12-30 18:45:45.254494 (Thread-1511): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:45:46.751989 (Thread-1512): handling poll request
2020-12-30 18:45:46.752410 (Thread-1512): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e220>]}
2020-12-30 18:45:46.753305 (Thread-1512): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:45:48.202776 (Thread-1513): handling poll request
2020-12-30 18:45:48.203203 (Thread-1513): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff29a0>]}
2020-12-30 18:45:48.204072 (Thread-1513): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:45:49.694347 (Thread-1514): handling poll request
2020-12-30 18:45:49.694775 (Thread-1514): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2e80>]}
2020-12-30 18:45:49.695641 (Thread-1514): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:45:51.166202 (Thread-1515): handling poll request
2020-12-30 18:45:51.166637 (Thread-1515): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff23a0>]}
2020-12-30 18:45:51.167496 (Thread-1515): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:45:52.570458 (Thread-1516): handling poll request
2020-12-30 18:45:52.571076 (Thread-1516): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2880>]}
2020-12-30 18:45:52.571994 (Thread-1516): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:45:54.033982 (Thread-1517): handling poll request
2020-12-30 18:45:54.034398 (Thread-1517): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da1f0>]}
2020-12-30 18:45:54.035637 (Thread-1517): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:45:55.581357 (Thread-1518): handling poll request
2020-12-30 18:45:55.581800 (Thread-1518): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2220>]}
2020-12-30 18:45:55.582657 (Thread-1518): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:45:57.073584 (Thread-1519): handling poll request
2020-12-30 18:45:57.074014 (Thread-1519): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2f40>]}
2020-12-30 18:45:57.074912 (Thread-1519): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:45:58.546814 (Thread-1520): handling poll request
2020-12-30 18:45:58.547247 (Thread-1520): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e280>]}
2020-12-30 18:45:58.548132 (Thread-1520): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:46:00.164836 (Thread-1521): handling poll request
2020-12-30 18:46:00.165280 (Thread-1521): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e520>]}
2020-12-30 18:46:00.166134 (Thread-1521): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:46:01.670417 (Thread-1522): handling poll request
2020-12-30 18:46:01.670875 (Thread-1522): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ea60>]}
2020-12-30 18:46:01.671734 (Thread-1522): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:46:03.160473 (Thread-1523): handling poll request
2020-12-30 18:46:03.160892 (Thread-1523): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45622e0>]}
2020-12-30 18:46:03.161825 (Thread-1523): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:46:04.597649 (Thread-1524): handling poll request
2020-12-30 18:46:04.598214 (Thread-1524): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562bb0>]}
2020-12-30 18:46:04.599430 (Thread-1524): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:46:06.057760 (Thread-1525): handling poll request
2020-12-30 18:46:06.058173 (Thread-1525): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562fa0>]}
2020-12-30 18:46:06.059035 (Thread-1525): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:46:07.504536 (Thread-1526): handling poll request
2020-12-30 18:46:07.505195 (Thread-1526): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562730>]}
2020-12-30 18:46:07.506515 (Thread-1526): sending response (<Response 285 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:46:08.957448 (Thread-1527): handling poll request
2020-12-30 18:46:08.957907 (Thread-1527): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4020ca0>]}
2020-12-30 18:46:08.958863 (Thread-1527): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:46:10.387872 (Thread-1528): handling poll request
2020-12-30 18:46:10.388293 (Thread-1528): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4020880>]}
2020-12-30 18:46:10.389235 (Thread-1528): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:46:11.806684 (Thread-1529): handling poll request
2020-12-30 18:46:11.807146 (Thread-1529): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb3b160>]}
2020-12-30 18:46:11.808373 (Thread-1529): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:46:13.277218 (Thread-1530): handling poll request
2020-12-30 18:46:13.277633 (Thread-1530): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052220>]}
2020-12-30 18:46:13.278481 (Thread-1530): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:46:14.710837 (Thread-1531): handling poll request
2020-12-30 18:46:14.711255 (Thread-1531): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da0a0>]}
2020-12-30 18:46:14.712366 (Thread-1531): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:46:16.148904 (Thread-1532): handling poll request
2020-12-30 18:46:16.149368 (Thread-1532): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45e1be0>]}
2020-12-30 18:46:16.150277 (Thread-1532): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:46:17.598158 (Thread-1533): handling poll request
2020-12-30 18:46:17.598578 (Thread-1533): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46bebe0>]}
2020-12-30 18:46:17.706307 (Thread-1533): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:46:19.148519 (Thread-1534): handling poll request
2020-12-30 18:46:19.148942 (Thread-1534): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025580>]}
2020-12-30 18:46:19.149851 (Thread-1534): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:46:20.605691 (Thread-1535): handling poll request
2020-12-30 18:46:20.606119 (Thread-1535): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562880>]}
2020-12-30 18:46:20.606973 (Thread-1535): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:46:22.078220 (Thread-1536): handling poll request
2020-12-30 18:46:22.078632 (Thread-1536): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562ee0>]}
2020-12-30 18:46:22.079486 (Thread-1536): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:46:23.519336 (Thread-1537): handling poll request
2020-12-30 18:46:23.519757 (Thread-1537): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562f10>]}
2020-12-30 18:46:23.520631 (Thread-1537): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:46:24.961247 (Thread-1538): handling poll request
2020-12-30 18:46:24.961681 (Thread-1538): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ea00>]}
2020-12-30 18:46:24.962591 (Thread-1538): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:46:26.443174 (Thread-1539): handling poll request
2020-12-30 18:46:26.443625 (Thread-1539): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ea60>]}
2020-12-30 18:46:26.444538 (Thread-1539): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:46:27.853810 (Thread-1540): handling poll request
2020-12-30 18:46:27.854278 (Thread-1540): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ec40>]}
2020-12-30 18:46:27.855175 (Thread-1540): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:46:29.333104 (Thread-1541): handling poll request
2020-12-30 18:46:29.333522 (Thread-1541): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993bb0>]}
2020-12-30 18:46:29.334362 (Thread-1541): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:46:30.863746 (Thread-1542): handling poll request
2020-12-30 18:46:30.864171 (Thread-1542): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993790>]}
2020-12-30 18:46:30.865098 (Thread-1542): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:46:32.285683 (Thread-1543): handling poll request
2020-12-30 18:46:32.286233 (Thread-1543): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993e50>]}
2020-12-30 18:46:32.287386 (Thread-1543): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:46:33.725472 (Thread-1544): handling poll request
2020-12-30 18:46:33.725890 (Thread-1544): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49932e0>]}
2020-12-30 18:46:33.726782 (Thread-1544): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:46:35.192910 (Thread-1545): handling poll request
2020-12-30 18:46:35.193377 (Thread-1545): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49932b0>]}
2020-12-30 18:46:35.194260 (Thread-1545): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:46:36.705566 (Thread-1546): handling poll request
2020-12-30 18:46:36.705996 (Thread-1546): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690df0>]}
2020-12-30 18:46:36.706907 (Thread-1546): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:46:38.131334 (Thread-1547): handling poll request
2020-12-30 18:46:38.131789 (Thread-1547): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562100>]}
2020-12-30 18:46:38.132682 (Thread-1547): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:46:39.767273 (Thread-1548): handling poll request
2020-12-30 18:46:39.767700 (Thread-1548): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562520>]}
2020-12-30 18:46:39.768606 (Thread-1548): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:46:41.217452 (Thread-1549): handling poll request
2020-12-30 18:46:41.217891 (Thread-1549): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562e80>]}
2020-12-30 18:46:41.218794 (Thread-1549): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:46:42.720555 (Thread-1550): handling poll request
2020-12-30 18:46:42.720978 (Thread-1550): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562e50>]}
2020-12-30 18:46:42.721878 (Thread-1550): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:46:44.172723 (Thread-1551): handling poll request
2020-12-30 18:46:44.173206 (Thread-1551): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e5e0>]}
2020-12-30 18:46:44.174105 (Thread-1551): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:46:45.614856 (Thread-1552): handling poll request
2020-12-30 18:46:45.615268 (Thread-1552): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e6a0>]}
2020-12-30 18:46:45.616142 (Thread-1552): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:46:47.041239 (Thread-1553): handling poll request
2020-12-30 18:46:47.041650 (Thread-1553): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ec40>]}
2020-12-30 18:46:47.042529 (Thread-1553): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:46:48.466828 (Thread-1554): handling poll request
2020-12-30 18:46:48.467246 (Thread-1554): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46beb20>]}
2020-12-30 18:46:48.468099 (Thread-1554): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:46:49.885563 (Thread-1555): handling poll request
2020-12-30 18:46:49.886018 (Thread-1555): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40257c0>]}
2020-12-30 18:46:49.886871 (Thread-1555): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:46:51.332459 (Thread-1556): handling poll request
2020-12-30 18:46:51.332873 (Thread-1556): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025100>]}
2020-12-30 18:46:51.333853 (Thread-1556): sending response (<Response 284 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:46:52.796118 (Thread-1557): handling poll request
2020-12-30 18:46:52.796547 (Thread-1557): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025a60>]}
2020-12-30 18:46:52.797456 (Thread-1557): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:46:54.227860 (Thread-1558): handling poll request
2020-12-30 18:46:54.228287 (Thread-1558): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025280>]}
2020-12-30 18:46:54.229912 (Thread-1558): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:46:55.670564 (Thread-1559): handling poll request
2020-12-30 18:46:55.671006 (Thread-1559): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45e1df0>]}
2020-12-30 18:46:55.671933 (Thread-1559): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:46:57.215810 (Thread-1560): handling poll request
2020-12-30 18:46:57.216238 (Thread-1560): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993370>]}
2020-12-30 18:46:57.217161 (Thread-1560): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:46:58.678204 (Thread-1561): handling poll request
2020-12-30 18:46:58.678626 (Thread-1561): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40257c0>]}
2020-12-30 18:46:58.679538 (Thread-1561): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:47:00.137687 (Thread-1562): handling poll request
2020-12-30 18:47:00.138269 (Thread-1562): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025040>]}
2020-12-30 18:47:00.139491 (Thread-1562): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:47:01.578121 (Thread-1563): handling poll request
2020-12-30 18:47:01.578540 (Thread-1563): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40201c0>]}
2020-12-30 18:47:01.683896 (Thread-1563): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:47:03.149633 (Thread-1564): handling poll request
2020-12-30 18:47:03.150088 (Thread-1564): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562d60>]}
2020-12-30 18:47:03.151057 (Thread-1564): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:47:04.581690 (Thread-1565): handling poll request
2020-12-30 18:47:04.582113 (Thread-1565): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403dbe0>]}
2020-12-30 18:47:04.582977 (Thread-1565): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:47:06.031124 (Thread-1566): handling poll request
2020-12-30 18:47:06.031552 (Thread-1566): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403d5e0>]}
2020-12-30 18:47:06.032460 (Thread-1566): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:47:07.500543 (Thread-1567): handling poll request
2020-12-30 18:47:07.501034 (Thread-1567): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403dfa0>]}
2020-12-30 18:47:07.501942 (Thread-1567): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:47:09.002903 (Thread-1568): handling poll request
2020-12-30 18:47:09.003323 (Thread-1568): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052280>]}
2020-12-30 18:47:09.004187 (Thread-1568): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:47:10.439688 (Thread-1569): handling poll request
2020-12-30 18:47:10.440130 (Thread-1569): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052520>]}
2020-12-30 18:47:10.441013 (Thread-1569): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:47:11.851318 (Thread-1570): handling poll request
2020-12-30 18:47:11.851809 (Thread-1570): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052400>]}
2020-12-30 18:47:11.852802 (Thread-1570): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:47:13.285094 (Thread-1571): handling poll request
2020-12-30 18:47:13.285548 (Thread-1571): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48bb7f0>]}
2020-12-30 18:47:13.286416 (Thread-1571): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:47:14.725804 (Thread-1572): handling poll request
2020-12-30 18:47:14.726234 (Thread-1572): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46906a0>]}
2020-12-30 18:47:14.727138 (Thread-1572): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:47:16.177178 (Thread-1573): handling poll request
2020-12-30 18:47:16.177644 (Thread-1573): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690220>]}
2020-12-30 18:47:16.178496 (Thread-1573): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:47:17.628568 (Thread-1574): handling poll request
2020-12-30 18:47:17.628986 (Thread-1574): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e2e0>]}
2020-12-30 18:47:17.629884 (Thread-1574): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:47:19.062182 (Thread-1575): handling poll request
2020-12-30 18:47:19.062625 (Thread-1575): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e100>]}
2020-12-30 18:47:19.063514 (Thread-1575): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:47:20.719689 (Thread-1576): handling poll request
2020-12-30 18:47:20.720103 (Thread-1576): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403eb20>]}
2020-12-30 18:47:20.720958 (Thread-1576): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:47:22.164023 (Thread-1577): handling poll request
2020-12-30 18:47:22.164536 (Thread-1577): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993a90>]}
2020-12-30 18:47:22.165999 (Thread-1577): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:47:23.625516 (Thread-1578): handling poll request
2020-12-30 18:47:23.625957 (Thread-1578): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ea00>]}
2020-12-30 18:47:23.627087 (Thread-1578): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:47:25.099552 (Thread-1579): handling poll request
2020-12-30 18:47:25.099967 (Thread-1579): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690310>]}
2020-12-30 18:47:25.100844 (Thread-1579): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:47:26.576504 (Thread-1580): handling poll request
2020-12-30 18:47:26.576930 (Thread-1580): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48bb880>]}
2020-12-30 18:47:26.577831 (Thread-1580): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:47:27.988781 (Thread-1581): handling poll request
2020-12-30 18:47:27.989296 (Thread-1581): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403eee0>]}
2020-12-30 18:47:27.990210 (Thread-1581): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:47:29.415566 (Thread-1582): handling poll request
2020-12-30 18:47:29.416040 (Thread-1582): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e9a0>]}
2020-12-30 18:47:29.416916 (Thread-1582): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:47:30.821885 (Thread-1583): handling poll request
2020-12-30 18:47:30.822313 (Thread-1583): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40521c0>]}
2020-12-30 18:47:30.823182 (Thread-1583): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:47:32.244166 (Thread-1584): handling poll request
2020-12-30 18:47:32.244613 (Thread-1584): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403dd60>]}
2020-12-30 18:47:32.245528 (Thread-1584): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:47:33.682536 (Thread-1585): handling poll request
2020-12-30 18:47:33.682959 (Thread-1585): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403dac0>]}
2020-12-30 18:47:33.683884 (Thread-1585): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:47:35.133304 (Thread-1586): handling poll request
2020-12-30 18:47:35.133718 (Thread-1586): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403d340>]}
2020-12-30 18:47:35.134558 (Thread-1586): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:47:36.564820 (Thread-1587): handling poll request
2020-12-30 18:47:36.565294 (Thread-1587): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403d7c0>]}
2020-12-30 18:47:36.566160 (Thread-1587): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:47:38.036160 (Thread-1588): handling poll request
2020-12-30 18:47:38.036589 (Thread-1588): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45622e0>]}
2020-12-30 18:47:38.037512 (Thread-1588): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:47:39.574373 (Thread-1589): handling poll request
2020-12-30 18:47:39.574819 (Thread-1589): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562400>]}
2020-12-30 18:47:39.575707 (Thread-1589): sending response (<Response 285 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:47:41.027667 (Thread-1590): handling poll request
2020-12-30 18:47:41.028111 (Thread-1590): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562ee0>]}
2020-12-30 18:47:41.028983 (Thread-1590): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:47:42.509956 (Thread-1591): handling poll request
2020-12-30 18:47:42.510368 (Thread-1591): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49932b0>]}
2020-12-30 18:47:42.511491 (Thread-1591): sending response (<Response 285 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:47:43.958952 (Thread-1592): handling poll request
2020-12-30 18:47:43.959525 (Thread-1592): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562a00>]}
2020-12-30 18:47:43.960747 (Thread-1592): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:47:45.390868 (Thread-1593): handling poll request
2020-12-30 18:47:45.391292 (Thread-1593): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403d040>]}
2020-12-30 18:47:45.496528 (Thread-1593): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:47:46.933677 (Thread-1594): handling poll request
2020-12-30 18:47:46.934127 (Thread-1594): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4020880>]}
2020-12-30 18:47:46.935033 (Thread-1594): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:47:48.371347 (Thread-1595): handling poll request
2020-12-30 18:47:48.371770 (Thread-1595): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403d460>]}
2020-12-30 18:47:48.372627 (Thread-1595): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:47:49.835406 (Thread-1596): handling poll request
2020-12-30 18:47:49.835886 (Thread-1596): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052820>]}
2020-12-30 18:47:49.836780 (Thread-1596): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:47:51.273478 (Thread-1597): handling poll request
2020-12-30 18:47:51.273903 (Thread-1597): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052940>]}
2020-12-30 18:47:51.274780 (Thread-1597): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:47:52.719929 (Thread-1598): handling poll request
2020-12-30 18:47:52.720361 (Thread-1598): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40527c0>]}
2020-12-30 18:47:52.721277 (Thread-1598): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:47:54.184095 (Thread-1599): handling poll request
2020-12-30 18:47:54.184516 (Thread-1599): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052880>]}
2020-12-30 18:47:54.185424 (Thread-1599): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:47:55.624375 (Thread-1600): handling poll request
2020-12-30 18:47:55.624805 (Thread-1600): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48004c0>]}
2020-12-30 18:47:55.625704 (Thread-1600): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:47:57.046677 (Thread-1601): handling poll request
2020-12-30 18:47:57.047112 (Thread-1601): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690cd0>]}
2020-12-30 18:47:57.048001 (Thread-1601): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:47:58.497791 (Thread-1602): handling poll request
2020-12-30 18:47:58.498250 (Thread-1602): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690790>]}
2020-12-30 18:47:58.499111 (Thread-1602): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:47:59.946641 (Thread-1603): handling poll request
2020-12-30 18:47:59.947062 (Thread-1603): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da4c0>]}
2020-12-30 18:47:59.947908 (Thread-1603): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:48:01.396738 (Thread-1604): handling poll request
2020-12-30 18:48:01.397186 (Thread-1604): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da910>]}
2020-12-30 18:48:01.398067 (Thread-1604): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:48:03.091460 (Thread-1605): handling poll request
2020-12-30 18:48:03.091888 (Thread-1605): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4800220>]}
2020-12-30 18:48:03.092792 (Thread-1605): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:48:04.526464 (Thread-1606): handling poll request
2020-12-30 18:48:04.526883 (Thread-1606): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48004c0>]}
2020-12-30 18:48:04.527761 (Thread-1606): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:48:05.992153 (Thread-1607): handling poll request
2020-12-30 18:48:05.992586 (Thread-1607): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48005e0>]}
2020-12-30 18:48:05.993490 (Thread-1607): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:48:07.421688 (Thread-1608): handling poll request
2020-12-30 18:48:07.422106 (Thread-1608): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d494d9d0>]}
2020-12-30 18:48:07.422970 (Thread-1608): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:48:08.839272 (Thread-1609): handling poll request
2020-12-30 18:48:08.839689 (Thread-1609): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052ac0>]}
2020-12-30 18:48:08.840550 (Thread-1609): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:48:10.293599 (Thread-1610): handling poll request
2020-12-30 18:48:10.294029 (Thread-1610): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052580>]}
2020-12-30 18:48:10.294985 (Thread-1610): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:48:11.741331 (Thread-1611): handling poll request
2020-12-30 18:48:11.741745 (Thread-1611): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052ca0>]}
2020-12-30 18:48:11.742605 (Thread-1611): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:48:13.210970 (Thread-1612): handling poll request
2020-12-30 18:48:13.211400 (Thread-1612): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052820>]}
2020-12-30 18:48:13.212269 (Thread-1612): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:48:14.628313 (Thread-1613): handling poll request
2020-12-30 18:48:14.628736 (Thread-1613): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403dac0>]}
2020-12-30 18:48:14.629649 (Thread-1613): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:48:16.058810 (Thread-1614): handling poll request
2020-12-30 18:48:16.059250 (Thread-1614): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403db80>]}
2020-12-30 18:48:16.060140 (Thread-1614): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:48:17.464740 (Thread-1615): handling poll request
2020-12-30 18:48:17.465175 (Thread-1615): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562370>]}
2020-12-30 18:48:17.466030 (Thread-1615): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:48:18.894637 (Thread-1616): handling poll request
2020-12-30 18:48:18.895055 (Thread-1616): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562ac0>]}
2020-12-30 18:48:18.895920 (Thread-1616): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:48:20.330119 (Thread-1617): handling poll request
2020-12-30 18:48:20.330536 (Thread-1617): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dafd0>]}
2020-12-30 18:48:20.331403 (Thread-1617): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:48:21.784083 (Thread-1618): handling poll request
2020-12-30 18:48:21.784496 (Thread-1618): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dae20>]}
2020-12-30 18:48:21.785691 (Thread-1618): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:48:23.226642 (Thread-1619): handling poll request
2020-12-30 18:48:23.227078 (Thread-1619): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403dca0>]}
2020-12-30 18:48:23.227937 (Thread-1619): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:48:24.633869 (Thread-1620): handling poll request
2020-12-30 18:48:24.634287 (Thread-1620): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403db20>]}
2020-12-30 18:48:24.635153 (Thread-1620): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:48:26.112310 (Thread-1621): handling poll request
2020-12-30 18:48:26.112899 (Thread-1621): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403d0a0>]}
2020-12-30 18:48:26.114145 (Thread-1621): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:48:27.560896 (Thread-1622): handling poll request
2020-12-30 18:48:27.561367 (Thread-1622): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d494d9d0>]}
2020-12-30 18:48:27.562263 (Thread-1622): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:48:28.976852 (Thread-1623): handling poll request
2020-12-30 18:48:28.977308 (Thread-1623): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052100>]}
2020-12-30 18:48:29.080961 (Thread-1623): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:48:30.491945 (Thread-1624): handling poll request
2020-12-30 18:48:30.492363 (Thread-1624): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48005e0>]}
2020-12-30 18:48:30.493280 (Thread-1624): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:48:31.439305 (Thread-1): SQL status: SUCCESS 1 in 195.57 seconds
2020-12-30 18:48:31.441109 (Thread-1): On model.sales_dataflo.Fact_Sales: COMMIT
2020-12-30 18:48:31.441283 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales".
2020-12-30 18:48:31.441363 (Thread-1): On model.sales_dataflo.Fact_Sales: COMMIT
2020-12-30 18:48:31.510196 (Thread-1): SQL status: SUCCESS 1 in 0.07 seconds
2020-12-30 18:48:31.513265 (Thread-1): finished collecting timing info
2020-12-30 18:48:31.513585 (Thread-1): On model.sales_dataflo.Fact_Sales: Close
2020-12-30 18:48:31.587941 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfac0abe0>]}
2020-12-30 18:48:31.589680 (Thread-1): 18:48:31 | 29 of 30 OK created table model dbt_salesdataflo.Fact_Sales.......... [SUCCESS 1 in 196.34s]
2020-12-30 18:48:31.589822 (Thread-1): Finished running node model.sales_dataflo.Fact_Sales
2020-12-30 18:48:31.589985 (Thread-1): Began running node model.sales_dataflo.Fact_Sales_Segmented
2020-12-30 18:48:31.591276 (Thread-1): 18:48:31 | 30 of 30 START table model dbt_salesdataflo.Fact_Sales_Segmented..... [RUN]
2020-12-30 18:48:31.591583 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2020-12-30 18:48:31.591694 (Thread-1): Compiling model.sales_dataflo.Fact_Sales_Segmented
2020-12-30 18:48:31.604599 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2020-12-30 18:48:31.604705 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented: BEGIN
2020-12-30 18:48:31.604798 (Thread-1): Opening a new connection, currently in state closed
2020-12-30 18:48:31.920106 (Thread-1625): handling poll request
2020-12-30 18:48:31.920526 (Thread-1625): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da8b0>]}
2020-12-30 18:48:31.922755 (Thread-1625): sending response (<Response 6872 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:48:32.128546 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2020-12-30 18:48:32.128689 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2020-12-30 18:48:32.128739 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented"} */


        select 
  

    datediff(
        day,
        to_date('01/01/2017', 'dd/mm/yyyy'),
        to_date('31/12/2018', 'dd/mm/yyyy')
        )
2020-12-30 18:48:32.235707 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2020-12-30 18:48:32.239190 (Thread-1): Writing injected SQL for node "model.sales_dataflo.Fact_Sales_Segmented"
2020-12-30 18:48:32.287139 (Thread-1): finished collecting timing info
2020-12-30 18:48:32.292144 (Thread-1): Writing runtime SQL for node "model.sales_dataflo.Fact_Sales_Segmented"
2020-12-30 18:48:32.340038 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2020-12-30 18:48:32.340144 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.sales_dataflo.Fact_Sales_Segmented"} */


      create or replace transient table DATAFLOTEST_DATABASE.dbt_salesdataflo.Fact_Sales_Segmented  as
      (

with date_range as 
(
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * pow(2, 0)
     + 
    
    p1.generated_number * pow(2, 1)
     + 
    
    p2.generated_number * pow(2, 2)
     + 
    
    p3.generated_number * pow(2, 3)
     + 
    
    p4.generated_number * pow(2, 4)
     + 
    
    p5.generated_number * pow(2, 5)
     + 
    
    p6.generated_number * pow(2, 6)
     + 
    
    p7.generated_number * pow(2, 7)
     + 
    
    p8.generated_number * pow(2, 8)
     + 
    
    p9.generated_number * pow(2, 9)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
    
    

    )

    select *
    from unioned
    where generated_number <= 729
    order by generated_number



),

all_periods as (

    select (
        
  

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        to_date('01/01/2017', 'dd/mm/yyyy')
        )



    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= to_date('31/12/2018', 'dd/mm/yyyy')

)

select * from filtered


),
 timeframe as (
  select * from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_TimeFrame 
  join date_range 
  on TimeFrameID = date_range.date_day
  ),  
Source AS
( SELECT * FROM  DATAFLOTEST_DATABASE.dbt_salesdataflo.Fact_Sales_Segmented_History
),
Metrics_Calc AS(
    SELECT
        TimeFrameID as Report_Date,
        entity_code  AS entity_id,
        employee_code AS employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_Name,
        'D' as TimeFrame_Type,
        sum(AMOUNT) as AMOUNT,
        sum(count) as COUNT,  
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
    from Source 
        join timeframe 
        on Report_Dt between timeframe.DAY_START and timeframe.DAY_END
        join date_range
        on TimeFrameID = date_range.date_day
    group by
        Report_Date,
        entity_id,
        employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_Name,
        TimeFrame_Type,
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
     Union
        SELECT
        TimeFrameID as Report_Date,
        entity_code  AS entity_id,
        employee_code AS employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_Name,
        'W' as TimeFrame_Type,
        sum(AMOUNT) as AMOUNT,
        sum(count) as COUNT,  
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
    from Source 
        join timeframe 
        on Report_Dt between timeframe.WEEK_START and timeframe.WEEK_END
        and Report_Dt <= TimeFrameID
        join date_range
        on TimeFrameID = date_range.date_day        
    group by
        Report_Date,
        entity_id,
        employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_Name,
        TimeFrame_Type,
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
     Union
        SELECT
        TimeFrameID as Report_Date,
        entity_code  AS entity_id,
        employee_code AS employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_Name,
        'M' as TimeFrame_Type,
        sum(AMOUNT) as AMOUNT,
        sum(count) as COUNT,  
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
    from Source 
        join timeframe 
        on Report_Dt between timeframe.MONTH_START and timeframe.MONTH_END
        and Report_Dt <= TimeFrameID
        join date_range
        on TimeFrameID = date_range.date_day        
    group by
        Report_Date,
        entity_id,
        employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_Name,
        TimeFrame_Type,
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
     Union
        SELECT
        TimeFrameID as Report_Date,
        entity_code  AS entity_id,
        employee_code AS employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_Name,
        'Q' as TimeFrame_Type,
        sum(AMOUNT) as AMOUNT,
        sum(count) as COUNT,  
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
    from Source 
        join timeframe 
        on Report_Dt between timeframe.QUARTER_START and timeframe.QUARTER_END
        and Report_Dt <= TimeFrameID
        join date_range
        on TimeFrameID = date_range.date_day        
    group by
        Report_Date,
        entity_id,
        employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_Name,
        TimeFrame_Type,
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
     Union
        SELECT
        TimeFrameID as Report_Date,
        entity_code  AS entity_id,
        employee_code AS employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_Name,
        'Y' as TimeFrame_Type,
        sum(AMOUNT) as AMOUNT,
        sum(count) as COUNT,  
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS
    from Source 
        join timeframe 
        on Report_Dt between timeframe.YEAR_START and timeframe.YEAR_END
        and Report_Dt <= TimeFrameID
        join date_range
        on TimeFrameID = date_range.date_day        
    group by
        Report_Date,
        entity_id,
        employee_id,
        METRIC_ID,
        METRIC_CATEGORY_ID,
        Segment_Name,
        TimeFrame_Type,
        Source.DW_SESSION_NM,
        Source.DW_INS_UPD_DTS                        
 )
 
SELECT Report_Date, entity_id, employee_id, METRIC_ID, METRIC_CATEGORY_ID, Segment_Name,TimeFrame_Type, AMOUNT, Count, 
        nvl(AMOUNT/decode(count,0,1,count),0) as Average,  DW_SESSION_NM, DW_INS_UPD_DTS  from Metrics_Calc
order by Report_Date, METRIC_ID,Segment_Name, TimeFrame_Type
      );
2020-12-30 18:48:33.497092 (Thread-1626): handling poll request
2020-12-30 18:48:33.497520 (Thread-1626): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993b80>]}
2020-12-30 18:48:33.499134 (Thread-1626): sending response (<Response 10655 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:48:34.938680 (Thread-1627): handling poll request
2020-12-30 18:48:34.939159 (Thread-1627): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403edc0>]}
2020-12-30 18:48:34.940044 (Thread-1627): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:48:36.370492 (Thread-1628): handling poll request
2020-12-30 18:48:36.370954 (Thread-1628): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993eb0>]}
2020-12-30 18:48:36.371811 (Thread-1628): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:48:37.795613 (Thread-1629): handling poll request
2020-12-30 18:48:37.796087 (Thread-1629): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e7c0>]}
2020-12-30 18:48:37.796972 (Thread-1629): sending response (<Response 285 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:48:39.255346 (Thread-1630): handling poll request
2020-12-30 18:48:39.255783 (Thread-1630): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401bac0>]}
2020-12-30 18:48:39.256645 (Thread-1630): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:48:40.707579 (Thread-1631): handling poll request
2020-12-30 18:48:40.708036 (Thread-1631): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401bee0>]}
2020-12-30 18:48:40.708912 (Thread-1631): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:48:42.145332 (Thread-1632): handling poll request
2020-12-30 18:48:42.145914 (Thread-1632): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40255e0>]}
2020-12-30 18:48:42.147138 (Thread-1632): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:48:43.638977 (Thread-1633): handling poll request
2020-12-30 18:48:43.639405 (Thread-1633): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025f40>]}
2020-12-30 18:48:43.640267 (Thread-1633): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:48:45.201150 (Thread-1634): handling poll request
2020-12-30 18:48:45.201606 (Thread-1634): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025880>]}
2020-12-30 18:48:45.202516 (Thread-1634): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:48:46.665563 (Thread-1635): handling poll request
2020-12-30 18:48:46.665972 (Thread-1635): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2fd0>]}
2020-12-30 18:48:46.667185 (Thread-1635): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:48:48.095439 (Thread-1636): handling poll request
2020-12-30 18:48:48.095871 (Thread-1636): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401b400>]}
2020-12-30 18:48:48.096748 (Thread-1636): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:48:49.525186 (Thread-1637): handling poll request
2020-12-30 18:48:49.525624 (Thread-1637): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401ba00>]}
2020-12-30 18:48:49.526515 (Thread-1637): sending response (<Response 285 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:48:50.954223 (Thread-1638): handling poll request
2020-12-30 18:48:50.954657 (Thread-1638): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401b100>]}
2020-12-30 18:48:50.955523 (Thread-1638): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:48:52.390732 (Thread-1639): handling poll request
2020-12-30 18:48:52.391147 (Thread-1639): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49930a0>]}
2020-12-30 18:48:52.392001 (Thread-1639): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:48:53.834230 (Thread-1640): handling poll request
2020-12-30 18:48:53.834679 (Thread-1640): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49939d0>]}
2020-12-30 18:48:53.835591 (Thread-1640): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:48:55.252224 (Thread-1641): handling poll request
2020-12-30 18:48:55.252637 (Thread-1641): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993460>]}
2020-12-30 18:48:55.253537 (Thread-1641): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:48:56.667183 (Thread-1642): handling poll request
2020-12-30 18:48:56.667606 (Thread-1642): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e340>]}
2020-12-30 18:48:56.668458 (Thread-1642): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:48:58.097998 (Thread-1643): handling poll request
2020-12-30 18:48:58.098424 (Thread-1643): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e9a0>]}
2020-12-30 18:48:58.099287 (Thread-1643): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:48:59.582492 (Thread-1644): handling poll request
2020-12-30 18:48:59.582938 (Thread-1644): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e4c0>]}
2020-12-30 18:48:59.583817 (Thread-1644): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:49:01.054168 (Thread-1645): handling poll request
2020-12-30 18:49:01.054605 (Thread-1645): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4020e20>]}
2020-12-30 18:49:01.055498 (Thread-1645): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:49:02.492125 (Thread-1646): handling poll request
2020-12-30 18:49:02.492552 (Thread-1646): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dad90>]}
2020-12-30 18:49:02.493502 (Thread-1646): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:49:03.934163 (Thread-1647): handling poll request
2020-12-30 18:49:03.934633 (Thread-1647): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025760>]}
2020-12-30 18:49:03.935550 (Thread-1647): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:49:05.470732 (Thread-1648): handling poll request
2020-12-30 18:49:05.471157 (Thread-1648): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff22e0>]}
2020-12-30 18:49:05.472023 (Thread-1648): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:49:06.898048 (Thread-1649): handling poll request
2020-12-30 18:49:06.898471 (Thread-1649): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2ca0>]}
2020-12-30 18:49:06.899599 (Thread-1649): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:49:08.324672 (Thread-1650): handling poll request
2020-12-30 18:49:08.325135 (Thread-1650): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4a1fe20>]}
2020-12-30 18:49:08.326031 (Thread-1650): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:49:09.745286 (Thread-1651): handling poll request
2020-12-30 18:49:09.745713 (Thread-1651): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2340>]}
2020-12-30 18:49:09.746610 (Thread-1651): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:49:11.171275 (Thread-1652): handling poll request
2020-12-30 18:49:11.171698 (Thread-1652): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dab20>]}
2020-12-30 18:49:11.172561 (Thread-1652): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:49:12.582514 (Thread-1653): handling poll request
2020-12-30 18:49:12.582940 (Thread-1653): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46be760>]}
2020-12-30 18:49:12.691240 (Thread-1653): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:49:14.140523 (Thread-1654): handling poll request
2020-12-30 18:49:14.141126 (Thread-1654): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993fd0>]}
2020-12-30 18:49:14.142339 (Thread-1654): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:49:15.547131 (Thread-1655): handling poll request
2020-12-30 18:49:15.547554 (Thread-1655): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2be0>]}
2020-12-30 18:49:15.548420 (Thread-1655): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:49:16.989639 (Thread-1656): handling poll request
2020-12-30 18:49:16.990068 (Thread-1656): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2dc0>]}
2020-12-30 18:49:16.990941 (Thread-1656): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:49:18.425632 (Thread-1657): handling poll request
2020-12-30 18:49:18.426195 (Thread-1657): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dad60>]}
2020-12-30 18:49:18.427320 (Thread-1657): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:49:19.854585 (Thread-1658): handling poll request
2020-12-30 18:49:19.854995 (Thread-1658): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da370>]}
2020-12-30 18:49:19.855850 (Thread-1658): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:49:21.279563 (Thread-1659): handling poll request
2020-12-30 18:49:21.279985 (Thread-1659): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46be2e0>]}
2020-12-30 18:49:21.280853 (Thread-1659): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:49:22.707676 (Thread-1660): handling poll request
2020-12-30 18:49:22.708102 (Thread-1660): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ee80>]}
2020-12-30 18:49:22.708983 (Thread-1660): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:49:24.150682 (Thread-1661): handling poll request
2020-12-30 18:49:24.151115 (Thread-1661): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ee20>]}
2020-12-30 18:49:24.151986 (Thread-1661): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:49:25.565953 (Thread-1662): handling poll request
2020-12-30 18:49:25.566375 (Thread-1662): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401bac0>]}
2020-12-30 18:49:25.567238 (Thread-1662): sending response (<Response 285 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:49:26.995039 (Thread-1663): handling poll request
2020-12-30 18:49:26.995465 (Thread-1663): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401b700>]}
2020-12-30 18:49:26.996342 (Thread-1663): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:49:28.461747 (Thread-1664): handling poll request
2020-12-30 18:49:28.462229 (Thread-1664): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2d60>]}
2020-12-30 18:49:28.463083 (Thread-1664): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:49:29.961958 (Thread-1665): handling poll request
2020-12-30 18:49:29.962371 (Thread-1665): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5c70>]}
2020-12-30 18:49:29.963212 (Thread-1665): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:49:31.388580 (Thread-1666): handling poll request
2020-12-30 18:49:31.389022 (Thread-1666): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5bb0>]}
2020-12-30 18:49:31.389942 (Thread-1666): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:49:32.836844 (Thread-1667): handling poll request
2020-12-30 18:49:32.837341 (Thread-1667): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb2b340>]}
2020-12-30 18:49:32.838583 (Thread-1667): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:49:34.292239 (Thread-1668): handling poll request
2020-12-30 18:49:34.292657 (Thread-1668): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5700>]}
2020-12-30 18:49:34.293557 (Thread-1668): sending response (<Response 285 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:49:35.717876 (Thread-1669): handling poll request
2020-12-30 18:49:35.718300 (Thread-1669): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f50d0>]}
2020-12-30 18:49:35.719161 (Thread-1669): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:49:37.162425 (Thread-1670): handling poll request
2020-12-30 18:49:37.162844 (Thread-1670): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401bd60>]}
2020-12-30 18:49:37.163704 (Thread-1670): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:49:38.583879 (Thread-1671): handling poll request
2020-12-30 18:49:38.584306 (Thread-1671): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401b760>]}
2020-12-30 18:49:38.585245 (Thread-1671): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:49:40.002835 (Thread-1672): handling poll request
2020-12-30 18:49:40.003267 (Thread-1672): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401b640>]}
2020-12-30 18:49:40.004144 (Thread-1672): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:49:41.413923 (Thread-1673): handling poll request
2020-12-30 18:49:41.414350 (Thread-1673): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403edc0>]}
2020-12-30 18:49:41.415237 (Thread-1673): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:49:42.844524 (Thread-1674): handling poll request
2020-12-30 18:49:42.844960 (Thread-1674): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ef40>]}
2020-12-30 18:49:42.845890 (Thread-1674): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:49:44.273292 (Thread-1675): handling poll request
2020-12-30 18:49:44.273725 (Thread-1675): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da2e0>]}
2020-12-30 18:49:44.274609 (Thread-1675): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:49:45.745223 (Thread-1676): handling poll request
2020-12-30 18:49:45.745649 (Thread-1676): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dae20>]}
2020-12-30 18:49:45.746501 (Thread-1676): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:49:47.181679 (Thread-1677): handling poll request
2020-12-30 18:49:47.182093 (Thread-1677): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dab20>]}
2020-12-30 18:49:47.182958 (Thread-1677): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:49:48.614897 (Thread-1678): handling poll request
2020-12-30 18:49:48.615317 (Thread-1678): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dabe0>]}
2020-12-30 18:49:48.616178 (Thread-1678): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:49:50.066657 (Thread-1679): handling poll request
2020-12-30 18:49:50.067072 (Thread-1679): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfb24d60>]}
2020-12-30 18:49:50.067920 (Thread-1679): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:49:51.559578 (Thread-1680): handling poll request
2020-12-30 18:49:51.559992 (Thread-1680): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2fd0>]}
2020-12-30 18:49:51.560856 (Thread-1680): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:49:53.023907 (Thread-1681): handling poll request
2020-12-30 18:49:53.024343 (Thread-1681): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2340>]}
2020-12-30 18:49:53.025507 (Thread-1681): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:49:54.480839 (Thread-1682): handling poll request
2020-12-30 18:49:54.481281 (Thread-1682): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2fa0>]}
2020-12-30 18:49:54.482154 (Thread-1682): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:49:55.919119 (Thread-1683): handling poll request
2020-12-30 18:49:55.919559 (Thread-1683): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993070>]}
2020-12-30 18:49:56.028141 (Thread-1683): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:49:57.436265 (Thread-1684): handling poll request
2020-12-30 18:49:57.436709 (Thread-1684): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4800370>]}
2020-12-30 18:49:57.437679 (Thread-1684): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:49:58.860329 (Thread-1685): handling poll request
2020-12-30 18:49:58.860762 (Thread-1685): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da7f0>]}
2020-12-30 18:49:58.861669 (Thread-1685): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:50:00.251726 (Thread-1686): handling poll request
2020-12-30 18:50:00.252158 (Thread-1686): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da400>]}
2020-12-30 18:50:00.253070 (Thread-1686): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:50:01.685536 (Thread-1687): handling poll request
2020-12-30 18:50:01.686014 (Thread-1687): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48bb730>]}
2020-12-30 18:50:01.686880 (Thread-1687): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:50:03.117553 (Thread-1688): handling poll request
2020-12-30 18:50:03.117982 (Thread-1688): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ea00>]}
2020-12-30 18:50:03.118880 (Thread-1688): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:50:04.626061 (Thread-1689): handling poll request
2020-12-30 18:50:04.626498 (Thread-1689): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e700>]}
2020-12-30 18:50:04.627390 (Thread-1689): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:50:06.176585 (Thread-1690): handling poll request
2020-12-30 18:50:06.177020 (Thread-1690): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5610>]}
2020-12-30 18:50:06.177941 (Thread-1690): sending response (<Response 285 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:50:07.581319 (Thread-1691): handling poll request
2020-12-30 18:50:07.581836 (Thread-1691): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45e18b0>]}
2020-12-30 18:50:07.582708 (Thread-1691): sending response (<Response 285 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:50:09.007555 (Thread-1692): handling poll request
2020-12-30 18:50:09.007973 (Thread-1692): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5160>]}
2020-12-30 18:50:09.008845 (Thread-1692): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:50:10.639439 (Thread-1693): handling poll request
2020-12-30 18:50:10.639860 (Thread-1693): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025280>]}
2020-12-30 18:50:10.640744 (Thread-1693): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:50:12.075104 (Thread-1694): handling poll request
2020-12-30 18:50:12.075559 (Thread-1694): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40256a0>]}
2020-12-30 18:50:12.076497 (Thread-1694): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:50:13.693171 (Thread-1695): handling poll request
2020-12-30 18:50:13.693604 (Thread-1695): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5a30>]}
2020-12-30 18:50:13.694468 (Thread-1695): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:50:15.117636 (Thread-1696): handling poll request
2020-12-30 18:50:15.118067 (Thread-1696): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f55e0>]}
2020-12-30 18:50:15.118950 (Thread-1696): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:50:16.730080 (Thread-1697): handling poll request
2020-12-30 18:50:16.730504 (Thread-1697): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5460>]}
2020-12-30 18:50:16.731384 (Thread-1697): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:50:18.739585 (Thread-1698): handling poll request
2020-12-30 18:50:18.740030 (Thread-1698): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f59a0>]}
2020-12-30 18:50:18.740926 (Thread-1698): sending response (<Response 285 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:50:20.770084 (Thread-1699): handling poll request
2020-12-30 18:50:20.770560 (Thread-1699): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46befa0>]}
2020-12-30 18:50:20.771430 (Thread-1699): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:50:22.754121 (Thread-1700): handling poll request
2020-12-30 18:50:22.754562 (Thread-1700): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2460>]}
2020-12-30 18:50:22.755434 (Thread-1700): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:50:24.746623 (Thread-1701): handling poll request
2020-12-30 18:50:24.747060 (Thread-1701): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff25e0>]}
2020-12-30 18:50:24.747995 (Thread-1701): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:50:26.755504 (Thread-1702): handling poll request
2020-12-30 18:50:26.755954 (Thread-1702): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2ee0>]}
2020-12-30 18:50:26.756838 (Thread-1702): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:50:28.731693 (Thread-1703): handling poll request
2020-12-30 18:50:28.732121 (Thread-1703): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48bb7f0>]}
2020-12-30 18:50:28.732994 (Thread-1703): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:50:30.736426 (Thread-1704): handling poll request
2020-12-30 18:50:30.736853 (Thread-1704): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da7f0>]}
2020-12-30 18:50:30.737754 (Thread-1704): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:50:32.715978 (Thread-1705): handling poll request
2020-12-30 18:50:32.716395 (Thread-1705): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dacd0>]}
2020-12-30 18:50:32.717308 (Thread-1705): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:50:34.808948 (Thread-1706): handling poll request
2020-12-30 18:50:34.809426 (Thread-1706): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da370>]}
2020-12-30 18:50:34.810282 (Thread-1706): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:50:36.725020 (Thread-1707): handling poll request
2020-12-30 18:50:36.725470 (Thread-1707): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690940>]}
2020-12-30 18:50:36.726365 (Thread-1707): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:50:38.727451 (Thread-1708): handling poll request
2020-12-30 18:50:38.727868 (Thread-1708): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46903a0>]}
2020-12-30 18:50:38.728999 (Thread-1708): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:50:40.705385 (Thread-1709): handling poll request
2020-12-30 18:50:40.705840 (Thread-1709): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48e9070>]}
2020-12-30 18:50:40.706695 (Thread-1709): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:50:42.742317 (Thread-1710): handling poll request
2020-12-30 18:50:42.742729 (Thread-1710): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da670>]}
2020-12-30 18:50:42.743827 (Thread-1710): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:50:44.711799 (Thread-1711): handling poll request
2020-12-30 18:50:44.712214 (Thread-1711): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da5b0>]}
2020-12-30 18:50:44.713083 (Thread-1711): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:50:46.725282 (Thread-1712): handling poll request
2020-12-30 18:50:46.725727 (Thread-1712): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48bb6d0>]}
2020-12-30 18:50:46.726584 (Thread-1712): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:50:48.731617 (Thread-1713): handling poll request
2020-12-30 18:50:48.732037 (Thread-1713): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2280>]}
2020-12-30 18:50:48.836814 (Thread-1713): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:50:50.733662 (Thread-1714): handling poll request
2020-12-30 18:50:50.734082 (Thread-1714): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f59a0>]}
2020-12-30 18:50:50.734968 (Thread-1714): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:50:52.719625 (Thread-1715): handling poll request
2020-12-30 18:50:52.720063 (Thread-1715): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2400>]}
2020-12-30 18:50:52.720948 (Thread-1715): sending response (<Response 285 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:50:54.717032 (Thread-1716): handling poll request
2020-12-30 18:50:54.717470 (Thread-1716): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2d60>]}
2020-12-30 18:50:54.718318 (Thread-1716): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:50:56.732042 (Thread-1717): handling poll request
2020-12-30 18:50:56.732495 (Thread-1717): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46dadf0>]}
2020-12-30 18:50:56.733440 (Thread-1717): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:50:58.703037 (Thread-1718): handling poll request
2020-12-30 18:50:58.703486 (Thread-1718): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da640>]}
2020-12-30 18:50:58.704385 (Thread-1718): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:51:00.727784 (Thread-1719): handling poll request
2020-12-30 18:51:00.728210 (Thread-1719): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40252e0>]}
2020-12-30 18:51:00.729128 (Thread-1719): sending response (<Response 285 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:51:02.710256 (Thread-1720): handling poll request
2020-12-30 18:51:02.710672 (Thread-1720): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025e80>]}
2020-12-30 18:51:02.711539 (Thread-1720): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:51:04.706147 (Thread-1721): handling poll request
2020-12-30 18:51:04.706568 (Thread-1721): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40254c0>]}
2020-12-30 18:51:04.707419 (Thread-1721): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:51:06.700577 (Thread-1722): handling poll request
2020-12-30 18:51:06.700996 (Thread-1722): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993bb0>]}
2020-12-30 18:51:06.701896 (Thread-1722): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:51:08.724033 (Thread-1723): handling poll request
2020-12-30 18:51:08.724450 (Thread-1723): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993370>]}
2020-12-30 18:51:08.725380 (Thread-1723): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:51:10.711187 (Thread-1724): handling poll request
2020-12-30 18:51:10.711613 (Thread-1724): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993a60>]}
2020-12-30 18:51:10.712486 (Thread-1724): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:51:12.715320 (Thread-1725): handling poll request
2020-12-30 18:51:12.715738 (Thread-1725): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052760>]}
2020-12-30 18:51:12.716597 (Thread-1725): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:51:14.713677 (Thread-1726): handling poll request
2020-12-30 18:51:14.714104 (Thread-1726): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052520>]}
2020-12-30 18:51:14.715015 (Thread-1726): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:51:16.726027 (Thread-1727): handling poll request
2020-12-30 18:51:16.726479 (Thread-1727): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40527c0>]}
2020-12-30 18:51:16.727741 (Thread-1727): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:51:18.751037 (Thread-1728): handling poll request
2020-12-30 18:51:18.751470 (Thread-1728): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40524c0>]}
2020-12-30 18:51:18.752343 (Thread-1728): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:51:20.797267 (Thread-1729): handling poll request
2020-12-30 18:51:20.797677 (Thread-1729): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993eb0>]}
2020-12-30 18:51:20.798544 (Thread-1729): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:51:22.736912 (Thread-1730): handling poll request
2020-12-30 18:51:22.737366 (Thread-1730): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993400>]}
2020-12-30 18:51:22.738243 (Thread-1730): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:51:24.738287 (Thread-1731): handling poll request
2020-12-30 18:51:24.738732 (Thread-1731): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993490>]}
2020-12-30 18:51:24.739607 (Thread-1731): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:51:26.736324 (Thread-1732): handling poll request
2020-12-30 18:51:26.736744 (Thread-1732): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993820>]}
2020-12-30 18:51:26.737655 (Thread-1732): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:51:28.729562 (Thread-1733): handling poll request
2020-12-30 18:51:28.729993 (Thread-1733): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40252e0>]}
2020-12-30 18:51:28.730858 (Thread-1733): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:51:30.746331 (Thread-1734): handling poll request
2020-12-30 18:51:30.746755 (Thread-1734): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025ac0>]}
2020-12-30 18:51:30.747622 (Thread-1734): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:51:32.761264 (Thread-1735): handling poll request
2020-12-30 18:51:32.761728 (Thread-1735): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40258e0>]}
2020-12-30 18:51:32.762623 (Thread-1735): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:51:34.747171 (Thread-1736): handling poll request
2020-12-30 18:51:34.747593 (Thread-1736): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da430>]}
2020-12-30 18:51:34.748535 (Thread-1736): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:51:36.718745 (Thread-1737): handling poll request
2020-12-30 18:51:36.719175 (Thread-1737): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da640>]}
2020-12-30 18:51:36.720036 (Thread-1737): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:51:38.736166 (Thread-1738): handling poll request
2020-12-30 18:51:38.736632 (Thread-1738): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2dc0>]}
2020-12-30 18:51:38.737557 (Thread-1738): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:51:40.717799 (Thread-1739): handling poll request
2020-12-30 18:51:40.718218 (Thread-1739): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2d00>]}
2020-12-30 18:51:40.719093 (Thread-1739): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:51:42.742876 (Thread-1740): handling poll request
2020-12-30 18:51:42.743301 (Thread-1740): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2fa0>]}
2020-12-30 18:51:42.744187 (Thread-1740): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:51:44.758708 (Thread-1741): handling poll request
2020-12-30 18:51:44.759132 (Thread-1741): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46bec40>]}
2020-12-30 18:51:44.760266 (Thread-1741): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:51:46.779761 (Thread-1742): handling poll request
2020-12-30 18:51:46.780177 (Thread-1742): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5070>]}
2020-12-30 18:51:46.781039 (Thread-1742): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:51:48.729420 (Thread-1743): handling poll request
2020-12-30 18:51:48.729841 (Thread-1743): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff24c0>]}
2020-12-30 18:51:48.834344 (Thread-1743): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:51:50.775991 (Thread-1744): handling poll request
2020-12-30 18:51:50.776424 (Thread-1744): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45c0a90>]}
2020-12-30 18:51:50.777334 (Thread-1744): sending response (<Response 285 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:51:52.721506 (Thread-1745): handling poll request
2020-12-30 18:51:52.721926 (Thread-1745): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da130>]}
2020-12-30 18:51:52.722805 (Thread-1745): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:51:54.718276 (Thread-1746): handling poll request
2020-12-30 18:51:54.718690 (Thread-1746): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d494de50>]}
2020-12-30 18:51:54.719565 (Thread-1746): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:51:56.746058 (Thread-1747): handling poll request
2020-12-30 18:51:56.746477 (Thread-1747): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40255e0>]}
2020-12-30 18:51:56.747391 (Thread-1747): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:51:58.736691 (Thread-1748): handling poll request
2020-12-30 18:51:58.737150 (Thread-1748): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025700>]}
2020-12-30 18:51:58.738039 (Thread-1748): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:52:00.728519 (Thread-1749): handling poll request
2020-12-30 18:52:00.729003 (Thread-1749): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f53d0>]}
2020-12-30 18:52:00.729907 (Thread-1749): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:52:02.716359 (Thread-1750): handling poll request
2020-12-30 18:52:02.716787 (Thread-1750): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690cd0>]}
2020-12-30 18:52:02.717687 (Thread-1750): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:52:04.733812 (Thread-1751): handling poll request
2020-12-30 18:52:04.734238 (Thread-1751): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ef40>]}
2020-12-30 18:52:04.735131 (Thread-1751): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:52:06.758801 (Thread-1752): handling poll request
2020-12-30 18:52:06.759232 (Thread-1752): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403eee0>]}
2020-12-30 18:52:06.760097 (Thread-1752): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:52:08.736157 (Thread-1753): handling poll request
2020-12-30 18:52:08.736577 (Thread-1753): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e100>]}
2020-12-30 18:52:08.737498 (Thread-1753): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:52:10.757447 (Thread-1754): handling poll request
2020-12-30 18:52:10.757902 (Thread-1754): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5e50>]}
2020-12-30 18:52:10.759105 (Thread-1754): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:52:12.731658 (Thread-1755): handling poll request
2020-12-30 18:52:12.732081 (Thread-1755): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e940>]}
2020-12-30 18:52:12.732937 (Thread-1755): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:52:14.717085 (Thread-1756): handling poll request
2020-12-30 18:52:14.717514 (Thread-1756): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da5b0>]}
2020-12-30 18:52:14.718390 (Thread-1756): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:52:16.694899 (Thread-1757): handling poll request
2020-12-30 18:52:16.695339 (Thread-1757): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d46da6d0>]}
2020-12-30 18:52:16.696223 (Thread-1757): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:52:18.712555 (Thread-1758): handling poll request
2020-12-30 18:52:18.713008 (Thread-1758): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690790>]}
2020-12-30 18:52:18.713934 (Thread-1758): sending response (<Response 285 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:52:20.866911 (Thread-1759): handling poll request
2020-12-30 18:52:20.867348 (Thread-1759): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690bb0>]}
2020-12-30 18:52:20.868241 (Thread-1759): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:52:22.723611 (Thread-1760): handling poll request
2020-12-30 18:52:22.724037 (Thread-1760): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993a60>]}
2020-12-30 18:52:22.724927 (Thread-1760): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:52:24.715987 (Thread-1761): handling poll request
2020-12-30 18:52:24.716409 (Thread-1761): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49936a0>]}
2020-12-30 18:52:24.717299 (Thread-1761): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:52:26.731441 (Thread-1762): handling poll request
2020-12-30 18:52:26.731882 (Thread-1762): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993af0>]}
2020-12-30 18:52:26.732776 (Thread-1762): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:52:28.719161 (Thread-1763): handling poll request
2020-12-30 18:52:28.719587 (Thread-1763): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025f40>]}
2020-12-30 18:52:28.720449 (Thread-1763): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:52:30.740175 (Thread-1764): handling poll request
2020-12-30 18:52:30.740637 (Thread-1764): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025d00>]}
2020-12-30 18:52:30.741565 (Thread-1764): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:52:32.711471 (Thread-1765): handling poll request
2020-12-30 18:52:32.711896 (Thread-1765): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40259a0>]}
2020-12-30 18:52:32.712755 (Thread-1765): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:52:34.727587 (Thread-1766): handling poll request
2020-12-30 18:52:34.728039 (Thread-1766): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5190>]}
2020-12-30 18:52:34.728902 (Thread-1766): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:52:36.733664 (Thread-1767): handling poll request
2020-12-30 18:52:36.734092 (Thread-1767): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5ee0>]}
2020-12-30 18:52:36.734974 (Thread-1767): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:52:38.915026 (Thread-1768): handling poll request
2020-12-30 18:52:38.915615 (Thread-1768): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5fa0>]}
2020-12-30 18:52:38.917231 (Thread-1768): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:52:40.731133 (Thread-1769): handling poll request
2020-12-30 18:52:40.731554 (Thread-1769): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5580>]}
2020-12-30 18:52:40.732417 (Thread-1769): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:52:42.714636 (Thread-1770): handling poll request
2020-12-30 18:52:42.715079 (Thread-1770): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f56d0>]}
2020-12-30 18:52:42.715969 (Thread-1770): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:52:44.730734 (Thread-1771): handling poll request
2020-12-30 18:52:44.731168 (Thread-1771): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4020940>]}
2020-12-30 18:52:44.732036 (Thread-1771): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:52:46.708190 (Thread-1772): handling poll request
2020-12-30 18:52:46.708623 (Thread-1772): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025040>]}
2020-12-30 18:52:46.709523 (Thread-1772): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:52:48.719758 (Thread-1773): handling poll request
2020-12-30 18:52:48.720178 (Thread-1773): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025460>]}
2020-12-30 18:52:48.823970 (Thread-1773): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:52:50.708044 (Thread-1774): handling poll request
2020-12-30 18:52:50.708462 (Thread-1774): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993d30>]}
2020-12-30 18:52:50.709374 (Thread-1774): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:52:52.742355 (Thread-1775): handling poll request
2020-12-30 18:52:52.742788 (Thread-1775): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2280>]}
2020-12-30 18:52:52.743648 (Thread-1775): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:52:54.698985 (Thread-1776): handling poll request
2020-12-30 18:52:54.699430 (Thread-1776): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2760>]}
2020-12-30 18:52:54.700312 (Thread-1776): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:52:56.728356 (Thread-1777): handling poll request
2020-12-30 18:52:56.728792 (Thread-1777): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e640>]}
2020-12-30 18:52:56.729701 (Thread-1777): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:52:58.728167 (Thread-1778): handling poll request
2020-12-30 18:52:58.728590 (Thread-1778): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e2e0>]}
2020-12-30 18:52:58.729511 (Thread-1778): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:53:00.721668 (Thread-1779): handling poll request
2020-12-30 18:53:00.722101 (Thread-1779): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e220>]}
2020-12-30 18:53:00.722993 (Thread-1779): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:53:02.918137 (Thread-1780): handling poll request
2020-12-30 18:53:02.918564 (Thread-1780): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5b50>]}
2020-12-30 18:53:02.919432 (Thread-1780): sending response (<Response 285 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:53:04.751185 (Thread-1781): handling poll request
2020-12-30 18:53:04.751613 (Thread-1781): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5340>]}
2020-12-30 18:53:04.752500 (Thread-1781): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:53:06.705008 (Thread-1782): handling poll request
2020-12-30 18:53:06.705470 (Thread-1782): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f53a0>]}
2020-12-30 18:53:06.706344 (Thread-1782): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:53:08.743043 (Thread-1783): handling poll request
2020-12-30 18:53:08.743477 (Thread-1783): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40521c0>]}
2020-12-30 18:53:08.744331 (Thread-1783): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:53:10.721599 (Thread-1784): handling poll request
2020-12-30 18:53:10.722030 (Thread-1784): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052fd0>]}
2020-12-30 18:53:10.722956 (Thread-1784): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:53:12.725372 (Thread-1785): handling poll request
2020-12-30 18:53:12.725791 (Thread-1785): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052940>]}
2020-12-30 18:53:12.726667 (Thread-1785): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:53:14.706440 (Thread-1786): handling poll request
2020-12-30 18:53:14.706868 (Thread-1786): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401b100>]}
2020-12-30 18:53:14.707739 (Thread-1786): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:53:16.738661 (Thread-1787): handling poll request
2020-12-30 18:53:16.739090 (Thread-1787): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401b820>]}
2020-12-30 18:53:16.740319 (Thread-1787): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:53:18.731570 (Thread-1788): handling poll request
2020-12-30 18:53:18.731999 (Thread-1788): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401b760>]}
2020-12-30 18:53:18.732900 (Thread-1788): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:53:20.740012 (Thread-1789): handling poll request
2020-12-30 18:53:20.740445 (Thread-1789): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401b0a0>]}
2020-12-30 18:53:20.741346 (Thread-1789): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:53:22.698149 (Thread-1790): handling poll request
2020-12-30 18:53:22.698612 (Thread-1790): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401bb20>]}
2020-12-30 18:53:22.699492 (Thread-1790): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:53:24.739560 (Thread-1791): handling poll request
2020-12-30 18:53:24.739997 (Thread-1791): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4052f40>]}
2020-12-30 18:53:24.740863 (Thread-1791): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:53:26.736770 (Thread-1792): handling poll request
2020-12-30 18:53:26.737217 (Thread-1792): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5f70>]}
2020-12-30 18:53:26.738079 (Thread-1792): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:53:28.752590 (Thread-1793): handling poll request
2020-12-30 18:53:28.753013 (Thread-1793): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f57f0>]}
2020-12-30 18:53:28.753920 (Thread-1793): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:53:30.722023 (Thread-1794): handling poll request
2020-12-30 18:53:30.722442 (Thread-1794): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f52b0>]}
2020-12-30 18:53:30.723298 (Thread-1794): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:53:32.748625 (Thread-1795): handling poll request
2020-12-30 18:53:32.749044 (Thread-1795): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5be0>]}
2020-12-30 18:53:32.749954 (Thread-1795): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:53:34.715624 (Thread-1796): handling poll request
2020-12-30 18:53:34.716043 (Thread-1796): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403eb80>]}
2020-12-30 18:53:34.716916 (Thread-1796): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:53:36.736781 (Thread-1797): handling poll request
2020-12-30 18:53:36.737233 (Thread-1797): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e220>]}
2020-12-30 18:53:36.738195 (Thread-1797): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:53:38.731798 (Thread-1798): handling poll request
2020-12-30 18:53:38.732275 (Thread-1798): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e4c0>]}
2020-12-30 18:53:38.733189 (Thread-1798): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:53:40.770002 (Thread-1799): handling poll request
2020-12-30 18:53:40.770482 (Thread-1799): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993400>]}
2020-12-30 18:53:40.771345 (Thread-1799): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:53:42.762785 (Thread-1800): handling poll request
2020-12-30 18:53:42.763205 (Thread-1800): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2dc0>]}
2020-12-30 18:53:42.764073 (Thread-1800): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:53:44.731708 (Thread-1801): handling poll request
2020-12-30 18:53:44.732159 (Thread-1801): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff26a0>]}
2020-12-30 18:53:44.733362 (Thread-1801): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:53:46.731111 (Thread-1802): handling poll request
2020-12-30 18:53:46.731552 (Thread-1802): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff28e0>]}
2020-12-30 18:53:46.732524 (Thread-1802): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:53:48.732257 (Thread-1803): handling poll request
2020-12-30 18:53:48.732698 (Thread-1803): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2be0>]}
2020-12-30 18:53:48.840195 (Thread-1803): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:53:50.716959 (Thread-1804): handling poll request
2020-12-30 18:53:50.717442 (Thread-1804): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45e18b0>]}
2020-12-30 18:53:50.718321 (Thread-1804): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:53:52.758678 (Thread-1805): handling poll request
2020-12-30 18:53:52.759227 (Thread-1805): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2ee0>]}
2020-12-30 18:53:52.760201 (Thread-1805): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:53:54.745430 (Thread-1806): handling poll request
2020-12-30 18:53:54.745855 (Thread-1806): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5940>]}
2020-12-30 18:53:54.746721 (Thread-1806): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:53:56.728878 (Thread-1807): handling poll request
2020-12-30 18:53:56.729320 (Thread-1807): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f52b0>]}
2020-12-30 18:53:56.730171 (Thread-1807): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:53:58.735478 (Thread-1808): handling poll request
2020-12-30 18:53:58.735921 (Thread-1808): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403eee0>]}
2020-12-30 18:53:58.736790 (Thread-1808): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:54:00.756171 (Thread-1809): handling poll request
2020-12-30 18:54:00.756615 (Thread-1809): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403eca0>]}
2020-12-30 18:54:00.757562 (Thread-1809): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:54:02.742451 (Thread-1810): handling poll request
2020-12-30 18:54:02.742926 (Thread-1810): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447160>]}
2020-12-30 18:54:02.743803 (Thread-1810): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:54:04.727741 (Thread-1811): handling poll request
2020-12-30 18:54:04.728172 (Thread-1811): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447b50>]}
2020-12-30 18:54:04.729101 (Thread-1811): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:54:06.753243 (Thread-1812): handling poll request
2020-12-30 18:54:06.753658 (Thread-1812): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447af0>]}
2020-12-30 18:54:06.754520 (Thread-1812): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:54:08.740314 (Thread-1813): handling poll request
2020-12-30 18:54:08.740743 (Thread-1813): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447c10>]}
2020-12-30 18:54:08.741652 (Thread-1813): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:54:10.742510 (Thread-1814): handling poll request
2020-12-30 18:54:10.742944 (Thread-1814): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025460>]}
2020-12-30 18:54:10.743853 (Thread-1814): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:54:12.734568 (Thread-1815): handling poll request
2020-12-30 18:54:12.734989 (Thread-1815): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ee20>]}
2020-12-30 18:54:12.735865 (Thread-1815): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:54:14.690617 (Thread-1816): handling poll request
2020-12-30 18:54:14.691042 (Thread-1816): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45e1be0>]}
2020-12-30 18:54:14.691899 (Thread-1816): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:54:16.724764 (Thread-1817): handling poll request
2020-12-30 18:54:16.725221 (Thread-1817): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e460>]}
2020-12-30 18:54:16.726139 (Thread-1817): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:54:18.720840 (Thread-1818): handling poll request
2020-12-30 18:54:18.721303 (Thread-1818): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690c10>]}
2020-12-30 18:54:18.722190 (Thread-1818): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:54:20.726553 (Thread-1819): handling poll request
2020-12-30 18:54:20.726979 (Thread-1819): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690550>]}
2020-12-30 18:54:20.727869 (Thread-1819): sending response (<Response 285 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:54:22.772944 (Thread-1820): handling poll request
2020-12-30 18:54:22.773390 (Thread-1820): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447b80>]}
2020-12-30 18:54:22.774328 (Thread-1820): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:54:24.705649 (Thread-1821): handling poll request
2020-12-30 18:54:24.706068 (Thread-1821): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447be0>]}
2020-12-30 18:54:24.706928 (Thread-1821): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:54:26.745402 (Thread-1822): handling poll request
2020-12-30 18:54:26.745835 (Thread-1822): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44474f0>]}
2020-12-30 18:54:26.746731 (Thread-1822): sending response (<Response 286 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:54:28.709929 (Thread-1823): handling poll request
2020-12-30 18:54:28.710479 (Thread-1823): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44478b0>]}
2020-12-30 18:54:28.711648 (Thread-1823): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:54:30.738480 (Thread-1824): handling poll request
2020-12-30 18:54:30.738910 (Thread-1824): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2ca0>]}
2020-12-30 18:54:30.739775 (Thread-1824): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:54:32.730008 (Thread-1825): handling poll request
2020-12-30 18:54:32.730442 (Thread-1825): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2dc0>]}
2020-12-30 18:54:32.731319 (Thread-1825): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:54:34.724715 (Thread-1826): handling poll request
2020-12-30 18:54:34.725150 (Thread-1826): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2f40>]}
2020-12-30 18:54:34.726013 (Thread-1826): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:54:36.720645 (Thread-1827): handling poll request
2020-12-30 18:54:36.721101 (Thread-1827): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5f70>]}
2020-12-30 18:54:36.722043 (Thread-1827): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:54:38.721229 (Thread-1828): handling poll request
2020-12-30 18:54:38.721650 (Thread-1828): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5760>]}
2020-12-30 18:54:38.722794 (Thread-1828): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:54:40.721127 (Thread-1829): handling poll request
2020-12-30 18:54:40.721613 (Thread-1829): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5940>]}
2020-12-30 18:54:40.722487 (Thread-1829): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:54:42.766182 (Thread-1830): handling poll request
2020-12-30 18:54:42.766608 (Thread-1830): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4020940>]}
2020-12-30 18:54:42.767474 (Thread-1830): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:54:44.720007 (Thread-1831): handling poll request
2020-12-30 18:54:44.720436 (Thread-1831): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2ee0>]}
2020-12-30 18:54:44.721333 (Thread-1831): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:54:46.126212 (Thread-1832): handling poll request
2020-12-30 18:54:46.126638 (Thread-1832): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2940>]}
2020-12-30 18:54:46.127519 (Thread-1832): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:54:47.585410 (Thread-1833): handling poll request
2020-12-30 18:54:47.585832 (Thread-1833): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44474f0>]}
2020-12-30 18:54:47.691475 (Thread-1833): sending response (<Response 285 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:54:49.129459 (Thread-1834): handling poll request
2020-12-30 18:54:49.129895 (Thread-1834): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4690970>]}
2020-12-30 18:54:49.130804 (Thread-1834): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:54:51.025924 (Thread-1835): handling poll request
2020-12-30 18:54:51.026411 (Thread-1835): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993460>]}
2020-12-30 18:54:51.027287 (Thread-1835): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:54:52.453951 (Thread-1836): handling poll request
2020-12-30 18:54:52.454384 (Thread-1836): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e2e0>]}
2020-12-30 18:54:52.455255 (Thread-1836): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:54:53.889807 (Thread-1837): handling poll request
2020-12-30 18:54:53.890244 (Thread-1837): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ea60>]}
2020-12-30 18:54:53.891116 (Thread-1837): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:54:55.314016 (Thread-1838): handling poll request
2020-12-30 18:54:55.314463 (Thread-1838): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447f70>]}
2020-12-30 18:54:55.315354 (Thread-1838): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:54:56.742494 (Thread-1839): handling poll request
2020-12-30 18:54:56.742925 (Thread-1839): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447fd0>]}
2020-12-30 18:54:56.743800 (Thread-1839): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:54:58.163734 (Thread-1840): handling poll request
2020-12-30 18:54:58.164166 (Thread-1840): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44479d0>]}
2020-12-30 18:54:58.165088 (Thread-1840): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:54:59.593967 (Thread-1841): handling poll request
2020-12-30 18:54:59.594407 (Thread-1841): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44479a0>]}
2020-12-30 18:54:59.595290 (Thread-1841): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:55:01.050306 (Thread-1842): handling poll request
2020-12-30 18:55:01.050730 (Thread-1842): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40256a0>]}
2020-12-30 18:55:01.051867 (Thread-1842): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:55:02.482618 (Thread-1843): handling poll request
2020-12-30 18:55:02.483049 (Thread-1843): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025d00>]}
2020-12-30 18:55:02.483923 (Thread-1843): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:55:03.910929 (Thread-1844): handling poll request
2020-12-30 18:55:03.911359 (Thread-1844): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025b80>]}
2020-12-30 18:55:03.912228 (Thread-1844): sending response (<Response 285 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:55:05.317479 (Thread-1845): handling poll request
2020-12-30 18:55:05.317942 (Thread-1845): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5190>]}
2020-12-30 18:55:05.318856 (Thread-1845): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:55:06.745210 (Thread-1846): handling poll request
2020-12-30 18:55:06.745640 (Thread-1846): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f51f0>]}
2020-12-30 18:55:06.746505 (Thread-1846): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:55:08.228356 (Thread-1847): handling poll request
2020-12-30 18:55:08.228784 (Thread-1847): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5c40>]}
2020-12-30 18:55:08.229688 (Thread-1847): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:55:09.676037 (Thread-1848): handling poll request
2020-12-30 18:55:09.676845 (Thread-1848): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5ac0>]}
2020-12-30 18:55:09.677757 (Thread-1848): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:55:11.104861 (Thread-1849): handling poll request
2020-12-30 18:55:11.105320 (Thread-1849): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44f5820>]}
2020-12-30 18:55:11.106232 (Thread-1849): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:55:12.569471 (Thread-1850): handling poll request
2020-12-30 18:55:12.569891 (Thread-1850): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025be0>]}
2020-12-30 18:55:12.570754 (Thread-1850): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:55:14.030687 (Thread-1851): handling poll request
2020-12-30 18:55:14.031136 (Thread-1851): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d40252e0>]}
2020-12-30 18:55:14.032018 (Thread-1851): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:55:15.525333 (Thread-1852): handling poll request
2020-12-30 18:55:15.525760 (Thread-1852): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4025040>]}
2020-12-30 18:55:15.526645 (Thread-1852): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:55:16.962413 (Thread-1853): handling poll request
2020-12-30 18:55:16.962840 (Thread-1853): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447910>]}
2020-12-30 18:55:16.963712 (Thread-1853): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:55:18.370432 (Thread-1854): handling poll request
2020-12-30 18:55:18.370860 (Thread-1854): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44473d0>]}
2020-12-30 18:55:18.371725 (Thread-1854): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:55:19.811122 (Thread-1855): handling poll request
2020-12-30 18:55:19.811551 (Thread-1855): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447be0>]}
2020-12-30 18:55:19.812420 (Thread-1855): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:55:21.261735 (Thread-1856): handling poll request
2020-12-30 18:55:21.262166 (Thread-1856): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447e20>]}
2020-12-30 18:55:21.263050 (Thread-1856): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:55:22.678797 (Thread-1857): handling poll request
2020-12-30 18:55:22.679382 (Thread-1857): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ef40>]}
2020-12-30 18:55:22.680597 (Thread-1857): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:55:24.114953 (Thread-1858): handling poll request
2020-12-30 18:55:24.115383 (Thread-1858): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403eac0>]}
2020-12-30 18:55:24.116263 (Thread-1858): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:55:25.631773 (Thread-1859): handling poll request
2020-12-30 18:55:25.632200 (Thread-1859): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ebe0>]}
2020-12-30 18:55:25.633097 (Thread-1859): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.229
2020-12-30 18:55:27.028364 (Thread-1860): handling poll request
2020-12-30 18:55:27.028790 (Thread-1860): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993250>]}
2020-12-30 18:55:27.029714 (Thread-1860): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:55:28.443886 (Thread-1861): handling poll request
2020-12-30 18:55:28.444345 (Thread-1861): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49935e0>]}
2020-12-30 18:55:28.445271 (Thread-1861): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:55:29.867906 (Thread-1862): handling poll request
2020-12-30 18:55:29.868345 (Thread-1862): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993e50>]}
2020-12-30 18:55:29.869250 (Thread-1862): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:55:31.306573 (Thread-1863): handling poll request
2020-12-30 18:55:31.307010 (Thread-1863): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48bb7f0>]}
2020-12-30 18:55:31.438730 (Thread-1863): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:55:32.862906 (Thread-1864): handling poll request
2020-12-30 18:55:32.863349 (Thread-1864): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49932e0>]}
2020-12-30 18:55:32.864283 (Thread-1864): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:55:34.283280 (Thread-1865): handling poll request
2020-12-30 18:55:34.283726 (Thread-1865): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d49932b0>]}
2020-12-30 18:55:34.284608 (Thread-1865): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:55:35.700036 (Thread-1866): handling poll request
2020-12-30 18:55:35.700460 (Thread-1866): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e580>]}
2020-12-30 18:55:35.701374 (Thread-1866): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:55:37.115859 (Thread-1867): handling poll request
2020-12-30 18:55:37.116297 (Thread-1867): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e700>]}
2020-12-30 18:55:37.117189 (Thread-1867): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:55:38.565007 (Thread-1868): handling poll request
2020-12-30 18:55:38.565460 (Thread-1868): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562730>]}
2020-12-30 18:55:38.566326 (Thread-1868): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:55:40.006098 (Thread-1869): handling poll request
2020-12-30 18:55:40.006526 (Thread-1869): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562250>]}
2020-12-30 18:55:40.007401 (Thread-1869): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:55:41.451500 (Thread-1870): handling poll request
2020-12-30 18:55:41.451929 (Thread-1870): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d45629a0>]}
2020-12-30 18:55:41.452827 (Thread-1870): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:55:42.893996 (Thread-1871): handling poll request
2020-12-30 18:55:42.894444 (Thread-1871): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562490>]}
2020-12-30 18:55:42.895318 (Thread-1871): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:55:44.313844 (Thread-1872): handling poll request
2020-12-30 18:55:44.314283 (Thread-1872): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447ca0>]}
2020-12-30 18:55:44.315150 (Thread-1872): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:55:45.768173 (Thread-1873): handling poll request
2020-12-30 18:55:45.768601 (Thread-1873): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447fd0>]}
2020-12-30 18:55:45.769510 (Thread-1873): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:55:47.259666 (Thread-1874): handling poll request
2020-12-30 18:55:47.260103 (Thread-1874): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447160>]}
2020-12-30 18:55:47.261028 (Thread-1874): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:55:48.673804 (Thread-1875): handling poll request
2020-12-30 18:55:48.674272 (Thread-1875): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447e50>]}
2020-12-30 18:55:48.675173 (Thread-1875): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:55:50.117417 (Thread-1876): handling poll request
2020-12-30 18:55:50.117832 (Thread-1876): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d48cd5e0>]}
2020-12-30 18:55:50.118694 (Thread-1876): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.114
2020-12-30 18:55:51.538494 (Thread-1877): handling poll request
2020-12-30 18:55:51.538914 (Thread-1877): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2e20>]}
2020-12-30 18:55:51.539853 (Thread-1877): sending response (<Response 286 bytes [200 OK]>) to 10.0.14.128
2020-12-30 18:55:52.978920 (Thread-1878): handling poll request
2020-12-30 18:55:52.979343 (Thread-1878): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff23a0>]}
2020-12-30 18:55:52.980614 (Thread-1878): sending response (<Response 286 bytes [200 OK]>) to 10.0.32.144
2020-12-30 18:55:54.442134 (Thread-1879): handling poll request
2020-12-30 18:55:54.442561 (Thread-1879): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993490>]}
2020-12-30 18:55:54.443463 (Thread-1879): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:55:55.981463 (Thread-1880): handling poll request
2020-12-30 18:55:55.981892 (Thread-1880): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993970>]}
2020-12-30 18:55:55.982783 (Thread-1880): sending response (<Response 286 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:55:57.434476 (Thread-1881): handling poll request
2020-12-30 18:55:57.434890 (Thread-1881): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4993250>]}
2020-12-30 18:55:57.435753 (Thread-1881): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:55:58.959221 (Thread-1882): handling poll request
2020-12-30 18:55:58.959663 (Thread-1882): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447be0>]}
2020-12-30 18:55:58.960530 (Thread-1882): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:56:00.899798 (Thread-1883): handling poll request
2020-12-30 18:56:00.900221 (Thread-1883): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447a60>]}
2020-12-30 18:56:00.901101 (Thread-1883): sending response (<Response 286 bytes [200 OK]>) to 10.0.36.232
2020-12-30 18:56:02.849739 (Thread-1884): handling poll request
2020-12-30 18:56:02.850171 (Thread-1884): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44474c0>]}
2020-12-30 18:56:02.851096 (Thread-1884): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.54
2020-12-30 18:56:04.279299 (Thread-1885): handling poll request
2020-12-30 18:56:04.279720 (Thread-1885): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447d00>]}
2020-12-30 18:56:04.280597 (Thread-1885): sending response (<Response 286 bytes [200 OK]>) to 10.0.18.95
2020-12-30 18:56:05.774123 (Thread-1886): handling poll request
2020-12-30 18:56:05.774574 (Thread-1886): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d44474f0>]}
2020-12-30 18:56:05.775447 (Thread-1886): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:56:07.216588 (Thread-1887): handling poll request
2020-12-30 18:56:07.217021 (Thread-1887): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ea60>]}
2020-12-30 18:56:07.217953 (Thread-1887): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:56:08.667289 (Thread-1888): handling poll request
2020-12-30 18:56:08.667711 (Thread-1888): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e400>]}
2020-12-30 18:56:08.668587 (Thread-1888): sending response (<Response 285 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:56:10.091158 (Thread-1889): handling poll request
2020-12-30 18:56:10.091598 (Thread-1889): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562bb0>]}
2020-12-30 18:56:10.092491 (Thread-1889): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:56:11.547124 (Thread-1890): handling poll request
2020-12-30 18:56:11.547552 (Thread-1890): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562730>]}
2020-12-30 18:56:11.548427 (Thread-1890): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:56:12.963328 (Thread-1891): handling poll request
2020-12-30 18:56:12.963751 (Thread-1891): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562fa0>]}
2020-12-30 18:56:12.964636 (Thread-1891): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:56:14.421754 (Thread-1892): handling poll request
2020-12-30 18:56:14.422180 (Thread-1892): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562910>]}
2020-12-30 18:56:14.423050 (Thread-1892): sending response (<Response 286 bytes [200 OK]>) to 10.0.23.172
2020-12-30 18:56:15.865818 (Thread-1893): handling poll request
2020-12-30 18:56:15.866239 (Thread-1893): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cfff2ee0>]}
2020-12-30 18:56:15.972158 (Thread-1893): sending response (<Response 285 bytes [200 OK]>) to 10.0.33.186
2020-12-30 18:56:17.411494 (Thread-1894): handling poll request
2020-12-30 18:56:17.411910 (Thread-1894): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4562340>]}
2020-12-30 18:56:17.412781 (Thread-1894): sending response (<Response 286 bytes [200 OK]>) to 10.0.9.208
2020-12-30 18:56:18.836556 (Thread-1895): handling poll request
2020-12-30 18:56:18.836977 (Thread-1895): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403ec40>]}
2020-12-30 18:56:18.837891 (Thread-1895): sending response (<Response 286 bytes [200 OK]>) to 10.0.19.64
2020-12-30 18:56:20.317025 (Thread-1896): handling poll request
2020-12-30 18:56:20.317471 (Thread-1896): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d403e640>]}
2020-12-30 18:56:20.318336 (Thread-1896): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.235
2020-12-30 18:56:21.749696 (Thread-1897): handling poll request
2020-12-30 18:56:21.750122 (Thread-1897): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401bc40>]}
2020-12-30 18:56:21.750984 (Thread-1897): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.38
2020-12-30 18:56:23.218888 (Thread-1898): handling poll request
2020-12-30 18:56:23.219300 (Thread-1898): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d401bfa0>]}
2020-12-30 18:56:23.220149 (Thread-1898): sending response (<Response 286 bytes [200 OK]>) to 10.0.37.157
2020-12-30 18:56:23.322340 (Thread-1): SQL status: SUCCESS 1 in 470.98 seconds
2020-12-30 18:56:23.323329 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented: COMMIT
2020-12-30 18:56:23.323449 (Thread-1): Using snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2020-12-30 18:56:23.323496 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented: COMMIT
2020-12-30 18:56:23.386537 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2020-12-30 18:56:23.388516 (Thread-1): finished collecting timing info
2020-12-30 18:56:23.388737 (Thread-1): On model.sales_dataflo.Fact_Sales_Segmented: Close
2020-12-30 18:56:23.459656 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4f8597-b063-4c62-be5d-44efa5504ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfac80670>]}
2020-12-30 18:56:23.587867 (Thread-1): 18:56:23 | 30 of 30 OK created table model dbt_salesdataflo.Fact_Sales_Segmented [SUCCESS 1 in 471.87s]
2020-12-30 18:56:23.588011 (Thread-1): Finished running node model.sales_dataflo.Fact_Sales_Segmented
2020-12-30 18:56:23.589442 (MainThread): Acquiring new snowflake connection "master".
2020-12-30 18:56:23.589617 (MainThread): Using snowflake connection "master".
2020-12-30 18:56:23.589671 (MainThread): On master: BEGIN
2020-12-30 18:56:23.589725 (MainThread): Opening a new connection, currently in state closed
2020-12-30 18:56:24.130571 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2020-12-30 18:56:24.130733 (MainThread): On master: COMMIT
2020-12-30 18:56:24.130829 (MainThread): Using snowflake connection "master".
2020-12-30 18:56:24.130875 (MainThread): On master: COMMIT
2020-12-30 18:56:24.251800 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2020-12-30 18:56:24.251968 (MainThread): On master: Close
2020-12-30 18:56:24.324645 (MainThread): 18:56:24 | 
2020-12-30 18:56:24.324779 (MainThread): 18:56:24 | Finished running 10 table models, 9 incremental models, 11 view models in 788.41s.
2020-12-30 18:56:24.324839 (MainThread): Connection 'master' was properly closed.
2020-12-30 18:56:24.324882 (MainThread): Connection 'model.sales_dataflo.Fact_Sales_Segmented' was properly closed.
2020-12-30 18:56:24.432936 (MainThread): 
2020-12-30 18:56:24.433117 (MainThread): Completed with 2 errors and 0 warnings:
2020-12-30 18:56:24.433179 (MainThread): 
2020-12-30 18:56:24.433235 (MainThread): Database Error in model Dim_Product (ETL/Target/Tables/Dim_Product.sql)
2020-12-30 18:56:24.433279 (MainThread):   001003 (42000): SQL compilation error:
2020-12-30 18:56:24.433317 (MainThread):   syntax error line 39 at position 6 unexpected ')'.
2020-12-30 18:56:24.433354 (MainThread):   compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Product.sql
2020-12-30 18:56:24.433394 (MainThread): 
2020-12-30 18:56:24.433439 (MainThread): Database Error in model Dim_Employee_Hier (ETL/Target/Tables/Dim_Employee_Hier.sql)
2020-12-30 18:56:24.433479 (MainThread):   001003 (42000): SQL compilation error:
2020-12-30 18:56:24.433521 (MainThread):   syntax error line 12 at position 2 unexpected '.'.
2020-12-30 18:56:24.433558 (MainThread):   syntax error line 14 at position 1 unexpected 'from'.
2020-12-30 18:56:24.433594 (MainThread):   syntax error line 18 at position 3 unexpected 'rslt'.
2020-12-30 18:56:24.433630 (MainThread):   syntax error line 21 at position 1 unexpected ')'.
2020-12-30 18:56:24.433666 (MainThread):   compiled SQL at target/run/sales_dataflo/ETL/Target/Tables/Dim_Employee_Hier.sql
2020-12-30 18:56:24.433728 (MainThread): 
Done. PASS=28 WARN=0 ERROR=2 SKIP=0 TOTAL=30
2020-12-30 18:56:24.656492 (Thread-1899): handling poll request
2020-12-30 18:56:24.656932 (Thread-1899): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4447eb0>]}
2020-12-30 18:56:24.726362 (Thread-1899): sending response (<Response 376120 bytes [200 OK]>) to 10.0.13.204
2020-12-30 18:56:26.710406 (Thread-1900): handling status request
2020-12-30 18:56:26.710847 (Thread-1900): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edd78421-ed5c-42ed-ab53-0d1d8e1b3f0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36d4c4b190>]}
2020-12-30 18:56:26.711912 (Thread-1900): sending response (<Response 1241 bytes [200 OK]>) to 10.0.9.114
2020-12-31 05:05:59.993397 (MainThread): Running with dbt=0.18.1
2020-12-31 05:06:00.296385 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2020-12-31 05:06:00.307831 (MainThread): Tracking: tracking
2020-12-31 05:06:00.308011 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22fdc27d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e2f34910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e2f468e0>]}
2020-12-31 05:06:00.308327 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=13
2020-12-31 05:06:00.313878 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2020-12-31 05:06:00.317196 (MainThread): Send requests to http://localhost:8580/jsonrpc
2020-12-31 05:06:00.394204 (Thread-1): Parsing macros/Segmented_Calc.sql
2020-12-31 05:06:00.399131 (Thread-1): Parsing macros/NS_History_Calc.sql
2020-12-31 05:06:00.410070 (Thread-1): Parsing macros/NS_Calc.sql
2020-12-31 05:06:00.417725 (Thread-1): Parsing macros/Segmented_History_Calc.sql
2020-12-31 05:06:00.427188 (Thread-1): Parsing macros/Archive/NS_Opportunity_History.sql
2020-12-31 05:06:00.434546 (Thread-1): Parsing macros/Archive/NS_Account_History.sql
2020-12-31 05:06:00.441860 (Thread-1): Parsing macros/Archive/NS_Lead_History.sql
2020-12-31 05:06:00.448979 (Thread-1): Parsing macros/Archive/NS_Contact_History.sql
2020-12-31 05:06:00.451732 (Thread-1): Parsing macros/adapters.sql
2020-12-31 05:06:00.480455 (Thread-2): handling status request
2020-12-31 05:06:00.480956 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e26ebe80>]}
2020-12-31 05:06:00.482603 (Thread-2): sending response (<Response 184 bytes [200 OK]>) to 10.0.23.172
2020-12-31 05:06:00.483521 (Thread-1): Parsing macros/catalog.sql
2020-12-31 05:06:00.487172 (Thread-1): Parsing macros/materializations/table.sql
2020-12-31 05:06:00.493858 (Thread-1): Parsing macros/materializations/merge.sql
2020-12-31 05:06:00.496965 (Thread-1): Parsing macros/materializations/view.sql
2020-12-31 05:06:00.498388 (Thread-1): Parsing macros/materializations/incremental.sql
2020-12-31 05:06:00.508242 (Thread-1): Parsing macros/core.sql
2020-12-31 05:06:00.511877 (Thread-1): Parsing macros/adapters/common.sql
2020-12-31 05:06:00.555054 (Thread-1): Parsing macros/materializations/helpers.sql
2020-12-31 05:06:00.563688 (Thread-1): Parsing macros/materializations/table/table.sql
2020-12-31 05:06:00.570402 (Thread-1): Parsing macros/materializations/seed/seed.sql
2020-12-31 05:06:00.596134 (Thread-1): Parsing macros/materializations/view/view.sql
2020-12-31 05:06:00.605594 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2020-12-31 05:06:00.611078 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2020-12-31 05:06:00.612897 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2020-12-31 05:06:00.619396 (Thread-1): Parsing macros/materializations/common/merge.sql
2020-12-31 05:06:00.633310 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2020-12-31 05:06:00.657986 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-12-31 05:06:00.660083 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2020-12-31 05:06:00.688233 (Thread-1): Parsing macros/schema_tests/relationships.sql
2020-12-31 05:06:00.690104 (Thread-1): Parsing macros/schema_tests/not_null.sql
2020-12-31 05:06:00.691700 (Thread-1): Parsing macros/schema_tests/unique.sql
2020-12-31 05:06:00.693364 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2020-12-31 05:06:00.695951 (Thread-1): Parsing macros/etc/get_custom_database.sql
2020-12-31 05:06:00.697562 (Thread-1): Parsing macros/etc/query.sql
2020-12-31 05:06:00.698618 (Thread-1): Parsing macros/etc/datetime.sql
2020-12-31 05:06:00.707158 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2020-12-31 05:06:00.708103 (Thread-1): Parsing macros/etc/is_incremental.sql
2020-12-31 05:06:00.709679 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2020-12-31 05:06:00.734980 (Thread-1): Parsing macros/logger/pretty_time.sql
2020-12-31 05:06:00.742689 (Thread-1): Parsing macros/logger/log_info.sql
2020-12-31 05:06:00.748293 (Thread-1): Parsing macros/logger/pretty_log_format.sql
2020-12-31 05:06:00.754728 (Thread-1): Parsing macros/sql/pivot.sql
2020-12-31 05:06:00.763476 (Thread-1): Parsing macros/sql/star.sql
2020-12-31 05:06:00.771026 (Thread-1): Parsing macros/sql/surrogate_key.sql
2020-12-31 05:06:00.779906 (Thread-1): Parsing macros/sql/get_query_results_as_dict.sql
2020-12-31 05:06:00.786292 (Thread-1): Parsing macros/sql/get_column_values.sql
2020-12-31 05:06:00.796437 (Thread-1): Parsing macros/sql/groupby.sql
2020-12-31 05:06:00.803479 (Thread-1): Parsing macros/sql/get_tables_by_pattern_sql.sql
2020-12-31 05:06:00.815280 (Thread-1): Parsing macros/sql/nullcheck_table.sql
2020-12-31 05:06:00.821033 (Thread-1): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-12-31 05:06:00.827321 (Thread-1): Parsing macros/sql/get_relations_by_pattern.sql
2020-12-31 05:06:00.835022 (Thread-1): Parsing macros/sql/get_relations_by_prefix.sql
2020-12-31 05:06:00.842958 (Thread-1): Parsing macros/sql/safe_add.sql
2020-12-31 05:06:00.850498 (Thread-1): Parsing macros/sql/unpivot.sql
2020-12-31 05:06:00.866157 (Thread-1): Parsing macros/sql/generate_series.sql
2020-12-31 05:06:00.886659 (Thread-1): Parsing macros/sql/nullcheck.sql
2020-12-31 05:06:00.893601 (Thread-1): Parsing macros/sql/union.sql
2020-12-31 05:06:00.912787 (Thread-1): Parsing macros/materializations/insert_by_period_materialization.sql
2020-12-31 05:06:00.942603 (Thread-1): Parsing macros/web/get_url_parameter.sql
2020-12-31 05:06:00.950289 (Thread-1): Parsing macros/web/get_url_path.sql
2020-12-31 05:06:00.956943 (Thread-1): Parsing macros/web/get_url_host.sql
2020-12-31 05:06:00.963854 (Thread-1): Parsing macros/datetime/date_spine.sql
2020-12-31 05:06:00.972713 (Thread-1): Parsing macros/schema_tests/expression_is_true.sql
2020-12-31 05:06:00.978664 (Thread-1): Parsing macros/schema_tests/not_constant.sql
2020-12-31 05:06:00.986144 (Thread-1): Parsing macros/schema_tests/at_least_one.sql
2020-12-31 05:06:00.993118 (Thread-1): Parsing macros/schema_tests/equality.sql
2020-12-31 05:06:01.003110 (Thread-1): Parsing macros/schema_tests/test_not_null_where.sql
2020-12-31 05:06:01.010114 (Thread-1): Parsing macros/schema_tests/equal_rowcount.sql
2020-12-31 05:06:01.017351 (Thread-1): Parsing macros/schema_tests/test_unique_where.sql
2020-12-31 05:06:01.026719 (Thread-1): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-12-31 05:06:01.037478 (Thread-1): Parsing macros/schema_tests/relationships_where.sql
2020-12-31 05:06:01.045000 (Thread-1): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-12-31 05:06:01.053205 (Thread-1): Parsing macros/schema_tests/recency.sql
2020-12-31 05:06:01.060960 (Thread-1): Parsing macros/schema_tests/cardinality_equality.sql
2020-12-31 05:06:01.069388 (Thread-1): Parsing macros/geo/haversine_distance.sql
2020-12-31 05:06:01.075617 (Thread-1): Parsing macros/cross_db_utils/split_part.sql
2020-12-31 05:06:01.082425 (Thread-1): Parsing macros/cross_db_utils/length.sql
2020-12-31 05:06:01.088918 (Thread-1): Parsing macros/cross_db_utils/current_timestamp.sql
2020-12-31 05:06:01.099850 (Thread-1): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2020-12-31 05:06:01.106397 (Thread-1): Parsing macros/cross_db_utils/right.sql
2020-12-31 05:06:01.114573 (Thread-1): Parsing macros/cross_db_utils/hash.sql
2020-12-31 05:06:01.121962 (Thread-1): Parsing macros/cross_db_utils/replace.sql
2020-12-31 05:06:01.130241 (Thread-1): Parsing macros/cross_db_utils/concat.sql
2020-12-31 05:06:01.140521 (Thread-1): Parsing macros/cross_db_utils/_is_relation.sql
2020-12-31 05:06:01.147011 (Thread-1): Parsing macros/cross_db_utils/identifier.sql
2020-12-31 05:06:01.155102 (Thread-1): Parsing macros/cross_db_utils/datediff.sql
2020-12-31 05:06:01.174697 (Thread-1): Parsing macros/cross_db_utils/dateadd.sql
2020-12-31 05:06:01.185015 (Thread-1): Parsing macros/cross_db_utils/datatypes.sql
2020-12-31 05:06:01.204295 (Thread-1): Parsing macros/cross_db_utils/position.sql
2020-12-31 05:06:01.215066 (Thread-1): Parsing macros/cross_db_utils/literal.sql
2020-12-31 05:06:01.224363 (Thread-1): Parsing macros/cross_db_utils/_is_ephemeral.sql
2020-12-31 05:06:01.234278 (Thread-1): Parsing macros/cross_db_utils/width_bucket.sql
2020-12-31 05:06:01.248368 (Thread-1): Parsing macros/cross_db_utils/date_trunc.sql
2020-12-31 05:06:01.258472 (Thread-1): Parsing macros/cross_db_utils/except.sql
2020-12-31 05:06:01.266600 (Thread-1): Parsing macros/cross_db_utils/safe_cast.sql
2020-12-31 05:06:01.276178 (Thread-1): Parsing macros/cross_db_utils/last_day.sql
2020-12-31 05:06:01.288233 (Thread-1): Parsing macros/cross_db_utils/intersect.sql
2020-12-31 05:06:01.300266 (Thread-1): Parsing macros/get_date_dimension.sql
2020-12-31 05:06:01.319114 (Thread-1): Parsing macros/get_base_dates.sql
2020-12-31 05:06:01.327242 (Thread-1): Parsing macros/calendar_date/n_weeks_ago.sql
2020-12-31 05:06:01.334262 (Thread-1): Parsing macros/calendar_date/to_unixtimestamp.sql
2020-12-31 05:06:01.344097 (Thread-1): Parsing macros/calendar_date/yesterday.sql
2020-12-31 05:06:01.350302 (Thread-1): Parsing macros/calendar_date/month_name.sql
2020-12-31 05:06:01.359114 (Thread-1): Parsing macros/calendar_date/day_name.sql
2020-12-31 05:06:01.366919 (Thread-1): Parsing macros/calendar_date/_get_utils_namespaces.sql
2020-12-31 05:06:01.374193 (Thread-1): Parsing macros/calendar_date/date_part.sql
2020-12-31 05:06:01.381016 (Thread-1): Parsing macros/calendar_date/n_days_ago.sql
2020-12-31 05:06:01.386749 (Thread-1): Parsing macros/calendar_date/now.sql
2020-12-31 05:06:01.394747 (Thread-1): Parsing macros/calendar_date/n_months_ago.sql
2020-12-31 05:06:01.401801 (Thread-1): Parsing macros/calendar_date/this_week.sql
2020-12-31 05:06:01.409136 (Thread-1): Parsing macros/calendar_date/convert_timezone.sql
2020-12-31 05:06:01.417669 (Thread-1): Parsing macros/calendar_date/periods_since.sql
2020-12-31 05:06:01.424644 (Thread-1): Parsing macros/calendar_date/n_months_away.sql
2020-12-31 05:06:01.430209 (Thread-1): Parsing macros/calendar_date/n_days_away.sql
2020-12-31 05:06:01.437717 (Thread-1): Parsing macros/calendar_date/last_week.sql
2020-12-31 05:06:01.443888 (Thread-1): Parsing macros/calendar_date/n_weeks_away.sql
2020-12-31 05:06:01.449709 (Thread-1): Parsing macros/calendar_date/tomorrow.sql
2020-12-31 05:06:01.456254 (Thread-1): Parsing macros/calendar_date/today.sql
2020-12-31 05:06:01.462478 (Thread-1): Parsing macros/fiscal_date/get_fiscal_periods.sql
2020-12-31 05:06:01.469313 (Thread-1): Parsing macros/fiscal_date/get_fiscal_year_dates.sql
2020-12-31 05:06:01.664188 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-31 05:06:01.696959 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-31 05:06:01.714463 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-31 05:06:01.731674 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Address".
2020-12-31 05:06:01.749595 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-31 05:06:01.771533 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-31 05:06:01.791856 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-31 05:06:01.808626 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-31 05:06:01.824721 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Employee".
2020-12-31 05:06:01.841019 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-31 05:06:01.856880 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-31 05:06:01.872143 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Account".
2020-12-31 05:06:01.889384 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Product".
2020-12-31 05:06:01.900455 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Product model triggered this warning. 
2020-12-31 05:06:01.927643 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test_metrics".
2020-12-31 05:06:01.970443 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-31 05:06:01.976959 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity model triggered this warning. 
2020-12-31 05:06:01.989540 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-31 05:06:01.994979 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Account model triggered this warning. 
2020-12-31 05:06:02.007406 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-31 05:06:02.048285 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Calc".
2020-12-31 05:06:02.071108 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2020-12-31 05:06:02.123250 (Thread-3): handling status request
2020-12-31 05:06:02.123620 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e194f5e0>]}
2020-12-31 05:06:02.124278 (Thread-3): sending response (<Response 184 bytes [200 OK]>) to 10.0.9.208
2020-12-31 05:06:02.129576 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2020-12-31 05:06:02.149357 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test".
2020-12-31 05:06:02.175403 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-31 05:06:02.194994 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-31 05:06:02.245487 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-31 05:06:02.253490 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Lead model triggered this warning. 
2020-12-31 05:06:02.269444 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-31 05:06:02.275876 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-31 05:06:02.277159 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-31 05:06:02.291381 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales".
2020-12-31 05:06:02.313172 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-31 05:06:02.322129 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Contact model triggered this warning. 
2020-12-31 05:06:02.340655 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-31 05:06:02.350052 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Employee model triggered this warning. 
2020-12-31 05:06:02.363343 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-31 05:06:02.368730 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity_Stage model triggered this warning. 
2020-12-31 05:06:02.382432 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-31 05:06:02.388416 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Campaign model triggered this warning. 
2020-12-31 05:06:02.404323 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-31 05:06:02.643546 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dim_date_fiscal".
2020-12-31 05:06:02.683644 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dim_date".
2020-12-31 05:06:02.703141 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dates".
2020-12-31 05:06:02.997983 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 05:06:03.736242 (Thread-4): handling status request
2020-12-31 05:06:03.736698 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e1cae910>]}
2020-12-31 05:06:03.748957 (Thread-4): sending response (<Response 48293 bytes [200 OK]>) to 10.0.33.186
2020-12-31 05:13:35.422329 (Thread-5): handling status request
2020-12-31 05:13:35.422754 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e16ef4c0>]}
2020-12-31 05:13:35.440443 (Thread-5): sending response (<Response 48293 bytes [200 OK]>) to 10.0.37.235
2020-12-31 05:13:35.464854 (Thread-6): handling ps request
2020-12-31 05:13:35.465451 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e16ef520>]}
2020-12-31 05:13:35.467668 (Thread-6): sending response (<Response 104 bytes [200 OK]>) to 10.0.37.157
2020-12-31 05:28:57.115476 (Thread-7): handling status request
2020-12-31 05:28:57.117596 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e177e1c0>]}
2020-12-31 05:28:57.129519 (Thread-7): sending response (<Response 48293 bytes [200 OK]>) to 10.0.37.157
2020-12-31 05:28:57.942275 (Thread-8): handling run_sql request
2020-12-31 05:28:57.942710 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e1690c40>]}
2020-12-31 05:28:57.945461 (Thread-8): Connection 'model.dbt_date.dates' was properly closed.
2020-12-31 05:28:59.006974 (Thread-8): sending response (<Response 137 bytes [200 OK]>) to 10.0.9.208
2020-12-31 05:28:59.025727 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 05:28:59.047725 (MainThread): Found 31 models, 0 tests, 0 snapshots, 0 analyses, 316 macros, 0 operations, 0 seed files, 0 sources
2020-12-31 05:28:59.048237 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 05:28:59.048358 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-31 05:28:59.061649 (Thread-1): finished collecting timing info
2020-12-31 05:28:59.062102 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-31 05:28:59.062169 (Thread-1): On rpc.sales_dataflo.request: select * from SF_SALESFORCE_31122020.account
limit 100
2020-12-31 05:28:59.062224 (Thread-1): Opening a new connection, currently in state init
2020-12-31 05:28:59.856674 (Thread-9): handling poll request
2020-12-31 05:28:59.857259 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e16dd9a0>]}
2020-12-31 05:28:59.861355 (Thread-9): sending response (<Response 2882 bytes [200 OK]>) to 10.0.6.38
2020-12-31 05:29:00.790918 (Thread-1): SQL status: SUCCESS 14 in 1.73 seconds
2020-12-31 05:29:00.796360 (Thread-1): finished collecting timing info
2020-12-31 05:29:00.796766 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-31 05:29:01.514763 (Thread-10): handling poll request
2020-12-31 05:29:01.515396 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e1742520>]}
2020-12-31 05:29:01.522220 (Thread-10): sending response (<Response 16227 bytes [200 OK]>) to 10.0.18.95
2020-12-31 05:38:34.232938 (Thread-11): handling status request
2020-12-31 05:38:34.234609 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e172c040>]}
2020-12-31 05:38:34.247891 (Thread-11): sending response (<Response 48293 bytes [200 OK]>) to 10.0.32.144
2020-12-31 05:38:34.432957 (Thread-12): handling ps request
2020-12-31 05:38:34.433430 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e172c6d0>]}
2020-12-31 05:38:34.434657 (Thread-12): sending response (<Response 607 bytes [200 OK]>) to 10.0.18.95
2020-12-31 05:55:58.020853 (Thread-13): Parsing macros/Archive/NS_Account_History.sql
2020-12-31 05:55:58.350633 (Thread-13): Got an acceptable cached parse result
2020-12-31 05:55:58.939049 (Thread-13): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 05:55:58.984533 (Thread-14): handling status request
2020-12-31 05:55:58.984928 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e19093a0>]}
2020-12-31 05:55:58.985964 (Thread-14): sending response (<Response 1203 bytes [200 OK]>) to 10.0.23.54
2020-12-31 05:56:51.542105 (Thread-15): Parsing macros/Segmented_Calc.sql
2020-12-31 05:56:51.549091 (Thread-15): Parsing macros/NS_Calc.sql
2020-12-31 05:56:51.566551 (Thread-15): Parsing macros/Archive/NS_Contact_History.sql
2020-12-31 05:56:51.895332 (Thread-15): Got an acceptable cached parse result
2020-12-31 05:56:51.967689 (Thread-16): handling status request
2020-12-31 05:56:51.968246 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e158c460>]}
2020-12-31 05:56:51.969229 (Thread-16): sending response (<Response 184 bytes [200 OK]>) to 10.0.36.232
2020-12-31 05:56:52.449291 (Thread-15): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 05:56:53.530042 (Thread-17): handling status request
2020-12-31 05:56:53.530520 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e1ca5c10>]}
2020-12-31 05:56:53.531671 (Thread-17): sending response (<Response 1724 bytes [200 OK]>) to 10.0.32.144
2020-12-31 05:57:31.548088 (Thread-18): Parsing macros/Archive/NS_Account_History.sql
2020-12-31 05:57:31.551711 (Thread-18): Parsing macros/Archive/NS_Lead_History.sql
2020-12-31 05:57:31.885740 (Thread-18): Got an acceptable cached parse result
2020-12-31 05:57:31.937507 (Thread-19): handling status request
2020-12-31 05:57:31.937871 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e13f20a0>]}
2020-12-31 05:57:31.938541 (Thread-19): sending response (<Response 184 bytes [200 OK]>) to 10.0.37.235
2020-12-31 05:57:32.439181 (Thread-18): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 05:57:33.407441 (Thread-20): handling status request
2020-12-31 05:57:33.407878 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e18ce9d0>]}
2020-12-31 05:57:33.408920 (Thread-20): sending response (<Response 1476 bytes [200 OK]>) to 10.0.37.157
2020-12-31 05:57:39.577287 (Thread-21): Parsing macros/Segmented_Calc.sql
2020-12-31 05:57:39.584416 (Thread-21): Parsing macros/NS_Calc.sql
2020-12-31 05:57:39.591496 (Thread-21): Parsing macros/Archive/NS_Opportunity_History.sql
2020-12-31 05:57:39.602448 (Thread-21): Parsing macros/Archive/NS_Contact_History.sql
2020-12-31 05:57:39.919417 (Thread-21): Got an acceptable cached parse result
2020-12-31 05:57:40.040220 (Thread-22): handling status request
2020-12-31 05:57:40.040662 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e16a38b0>]}
2020-12-31 05:57:40.041421 (Thread-22): sending response (<Response 184 bytes [200 OK]>) to 10.0.36.232
2020-12-31 05:57:40.480401 (Thread-21): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 05:57:41.515103 (Thread-23): handling status request
2020-12-31 05:57:41.515536 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e195efd0>]}
2020-12-31 05:57:41.516708 (Thread-23): sending response (<Response 2004 bytes [200 OK]>) to 10.0.32.144
2020-12-31 05:58:57.021339 (Thread-24): Parsing macros/NS_History_Calc.sql
2020-12-31 05:58:57.033987 (Thread-24): Parsing macros/Archive/NS_Account_History.sql
2020-12-31 05:58:57.037787 (Thread-24): Parsing macros/Archive/NS_Lead_History.sql
2020-12-31 05:58:57.360753 (Thread-24): Got an acceptable cached parse result
2020-12-31 05:58:57.925927 (Thread-24): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 05:58:58.025463 (Thread-25): handling status request
2020-12-31 05:58:58.025857 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e145fbe0>]}
2020-12-31 05:58:58.026939 (Thread-25): sending response (<Response 1741 bytes [200 OK]>) to 10.0.24.229
2020-12-31 05:59:38.279122 (Thread-26): Parsing macros/Segmented_Calc.sql
2020-12-31 05:59:38.286393 (Thread-26): Parsing macros/NS_Calc.sql
2020-12-31 05:59:38.290529 (Thread-26): Parsing macros/Segmented_History_Calc.sql
2020-12-31 05:59:38.294104 (Thread-26): Parsing macros/Archive/NS_Opportunity_History.sql
2020-12-31 05:59:38.304214 (Thread-26): Parsing macros/Archive/NS_Contact_History.sql
2020-12-31 05:59:38.635117 (Thread-26): Got an acceptable cached parse result
2020-12-31 05:59:38.767200 (Thread-27): handling status request
2020-12-31 05:59:38.767664 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e18cc190>]}
2020-12-31 05:59:38.776129 (Thread-27): sending response (<Response 184 bytes [200 OK]>) to 10.0.23.54
2020-12-31 05:59:39.221037 (Thread-26): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 05:59:40.378732 (Thread-28): handling status request
2020-12-31 05:59:40.379178 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e161fc40>]}
2020-12-31 05:59:40.380412 (Thread-28): sending response (<Response 2276 bytes [200 OK]>) to 10.0.33.186
2020-12-31 05:59:48.313881 (Thread-29): Parsing macros/NS_History_Calc.sql
2020-12-31 05:59:48.328533 (Thread-29): Parsing macros/Archive/NS_Lead_History.sql
2020-12-31 05:59:48.658883 (Thread-29): Got an acceptable cached parse result
2020-12-31 05:59:48.779424 (Thread-30): handling status request
2020-12-31 05:59:48.779840 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e17e5b80>]}
2020-12-31 05:59:48.780599 (Thread-30): sending response (<Response 184 bytes [200 OK]>) to 10.0.13.204
2020-12-31 05:59:49.206825 (Thread-29): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 05:59:50.259647 (Thread-31): handling status request
2020-12-31 05:59:50.260097 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e18571f0>]}
2020-12-31 05:59:50.261147 (Thread-31): sending response (<Response 1465 bytes [200 OK]>) to 10.0.9.114
2020-12-31 06:00:00.947199 (Thread-32): Parsing macros/Segmented_Calc.sql
2020-12-31 06:00:00.954030 (Thread-32): Parsing macros/NS_Calc.sql
2020-12-31 06:00:00.957333 (Thread-32): Parsing macros/Segmented_History_Calc.sql
2020-12-31 06:00:00.961092 (Thread-32): Parsing macros/Archive/NS_Opportunity_History.sql
2020-12-31 06:00:01.298357 (Thread-32): Got an acceptable cached parse result
2020-12-31 06:00:01.333891 (Thread-33): handling status request
2020-12-31 06:00:01.334350 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e1359fd0>]}
2020-12-31 06:00:01.335159 (Thread-33): sending response (<Response 184 bytes [200 OK]>) to 10.0.37.235
2020-12-31 06:00:01.874578 (Thread-32): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 06:00:03.018134 (Thread-34): handling status request
2020-12-31 06:00:03.018584 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e17ee3d0>]}
2020-12-31 06:00:03.019798 (Thread-34): sending response (<Response 2000 bytes [200 OK]>) to 10.0.36.232
2020-12-31 06:00:17.658969 (Thread-35): Parsing macros/NS_History_Calc.sql
2020-12-31 06:00:18.102713 (Thread-36): handling status request
2020-12-31 06:00:18.102904 (Thread-35): Got an acceptable cached parse result
2020-12-31 06:00:18.103345 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e14820d0>]}
2020-12-31 06:00:18.114263 (Thread-36): sending response (<Response 184 bytes [200 OK]>) to 10.0.37.235
2020-12-31 06:00:18.534518 (Thread-35): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 06:00:19.725379 (Thread-37): handling status request
2020-12-31 06:00:19.725815 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e17aa310>]}
2020-12-31 06:00:19.726787 (Thread-37): sending response (<Response 1192 bytes [200 OK]>) to 10.0.9.208
2020-12-31 06:00:31.350448 (Thread-38): Parsing macros/Segmented_Calc.sql
2020-12-31 06:00:31.357835 (Thread-38): Parsing macros/NS_Calc.sql
2020-12-31 06:00:31.361899 (Thread-38): Parsing macros/Segmented_History_Calc.sql
2020-12-31 06:00:31.696552 (Thread-38): Got an acceptable cached parse result
2020-12-31 06:00:31.765642 (Thread-39): handling status request
2020-12-31 06:00:31.766119 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e14af880>]}
2020-12-31 06:00:31.766870 (Thread-39): sending response (<Response 184 bytes [200 OK]>) to 10.0.37.235
2020-12-31 06:00:32.298048 (Thread-38): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 06:00:33.375462 (Thread-40): handling status request
2020-12-31 06:00:33.376046 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e1753ca0>]}
2020-12-31 06:00:33.541856 (Thread-40): sending response (<Response 1720 bytes [200 OK]>) to 10.0.23.54
2020-12-31 06:28:55.798851 (Thread-41): Parsing macros/NS_History_Calc.sql
2020-12-31 06:28:56.136247 (Thread-41): Got an acceptable cached parse result
2020-12-31 06:28:56.230579 (Thread-41): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-31 06:28:56.726587 (Thread-41): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 06:28:56.758883 (Thread-42): handling status request
2020-12-31 06:28:56.759359 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e15e95b0>]}
2020-12-31 06:28:56.760351 (Thread-42): sending response (<Response 1501 bytes [200 OK]>) to 10.0.9.208
2020-12-31 06:48:45.500043 (MainThread): Connection 'model.sales_dataflo.Fact_Sales_History' was properly closed.
2020-12-31 06:48:45.614979 (Thread-43): Parsing macros/Segmented_Calc.sql
2020-12-31 06:48:45.622682 (Thread-43): Parsing macros/NS_Calc.sql
2020-12-31 06:48:45.626024 (Thread-43): Parsing macros/Segmented_History_Calc.sql
2020-12-31 06:48:45.970049 (Thread-43): Got an acceptable cached parse result
2020-12-31 06:48:46.103466 (Thread-43): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales".
2020-12-31 06:48:46.415739 (Thread-44): handling status request
2020-12-31 06:48:46.416180 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e146ef10>]}
2020-12-31 06:48:46.416909 (Thread-44): sending response (<Response 184 bytes [200 OK]>) to 10.0.14.128
2020-12-31 06:48:46.563931 (Thread-43): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 06:48:48.016923 (Thread-45): handling status request
2020-12-31 06:48:48.017329 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e2f641c0>]}
2020-12-31 06:48:48.018458 (Thread-45): sending response (<Response 2021 bytes [200 OK]>) to 10.0.36.232
2020-12-31 06:49:59.487174 (MainThread): Connection 'model.sales_dataflo.Fact_Sales' was properly closed.
2020-12-31 06:49:59.599456 (Thread-46): Parsing macros/NS_History_Calc.sql
2020-12-31 06:49:59.937965 (Thread-46): Got an acceptable cached parse result
2020-12-31 06:50:00.076757 (Thread-46): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-31 06:50:00.395524 (Thread-47): handling status request
2020-12-31 06:50:00.395961 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e1bda9a0>]}
2020-12-31 06:50:00.396618 (Thread-47): sending response (<Response 184 bytes [200 OK]>) to 10.0.24.229
2020-12-31 06:50:00.521289 (Thread-46): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 06:50:01.853445 (Thread-48): handling status request
2020-12-31 06:50:01.853852 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e1acb2e0>]}
2020-12-31 06:50:01.854821 (Thread-48): sending response (<Response 1511 bytes [200 OK]>) to 10.0.6.38
2020-12-31 06:50:13.778389 (MainThread): Connection 'model.sales_dataflo.Fact_Sales_Segmented_History' was properly closed.
2020-12-31 06:50:13.865396 (Thread-49): Parsing macros/Segmented_Calc.sql
2020-12-31 06:50:13.871812 (Thread-49): Parsing macros/NS_Calc.sql
2020-12-31 06:50:13.875350 (Thread-49): Parsing macros/Segmented_History_Calc.sql
2020-12-31 06:50:14.187956 (Thread-49): Got an acceptable cached parse result
2020-12-31 06:50:14.226852 (Thread-50): handling status request
2020-12-31 06:50:14.227426 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e192c430>]}
2020-12-31 06:50:14.228115 (Thread-50): sending response (<Response 184 bytes [200 OK]>) to 10.0.23.172
2020-12-31 06:50:14.292415 (Thread-49): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2020-12-31 06:50:14.790035 (Thread-49): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2020-12-31 06:50:15.820906 (Thread-51): handling status request
2020-12-31 06:50:15.821316 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'eb95f2c8-63fd-494b-973a-ced122e17164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22e1738160>]}
2020-12-31 06:50:15.822472 (Thread-51): sending response (<Response 2031 bytes [200 OK]>) to 10.0.37.235
2020-12-31 14:09:25.238654 (MainThread): Running with dbt=0.18.1
2020-12-31 14:09:25.502600 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2020-12-31 14:09:25.521421 (MainThread): Tracking: tracking
2020-12-31 14:09:25.525187 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e82e6cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8e000fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e82e82d30>]}
2020-12-31 14:09:25.525604 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=14
2020-12-31 14:09:25.526103 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2020-12-31 14:09:25.526432 (MainThread): Send requests to http://localhost:8580/jsonrpc
2020-12-31 14:09:25.611445 (Thread-1): Parsing macros/Segmented_Calc.sql
2020-12-31 14:09:25.614947 (Thread-1): Parsing macros/NS_History_Calc.sql
2020-12-31 14:09:25.617579 (Thread-1): Parsing macros/NS_Calc.sql
2020-12-31 14:09:25.619985 (Thread-1): Parsing macros/Segmented_History_Calc.sql
2020-12-31 14:09:25.620494 (Thread-1): Parsing macros/adapters.sql
2020-12-31 14:09:25.633806 (Thread-2): handling status request
2020-12-31 14:09:25.634217 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e89d29850>]}
2020-12-31 14:09:25.640921 (Thread-2): sending response (<Response 184 bytes [200 OK]>) to 10.0.13.204
2020-12-31 14:09:25.653068 (Thread-1): Parsing macros/catalog.sql
2020-12-31 14:09:25.655482 (Thread-1): Parsing macros/materializations/table.sql
2020-12-31 14:09:25.662355 (Thread-1): Parsing macros/materializations/merge.sql
2020-12-31 14:09:25.665603 (Thread-1): Parsing macros/materializations/view.sql
2020-12-31 14:09:25.667056 (Thread-1): Parsing macros/materializations/incremental.sql
2020-12-31 14:09:25.676828 (Thread-1): Parsing macros/core.sql
2020-12-31 14:09:25.680395 (Thread-1): Parsing macros/adapters/common.sql
2020-12-31 14:09:25.722380 (Thread-1): Parsing macros/materializations/helpers.sql
2020-12-31 14:09:25.730988 (Thread-1): Parsing macros/materializations/table/table.sql
2020-12-31 14:09:25.737598 (Thread-1): Parsing macros/materializations/seed/seed.sql
2020-12-31 14:09:25.757426 (Thread-1): Parsing macros/materializations/view/view.sql
2020-12-31 14:09:25.763450 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2020-12-31 14:09:25.768203 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2020-12-31 14:09:25.770006 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2020-12-31 14:09:25.776341 (Thread-1): Parsing macros/materializations/common/merge.sql
2020-12-31 14:09:25.789706 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2020-12-31 14:09:25.805526 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-12-31 14:09:25.807261 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2020-12-31 14:09:25.834401 (Thread-1): Parsing macros/schema_tests/relationships.sql
2020-12-31 14:09:25.836259 (Thread-1): Parsing macros/schema_tests/not_null.sql
2020-12-31 14:09:25.837773 (Thread-1): Parsing macros/schema_tests/unique.sql
2020-12-31 14:09:25.839431 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2020-12-31 14:09:25.842050 (Thread-1): Parsing macros/etc/get_custom_database.sql
2020-12-31 14:09:25.843708 (Thread-1): Parsing macros/etc/query.sql
2020-12-31 14:09:25.844747 (Thread-1): Parsing macros/etc/datetime.sql
2020-12-31 14:09:25.853289 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2020-12-31 14:09:25.854264 (Thread-1): Parsing macros/etc/is_incremental.sql
2020-12-31 14:09:25.855829 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2020-12-31 14:09:25.876569 (Thread-1): Parsing macros/logger/pretty_time.sql
2020-12-31 14:09:25.881230 (Thread-1): Parsing macros/logger/log_info.sql
2020-12-31 14:09:25.886140 (Thread-1): Parsing macros/logger/pretty_log_format.sql
2020-12-31 14:09:25.890624 (Thread-1): Parsing macros/sql/pivot.sql
2020-12-31 14:09:25.897103 (Thread-1): Parsing macros/sql/star.sql
2020-12-31 14:09:25.903567 (Thread-1): Parsing macros/sql/surrogate_key.sql
2020-12-31 14:09:25.910586 (Thread-1): Parsing macros/sql/get_query_results_as_dict.sql
2020-12-31 14:09:25.916310 (Thread-1): Parsing macros/sql/get_column_values.sql
2020-12-31 14:09:25.924339 (Thread-1): Parsing macros/sql/groupby.sql
2020-12-31 14:09:25.928992 (Thread-1): Parsing macros/sql/get_tables_by_pattern_sql.sql
2020-12-31 14:09:25.938735 (Thread-1): Parsing macros/sql/nullcheck_table.sql
2020-12-31 14:09:25.943452 (Thread-1): Parsing macros/sql/get_tables_by_prefix_sql.sql
2020-12-31 14:09:25.948123 (Thread-1): Parsing macros/sql/get_relations_by_pattern.sql
2020-12-31 14:09:25.954153 (Thread-1): Parsing macros/sql/get_relations_by_prefix.sql
2020-12-31 14:09:25.960088 (Thread-1): Parsing macros/sql/safe_add.sql
2020-12-31 14:09:25.964813 (Thread-1): Parsing macros/sql/unpivot.sql
2020-12-31 14:09:25.975136 (Thread-1): Parsing macros/sql/generate_series.sql
2020-12-31 14:09:25.982673 (Thread-1): Parsing macros/sql/nullcheck.sql
2020-12-31 14:09:25.987634 (Thread-1): Parsing macros/sql/union.sql
2020-12-31 14:09:26.000561 (Thread-1): Parsing macros/materializations/insert_by_period_materialization.sql
2020-12-31 14:09:26.026397 (Thread-1): Parsing macros/web/get_url_parameter.sql
2020-12-31 14:09:26.031192 (Thread-1): Parsing macros/web/get_url_path.sql
2020-12-31 14:09:26.036674 (Thread-1): Parsing macros/web/get_url_host.sql
2020-12-31 14:09:26.042114 (Thread-1): Parsing macros/datetime/date_spine.sql
2020-12-31 14:09:26.049112 (Thread-1): Parsing macros/schema_tests/expression_is_true.sql
2020-12-31 14:09:26.054499 (Thread-1): Parsing macros/schema_tests/not_constant.sql
2020-12-31 14:09:26.059189 (Thread-1): Parsing macros/schema_tests/at_least_one.sql
2020-12-31 14:09:26.063896 (Thread-1): Parsing macros/schema_tests/equality.sql
2020-12-31 14:09:26.071041 (Thread-1): Parsing macros/schema_tests/test_not_null_where.sql
2020-12-31 14:09:26.076029 (Thread-1): Parsing macros/schema_tests/equal_rowcount.sql
2020-12-31 14:09:26.081274 (Thread-1): Parsing macros/schema_tests/test_unique_where.sql
2020-12-31 14:09:26.087642 (Thread-1): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2020-12-31 14:09:26.097429 (Thread-1): Parsing macros/schema_tests/relationships_where.sql
2020-12-31 14:09:26.103038 (Thread-1): Parsing macros/schema_tests/unique_combination_of_columns.sql
2020-12-31 14:09:26.109253 (Thread-1): Parsing macros/schema_tests/recency.sql
2020-12-31 14:09:26.114039 (Thread-1): Parsing macros/schema_tests/cardinality_equality.sql
2020-12-31 14:09:26.118995 (Thread-1): Parsing macros/geo/haversine_distance.sql
2020-12-31 14:09:26.123515 (Thread-1): Parsing macros/cross_db_utils/split_part.sql
2020-12-31 14:09:26.128707 (Thread-1): Parsing macros/cross_db_utils/length.sql
2020-12-31 14:09:26.133787 (Thread-1): Parsing macros/cross_db_utils/current_timestamp.sql
2020-12-31 14:09:26.140648 (Thread-1): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2020-12-31 14:09:26.145258 (Thread-1): Parsing macros/cross_db_utils/right.sql
2020-12-31 14:09:26.151003 (Thread-1): Parsing macros/cross_db_utils/hash.sql
2020-12-31 14:09:26.156227 (Thread-1): Parsing macros/cross_db_utils/replace.sql
2020-12-31 14:09:26.160990 (Thread-1): Parsing macros/cross_db_utils/concat.sql
2020-12-31 14:09:26.167003 (Thread-1): Parsing macros/cross_db_utils/_is_relation.sql
2020-12-31 14:09:26.171871 (Thread-1): Parsing macros/cross_db_utils/identifier.sql
2020-12-31 14:09:26.177862 (Thread-1): Parsing macros/cross_db_utils/datediff.sql
2020-12-31 14:09:26.191421 (Thread-1): Parsing macros/cross_db_utils/dateadd.sql
2020-12-31 14:09:26.198592 (Thread-1): Parsing macros/cross_db_utils/datatypes.sql
2020-12-31 14:09:26.208695 (Thread-1): Parsing macros/cross_db_utils/position.sql
2020-12-31 14:09:26.213975 (Thread-1): Parsing macros/cross_db_utils/literal.sql
2020-12-31 14:09:26.218761 (Thread-1): Parsing macros/cross_db_utils/_is_ephemeral.sql
2020-12-31 14:09:26.224425 (Thread-1): Parsing macros/cross_db_utils/width_bucket.sql
2020-12-31 14:09:26.233414 (Thread-1): Parsing macros/cross_db_utils/date_trunc.sql
2020-12-31 14:09:26.238574 (Thread-1): Parsing macros/cross_db_utils/except.sql
2020-12-31 14:09:26.243451 (Thread-1): Parsing macros/cross_db_utils/safe_cast.sql
2020-12-31 14:09:26.249303 (Thread-1): Parsing macros/cross_db_utils/last_day.sql
2020-12-31 14:09:26.255865 (Thread-1): Parsing macros/cross_db_utils/intersect.sql
2020-12-31 14:09:26.264963 (Thread-1): Parsing macros/get_date_dimension.sql
2020-12-31 14:09:26.281377 (Thread-1): Parsing macros/get_base_dates.sql
2020-12-31 14:09:26.286876 (Thread-1): Parsing macros/calendar_date/n_weeks_ago.sql
2020-12-31 14:09:26.291949 (Thread-1): Parsing macros/calendar_date/to_unixtimestamp.sql
2020-12-31 14:09:26.297413 (Thread-1): Parsing macros/calendar_date/yesterday.sql
2020-12-31 14:09:26.302597 (Thread-1): Parsing macros/calendar_date/month_name.sql
2020-12-31 14:09:26.308143 (Thread-1): Parsing macros/calendar_date/day_name.sql
2020-12-31 14:09:26.313668 (Thread-1): Parsing macros/calendar_date/_get_utils_namespaces.sql
2020-12-31 14:09:26.318459 (Thread-1): Parsing macros/calendar_date/date_part.sql
2020-12-31 14:09:26.324773 (Thread-1): Parsing macros/calendar_date/n_days_ago.sql
2020-12-31 14:09:26.329450 (Thread-1): Parsing macros/calendar_date/now.sql
2020-12-31 14:09:26.333522 (Thread-1): Parsing macros/calendar_date/n_months_ago.sql
2020-12-31 14:09:26.338363 (Thread-1): Parsing macros/calendar_date/this_week.sql
2020-12-31 14:09:26.342595 (Thread-1): Parsing macros/calendar_date/convert_timezone.sql
2020-12-31 14:09:26.348909 (Thread-1): Parsing macros/calendar_date/periods_since.sql
2020-12-31 14:09:26.353501 (Thread-1): Parsing macros/calendar_date/n_months_away.sql
2020-12-31 14:09:26.357864 (Thread-1): Parsing macros/calendar_date/n_days_away.sql
2020-12-31 14:09:26.362671 (Thread-1): Parsing macros/calendar_date/last_week.sql
2020-12-31 14:09:26.367094 (Thread-1): Parsing macros/calendar_date/n_weeks_away.sql
2020-12-31 14:09:26.371797 (Thread-1): Parsing macros/calendar_date/tomorrow.sql
2020-12-31 14:09:26.376330 (Thread-1): Parsing macros/calendar_date/today.sql
2020-12-31 14:09:26.380745 (Thread-1): Parsing macros/fiscal_date/get_fiscal_periods.sql
2020-12-31 14:09:26.386756 (Thread-1): Parsing macros/fiscal_date/get_fiscal_year_dates.sql
2020-12-31 14:09:26.560797 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Entity".
2020-12-31 14:09:26.589382 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics".
2020-12-31 14:09:26.605973 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2020-12-31 14:09:26.621185 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Address".
2020-12-31 14:09:26.635382 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Lead".
2020-12-31 14:09:26.649563 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_TimeFrame".
2020-12-31 14:09:26.665871 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2020-12-31 14:09:26.686473 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Campaign".
2020-12-31 14:09:26.708533 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Employee".
2020-12-31 14:09:26.725015 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Contact".
2020-12-31 14:09:26.739519 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity".
2020-12-31 14:09:26.753510 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Account".
2020-12-31 14:09:26.767396 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Product".
2020-12-31 14:09:26.778063 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Product model triggered this warning. 
2020-12-31 14:09:26.804478 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test_metrics".
2020-12-31 14:09:26.818057 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity".
2020-12-31 14:09:26.825404 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity model triggered this warning. 
2020-12-31 14:09:26.837057 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Account".
2020-12-31 14:09:26.842548 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Account model triggered this warning. 
2020-12-31 14:09:26.852866 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_History".
2020-12-31 14:09:26.864231 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Calc".
2020-12-31 14:09:26.876508 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2020-12-31 14:09:26.910036 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2020-12-31 14:09:26.923145 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test".
2020-12-31 14:09:26.949407 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2020-12-31 14:09:26.967969 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Calendar".
2020-12-31 14:09:27.034489 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Lead".
2020-12-31 14:09:27.040708 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Lead model triggered this warning. 
2020-12-31 14:09:27.053944 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Address".
2020-12-31 14:09:27.060251 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-31 14:09:27.061536 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2020-12-31 14:09:27.072734 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales".
2020-12-31 14:09:27.087888 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Contact".
2020-12-31 14:09:27.094207 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Contact model triggered this warning. 
2020-12-31 14:09:27.109558 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee".
2020-12-31 14:09:27.115743 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Employee model triggered this warning. 
2020-12-31 14:09:27.128648 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2020-12-31 14:09:27.134382 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity_Stage model triggered this warning. 
2020-12-31 14:09:27.146389 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Campaign".
2020-12-31 14:09:27.152178 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Campaign model triggered this warning. 
2020-12-31 14:09:27.163124 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2020-12-31 14:09:27.353079 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dim_date_fiscal".
2020-12-31 14:09:27.380744 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dim_date".
2020-12-31 14:09:27.397547 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dates".
2020-12-31 14:09:27.556108 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Tables
- models.sales_dataflo.Views
- seeds.sales_dataflo

2020-12-31 14:09:27.635275 (Thread-3): handling status request
2020-12-31 14:09:27.635698 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819fc1c0>]}
2020-12-31 14:09:27.648290 (Thread-3): sending response (<Response 47192 bytes [200 OK]>) to 10.0.9.114
2020-12-31 14:57:24.003105 (Thread-4): handling status request
2020-12-31 14:57:24.004498 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819beac0>]}
2020-12-31 14:57:24.017030 (Thread-4): sending response (<Response 47192 bytes [200 OK]>) to 10.0.14.128
2020-12-31 14:57:24.479779 (Thread-5): handling run_sql request
2020-12-31 14:57:24.480217 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e81957760>]}
2020-12-31 14:57:24.483081 (Thread-5): Connection 'model.dbt_date.dates' was properly closed.
2020-12-31 14:57:25.525755 (Thread-5): sending response (<Response 137 bytes [200 OK]>) to 10.0.23.172
2020-12-31 14:57:25.544960 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 14:57:25.575671 (MainThread): Found 31 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources
2020-12-31 14:57:25.576108 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 14:57:25.576219 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-31 14:57:25.594216 (Thread-1): finished collecting timing info
2020-12-31 14:57:25.595519 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-31 14:57:25.595577 (Thread-1): On rpc.sales_dataflo.request: with recursive managers as
      (
        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
          where mngr_emp_id is null
        union all
        select  employees.source_Emp_id, emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, 
         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers 
            on employees.mngr_emp_id = managers.source_Emp_id
          where employees.mngr_emp_id is not null  
      )
  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,
           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,
           emp_full_nm = (
            SELECT TOP 1 emp_full_nm 
    	    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee
    	    WHERE Employee.source_Emp_id = managers.source_Emp_id), 
             'SF'  as Source_type,
          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,
           
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
   from managers
   UNION ALL

SELECT Emp_Id, emp_full_nm, 0 as Level
FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
where mngr_emp_id is null
ORDER BY Level

limit 100
2020-12-31 14:57:25.595628 (Thread-1): Opening a new connection, currently in state init
2020-12-31 14:57:26.092923 (Thread-6): handling poll request
2020-12-31 14:57:26.093413 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819a30a0>]}
2020-12-31 14:57:26.097677 (Thread-6): sending response (<Response 4299 bytes [200 OK]>) to 10.0.36.232
2020-12-31 14:57:26.311605 (Thread-1): Snowflake query id: 01994c61-002e-81f4-0000-5eb10010763a
2020-12-31 14:57:26.311739 (Thread-1): Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'EMP_FULL_NM'
2020-12-31 14:57:26.311858 (Thread-1): finished collecting timing info
2020-12-31 14:57:26.312205 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-31 14:57:26.382139 (Thread-1): Got an exception: Database Error
  002028 (42601): SQL compilation error:
  ambiguous column name 'EMP_FULL_NM'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 002028 (42601): SQL compilation error:
ambiguous column name 'EMP_FULL_NM'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002028 (42601): SQL compilation error:
  ambiguous column name 'EMP_FULL_NM'
2020-12-31 14:57:26.383870 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002028 (42601): SQL compilation error:\n  ambiguous column name 'EMP_FULL_NM'", 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT Emp_Id, emp_full_nm, 0 as Level\r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n\nlimit 100', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT Emp_Id, emp_full_nm, 0 as Level\nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level\n\nlimit 100", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  002028 (42601): SQL compilation error:\n  ambiguous column name 'EMP_FULL_NM'", 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT Emp_Id, emp_full_nm, 0 as Level\r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n\nlimit 100', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT Emp_Id, emp_full_nm, 0 as Level\nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level\n\nlimit 100", 'tags': None}, None)
2020-12-31 14:57:27.569626 (Thread-7): handling poll request
2020-12-31 14:57:27.570062 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8196ab80>]}
2020-12-31 14:57:27.571037 (Thread-7): sending response (<Response 18820 bytes [200 OK]>) to 10.0.32.144
2020-12-31 14:58:04.322898 (Thread-8): handling status request
2020-12-31 14:58:04.323340 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e82e95310>]}
2020-12-31 14:58:04.453160 (Thread-8): sending response (<Response 47192 bytes [200 OK]>) to 10.0.23.54
2020-12-31 14:58:04.890818 (Thread-9): handling run_sql request
2020-12-31 14:58:04.891239 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e81a46e80>]}
2020-12-31 14:58:05.890164 (Thread-9): sending response (<Response 137 bytes [200 OK]>) to 10.0.18.95
2020-12-31 14:58:05.908653 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 14:58:05.936874 (MainThread): Found 31 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources
2020-12-31 14:58:05.937291 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 14:58:05.937418 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-31 14:58:05.955506 (Thread-1): finished collecting timing info
2020-12-31 14:58:05.956813 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-31 14:58:05.956871 (Thread-1): On rpc.sales_dataflo.request: with recursive managers as
      (
        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
          where mngr_emp_id is null
        union all
        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, 
         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers 
            on employees.mngr_emp_id = managers.source_Emp_id
          where employees.mngr_emp_id is not null  
      )
  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,
           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,
           emp_full_nm = (
            SELECT TOP 1 emp_full_nm 
    	    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee
    	    WHERE Employee.source_Emp_id = managers.source_Emp_id), 
             'SF'  as Source_type,
          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,
           
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
   from managers
   UNION ALL

SELECT Emp_Id, emp_full_nm, 0 as Level
FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
where mngr_emp_id is null
ORDER BY Level
2020-12-31 14:58:05.956925 (Thread-1): Opening a new connection, currently in state init
2020-12-31 14:58:06.400293 (Thread-10): handling poll request
2020-12-31 14:58:06.400788 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819ed6a0>]}
2020-12-31 14:58:06.403016 (Thread-10): sending response (<Response 4304 bytes [200 OK]>) to 10.0.9.208
2020-12-31 14:58:06.567089 (Thread-1): Snowflake query id: 01994c62-009f-736a-0000-5eb100108636
2020-12-31 14:58:06.567286 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 29 at position 7
invalid identifier 'EMP_ID'
2020-12-31 14:58:06.567437 (Thread-1): finished collecting timing info
2020-12-31 14:58:06.567848 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-31 14:58:06.620258 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 29 at position 7
  invalid identifier 'EMP_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 29 at position 7
invalid identifier 'EMP_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 29 at position 7
  invalid identifier 'EMP_ID'
2020-12-31 14:58:06.621678 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 29 at position 7\n  invalid identifier 'EMP_ID'", 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT Emp_Id, emp_full_nm, 0 as Level\r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT Emp_Id, emp_full_nm, 0 as Level\nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 29 at position 7\n  invalid identifier 'EMP_ID'", 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT Emp_Id, emp_full_nm, 0 as Level\r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT Emp_Id, emp_full_nm, 0 as Level\nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level", 'tags': None}, None)
2020-12-31 14:58:07.972922 (Thread-11): handling poll request
2020-12-31 14:58:07.973382 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819ed550>]}
2020-12-31 14:58:07.974338 (Thread-11): sending response (<Response 18953 bytes [200 OK]>) to 10.0.14.128
2020-12-31 14:58:29.863062 (Thread-12): handling status request
2020-12-31 14:58:29.864858 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819a9400>]}
2020-12-31 14:58:29.877888 (Thread-12): sending response (<Response 47192 bytes [200 OK]>) to 10.0.9.208
2020-12-31 14:58:30.359166 (Thread-13): handling run_sql request
2020-12-31 14:58:30.359592 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819a94f0>]}
2020-12-31 14:58:31.381492 (Thread-13): sending response (<Response 137 bytes [200 OK]>) to 10.0.33.186
2020-12-31 14:58:31.399952 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 14:58:31.431641 (MainThread): Found 31 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources
2020-12-31 14:58:31.432052 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 14:58:31.432160 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-31 14:58:31.450069 (Thread-1): finished collecting timing info
2020-12-31 14:58:31.451359 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-31 14:58:31.451418 (Thread-1): On rpc.sales_dataflo.request: with recursive managers as
      (
        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
          where mngr_emp_id is null
        union all
        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, 
         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers 
            on employees.mngr_emp_id = managers.source_Emp_id
          where employees.mngr_emp_id is not null  
      )
  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,
           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,
           emp_full_nm = (
            SELECT TOP 1 emp_full_nm 
    	    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee
    	    WHERE Employee.source_Emp_id = managers.source_Emp_id), 
             'SF'  as Source_type,
          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,
           
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
   from managers
   UNION ALL

SELECT source_Emp_id, emp_full_nm, 0 as Level
FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
where mngr_emp_id is null
ORDER BY Level
2020-12-31 14:58:31.451470 (Thread-1): Opening a new connection, currently in state init
2020-12-31 14:58:31.929574 (Thread-14): handling poll request
2020-12-31 14:58:31.930026 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e814d4910>]}
2020-12-31 14:58:31.932062 (Thread-14): sending response (<Response 4311 bytes [200 OK]>) to 10.0.13.204
2020-12-31 14:58:32.033216 (Thread-1): Snowflake query id: 01994c62-00df-3885-0000-5eb100106766
2020-12-31 14:58:32.033364 (Thread-1): Snowflake error: 001789 (42601): SQL compilation error:
invalid number of result columns for set operator input branches, expected 12, got 3 in branch 2
2020-12-31 14:58:32.033490 (Thread-1): finished collecting timing info
2020-12-31 14:58:32.033843 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-31 14:58:32.098812 (Thread-1): Got an exception: Database Error
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 12, got 3 in branch 2
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 001789 (42601): SQL compilation error:
invalid number of result columns for set operator input branches, expected 12, got 3 in branch 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001789 (42601): SQL compilation error:
  invalid number of result columns for set operator input branches, expected 12, got 3 in branch 2
2020-12-31 14:58:32.100208 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  001789 (42601): SQL compilation error:\n  invalid number of result columns for set operator input branches, expected 12, got 3 in branch 2', 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT source_Emp_id, emp_full_nm, 0 as Level\r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT source_Emp_id, emp_full_nm, 0 as Level\nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  001789 (42601): SQL compilation error:\n  invalid number of result columns for set operator input branches, expected 12, got 3 in branch 2', 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT source_Emp_id, emp_full_nm, 0 as Level\r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT source_Emp_id, emp_full_nm, 0 as Level\nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level", 'tags': None}, None)
2020-12-31 14:58:33.398333 (Thread-15): handling poll request
2020-12-31 14:58:33.398779 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8151f2b0>]}
2020-12-31 14:58:33.399678 (Thread-15): sending response (<Response 19285 bytes [200 OK]>) to 10.0.13.204
2020-12-31 15:01:21.258936 (Thread-16): handling status request
2020-12-31 15:01:21.260623 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8151f580>]}
2020-12-31 15:01:21.273425 (Thread-16): sending response (<Response 47192 bytes [200 OK]>) to 10.0.6.38
2020-12-31 15:01:21.887498 (Thread-17): handling run_sql request
2020-12-31 15:01:21.887916 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e814d4730>]}
2020-12-31 15:01:23.010984 (Thread-17): sending response (<Response 137 bytes [200 OK]>) to 10.0.6.38
2020-12-31 15:01:23.033694 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 15:01:23.081564 (MainThread): Found 31 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources
2020-12-31 15:01:23.082068 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 15:01:23.082185 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-31 15:01:23.105196 (Thread-1): finished collecting timing info
2020-12-31 15:01:23.107626 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-31 15:01:23.107725 (Thread-1): On rpc.sales_dataflo.request: with recursive managers as
      (
        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
          where mngr_emp_id is null
        union all
        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, 
         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers 
            on employees.mngr_emp_id = managers.source_Emp_id
          where employees.mngr_emp_id is not null  
      )
  select  level , source_Emp_id as Employee_ID, 
           emp_full_nm = (
            SELECT TOP 1 emp_full_nm 
    	    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee
    	    WHERE Employee.source_Emp_id = managers.source_Emp_id), 
           emp_position_level,emp_role_id ,
           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,
             'SF'  as Source_type,
          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,
           
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
   from managers
   UNION ALL

SELECT 0 as Level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,
           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,
           emp_full_nm = (
            SELECT TOP 1 emp_full_nm 
    	    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee
    	    WHERE Employee.source_Emp_id = managers.source_Emp_id), 
             'SF'  as Source_type,
          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,
           
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
where mngr_emp_id is null
ORDER BY Level
2020-12-31 15:01:23.107786 (Thread-1): Opening a new connection, currently in state init
2020-12-31 15:01:23.699706 (Thread-18): handling poll request
2020-12-31 15:01:23.700313 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e81769730>]}
2020-12-31 15:01:23.703095 (Thread-18): sending response (<Response 4812 bytes [200 OK]>) to 10.0.36.232
2020-12-31 15:01:23.802410 (Thread-1): Snowflake query id: 01994c65-002d-2982-0000-5eb10010953e
2020-12-31 15:01:23.802597 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 35 at position 40
invalid identifier 'MANAGERS.SOURCE_EMP_ID'
2020-12-31 15:01:23.802774 (Thread-1): finished collecting timing info
2020-12-31 15:01:23.803323 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-31 15:01:23.861876 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 35 at position 40
  invalid identifier 'MANAGERS.SOURCE_EMP_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 35 at position 40
invalid identifier 'MANAGERS.SOURCE_EMP_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 35 at position 40
  invalid identifier 'MANAGERS.SOURCE_EMP_ID'
2020-12-31 15:01:23.863544 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 35 at position 40\n  invalid identifier 'MANAGERS.SOURCE_EMP_ID'", 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id as Employee_ID, \r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT 0 as Level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id as Employee_ID, \n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n           emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT 0 as Level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 35 at position 40\n  invalid identifier 'MANAGERS.SOURCE_EMP_ID'", 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id as Employee_ID, \r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT 0 as Level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id as Employee_ID, \n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n           emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT 0 as Level , source_Emp_id as Employee_ID, emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level", 'tags': None}, None)
2020-12-31 15:01:25.191147 (Thread-19): handling poll request
2020-12-31 15:01:25.191564 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e81935a00>]}
2020-12-31 15:01:25.192552 (Thread-19): sending response (<Response 22844 bytes [200 OK]>) to 10.0.13.204
2020-12-31 15:02:10.990041 (Thread-20): handling status request
2020-12-31 15:02:10.990645 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e81935400>]}
2020-12-31 15:02:11.014662 (Thread-20): sending response (<Response 47192 bytes [200 OK]>) to 10.0.9.114
2020-12-31 15:02:11.724565 (Thread-21): handling run_sql request
2020-12-31 15:02:11.725185 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e81769a30>]}
2020-12-31 15:02:13.422679 (Thread-21): sending response (<Response 137 bytes [200 OK]>) to 10.0.24.229
2020-12-31 15:02:13.459495 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 15:02:13.510978 (MainThread): Found 31 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources
2020-12-31 15:02:13.511541 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 15:02:13.511717 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-31 15:02:13.557145 (Thread-1): finished collecting timing info
2020-12-31 15:02:13.560212 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-31 15:02:13.560349 (Thread-1): On rpc.sales_dataflo.request: with recursive managers as
      (
        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
          where mngr_emp_id is null
        union all
        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, 
         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers 
            on employees.mngr_emp_id = managers.source_Emp_id
          where employees.mngr_emp_id is not null  
      )
  select  level , source_Emp_id , 
           emp_full_nm = (
            SELECT TOP 1 emp_full_nm 
    	    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee
    	    WHERE Employee.source_Emp_id = managers.source_Emp_id), 
           emp_position_level,emp_role_id ,
           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,
             'SF'  as Source_type,
          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,
           
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
   from managers
   UNION ALL

SELECT 0 as Level , source_Emp_id , emp_full_nm, emp_position_level,emp_role_id ,
           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,
           emp_full_nm = (
            SELECT TOP 1 emp_full_nm 
    	    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee
    	    WHERE Employee.source_Emp_id = managers.source_Emp_id), 
             'SF'  as Source_type,
          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,
           
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
where mngr_emp_id is null
ORDER BY Level
2020-12-31 15:02:13.560448 (Thread-1): Opening a new connection, currently in state init
2020-12-31 15:02:14.078606 (Thread-22): handling poll request
2020-12-31 15:02:14.079263 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e81a4a790>]}
2020-12-31 15:02:14.082316 (Thread-22): sending response (<Response 4783 bytes [200 OK]>) to 10.0.33.186
2020-12-31 15:02:14.334704 (Thread-1): Snowflake query id: 01994c66-00ad-61fe-0000-5eb100109542
2020-12-31 15:02:14.334841 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 35 at position 40
invalid identifier 'MANAGERS.SOURCE_EMP_ID'
2020-12-31 15:02:14.334982 (Thread-1): finished collecting timing info
2020-12-31 15:02:14.335394 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-31 15:02:14.385776 (Thread-1): Got an exception: Database Error
  000904 (42000): SQL compilation error: error line 35 at position 40
  invalid identifier 'MANAGERS.SOURCE_EMP_ID'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 35 at position 40
invalid identifier 'MANAGERS.SOURCE_EMP_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  000904 (42000): SQL compilation error: error line 35 at position 40
  invalid identifier 'MANAGERS.SOURCE_EMP_ID'
2020-12-31 15:02:14.387822 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 35 at position 40\n  invalid identifier 'MANAGERS.SOURCE_EMP_ID'", 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id , \r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT 0 as Level , source_Emp_id , emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id , \n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n           emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT 0 as Level , source_Emp_id , emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': "Database Error in rpc request (from remote system)\n  000904 (42000): SQL compilation error: error line 35 at position 40\n  invalid identifier 'MANAGERS.SOURCE_EMP_ID'", 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id , \r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT 0 as Level , source_Emp_id , emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id , \n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n           emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT 0 as Level , source_Emp_id , emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level", 'tags': None}, None)
2020-12-31 15:02:15.652854 (Thread-23): handling poll request
2020-12-31 15:02:15.653507 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819ee6a0>]}
2020-12-31 15:02:15.654849 (Thread-23): sending response (<Response 22648 bytes [200 OK]>) to 10.0.19.64
2020-12-31 15:04:15.930068 (Thread-24): handling status request
2020-12-31 15:04:15.931618 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819ac850>]}
2020-12-31 15:04:15.945438 (Thread-24): sending response (<Response 47192 bytes [200 OK]>) to 10.0.23.54
2020-12-31 15:04:16.417253 (Thread-25): handling run_sql request
2020-12-31 15:04:16.417848 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819ee910>]}
2020-12-31 15:04:17.489975 (Thread-25): sending response (<Response 137 bytes [200 OK]>) to 10.0.6.38
2020-12-31 15:04:17.509390 (MainThread): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 15:04:17.542623 (MainThread): Found 31 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 0 sources
2020-12-31 15:04:17.543129 (Thread-1): Acquiring new snowflake connection "rpc.sales_dataflo.request".
2020-12-31 15:04:17.543225 (Thread-1): Compiling rpc.sales_dataflo.request
2020-12-31 15:04:17.565788 (Thread-1): finished collecting timing info
2020-12-31 15:04:17.567966 (Thread-1): Using snowflake connection "rpc.sales_dataflo.request".
2020-12-31 15:04:17.568103 (Thread-1): On rpc.sales_dataflo.request: with recursive managers as
      (
        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
          where mngr_emp_id is null
        union all
        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, 
         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level
          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers 
            on employees.mngr_emp_id = managers.source_Emp_id
          where employees.mngr_emp_id is not null  
      )
  select  level , source_Emp_id , 
           emp_full_nm = (
            SELECT TOP 1 emp_full_nm 
    	    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee
    	    WHERE Employee.source_Emp_id = managers.source_Emp_id), 
           emp_position_level,emp_role_id ,
           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,
             'SF'  as Source_type,
          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,
           
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
   from managers
   UNION ALL

SELECT 0 as Level , source_Emp_id , emp_full_nm, emp_position_level,emp_role_id ,
           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,
             'SF'  as Source_type,
          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,
           
    current_timestamp::
    timestamp_ntz

 AS DW_INS_UPD_DTS 
FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee
where mngr_emp_id is null
ORDER BY Level
2020-12-31 15:04:17.568198 (Thread-1): Opening a new connection, currently in state init
2020-12-31 15:04:17.954871 (Thread-26): handling poll request
2020-12-31 15:04:17.955306 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8196cb20>]}
2020-12-31 15:04:17.957253 (Thread-26): sending response (<Response 4573 bytes [200 OK]>) to 10.0.9.208
2020-12-31 15:04:18.310818 (Thread-1): Snowflake query id: 01994c68-0091-2ecb-0000-5eb1001076ce
2020-12-31 15:04:18.310955 (Thread-1): Snowflake error: 002031 (42601): SQL compilation error:
Unsupported subquery type cannot be evaluated
2020-12-31 15:04:18.311074 (Thread-1): finished collecting timing info
2020-12-31 15:04:18.311441 (Thread-1): On rpc.sales_dataflo.request: Close
2020-12-31 15:04:18.369984 (Thread-1): Got an exception: Database Error
  002031 (42601): SQL compilation error:
  Unsupported subquery type cannot be evaluated
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/cursor.py", line 595, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 97, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, errorclass, errorvalue)
  File "/usr/local/lib/python3.8/dist-packages/snowflake/connector/errors.py", line 68, in default_errorhandler
    raise errorclass(
snowflake.connector.errors.ProgrammingError: 002031 (42601): SQL compilation error:
Unsupported subquery type cannot be evaluated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002031 (42601): SQL compilation error:
  Unsupported subquery type cannot be evaluated
2020-12-31 15:04:18.371681 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  002031 (42601): SQL compilation error:\n  Unsupported subquery type cannot be evaluated', 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id , \r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT 0 as Level , source_Emp_id , emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id , \n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n           emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT 0 as Level , source_Emp_id , emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  002031 (42601): SQL compilation error:\n  Unsupported subquery type cannot be evaluated', 'raw_sql': 'with recursive managers as\r\n      (\r\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\r\n          from  {{ ref(\'Dim_Employee\') }}\r\n          where mngr_emp_id is null\r\n        union all\r\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \r\n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\r\n          from  {{ ref(\'Dim_Employee\') }} employees join managers \r\n            on employees.mngr_emp_id = managers.source_Emp_id\r\n          where employees.mngr_emp_id is not null  \r\n      )\r\n  select  level , source_Emp_id , \r\n           emp_full_nm = (\r\n            SELECT TOP 1 emp_full_nm \r\n    \t    FROM {{ ref(\'Dim_Employee\') }} Employee\r\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \r\n           emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\n   from managers\r\n   UNION ALL\r\n\r\nSELECT 0 as Level , source_Emp_id , emp_full_nm, emp_position_level,emp_role_id ,\r\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\r\n           {% if var("V_SF_CRM_ETL") == \'FIVETRAN_SF\' %}  \'SF\' {% endif %} as Source_type,\r\n          \'D_EMPLOYEE_HIER_LOAD\' AS DW_SESSION_NM,\r\n           {{ dbt_utils.current_timestamp() }} AS DW_INS_UPD_DTS \r\nFROM {{ ref(\'Dim_Employee\') }}\r\nwhere mngr_emp_id is null\r\nORDER BY Level\r\n', 'compiled_sql': "with recursive managers as\n      (\n        select source_Emp_id, emp_full_nm, emp_position_level, emp_role_id ,  mngr_emp_id, mngr_position_level,mngr_role_id, 1 as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\n          where mngr_emp_id is null\n        union all\n        select  employees.source_Emp_id, employees.emp_full_nm ,employees.emp_position_level, employees.emp_role_id ,employees.mngr_emp_id, \n         employees.mngr_position_level, employees.mngr_role_id, managers.level +1  as level\n          from  DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee employees join managers \n            on employees.mngr_emp_id = managers.source_Emp_id\n          where employees.mngr_emp_id is not null  \n      )\n  select  level , source_Emp_id , \n           emp_full_nm = (\n            SELECT TOP 1 emp_full_nm \n    \t    FROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee Employee\n    \t    WHERE Employee.source_Emp_id = managers.source_Emp_id), \n           emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \n   from managers\n   UNION ALL\n\nSELECT 0 as Level , source_Emp_id , emp_full_nm, emp_position_level,emp_role_id ,\n           mngr_emp_id as Manager_ID,mngr_position_level,mngr_role_id,\n             'SF'  as Source_type,\n          'D_EMPLOYEE_HIER_LOAD' AS DW_SESSION_NM,\n           \n    current_timestamp::\n    timestamp_ntz\n\n AS DW_INS_UPD_DTS \nFROM DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Employee\nwhere mngr_emp_id is null\nORDER BY Level", 'tags': None}, None)
2020-12-31 15:04:19.403470 (Thread-27): handling poll request
2020-12-31 15:04:19.403883 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '737ad516-9bb8-47d3-895e-5303bad43c49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e819bc8e0>]}
2020-12-31 15:04:19.404798 (Thread-27): sending response (<Response 20989 bytes [200 OK]>) to 10.0.23.54
2021-01-01 15:33:06.297962 (MainThread): Running with dbt=0.18.1
2021-01-01 15:33:06.619715 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-01-01 15:33:06.633594 (MainThread): Tracking: tracking
2021-01-01 15:33:06.633899 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5cb896700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5cb6a6b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c480a1c0>]}
2021-01-01 15:33:06.644549 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=14
2021-01-01 15:33:06.645369 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-01-01 15:33:06.645658 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-01-01 15:33:06.744082 (Thread-1): Parsing macros/Segmented_Calc.sql
2021-01-01 15:33:06.748213 (Thread-1): Parsing macros/NS_History_Calc.sql
2021-01-01 15:33:06.752138 (Thread-1): Parsing macros/NS_Calc.sql
2021-01-01 15:33:06.756082 (Thread-1): Parsing macros/Segmented_History_Calc.sql
2021-01-01 15:33:06.756718 (Thread-1): Parsing macros/adapters.sql
2021-01-01 15:33:06.787993 (Thread-1): Parsing macros/catalog.sql
2021-01-01 15:33:06.790128 (Thread-1): Parsing macros/materializations/table.sql
2021-01-01 15:33:06.794076 (Thread-1): Parsing macros/materializations/merge.sql
2021-01-01 15:33:06.796168 (Thread-1): Parsing macros/materializations/view.sql
2021-01-01 15:33:06.797754 (Thread-1): Parsing macros/materializations/incremental.sql
2021-01-01 15:33:06.808048 (Thread-1): Parsing macros/core.sql
2021-01-01 15:33:06.811929 (Thread-1): Parsing macros/adapters/common.sql
2021-01-01 15:33:06.856324 (Thread-1): Parsing macros/materializations/helpers.sql
2021-01-01 15:33:06.868043 (Thread-1): Parsing macros/materializations/table/table.sql
2021-01-01 15:33:06.875303 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-01-01 15:33:06.897400 (Thread-1): Parsing macros/materializations/view/view.sql
2021-01-01 15:33:06.903665 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-01 15:33:06.908712 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-01-01 15:33:06.910599 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-01-01 15:33:06.916692 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-01-01 15:33:06.930610 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-01-01 15:33:06.947635 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-01 15:33:06.949582 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-01 15:33:06.978650 (Thread-2): handling status request
2021-01-01 15:33:06.979197 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a49dd352-1c53-4c2e-ae0d-116fa19ddf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c47a1ee0>]}
2021-01-01 15:33:06.979397 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-01-01 15:33:06.981214 (Thread-2): sending response (<Response 184 bytes [200 OK]>) to 10.0.14.128
2021-01-01 15:33:06.983992 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-01-01 15:33:06.985852 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-01-01 15:33:06.987713 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-01-01 15:33:06.990431 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-01-01 15:33:06.992142 (Thread-1): Parsing macros/etc/query.sql
2021-01-01 15:33:06.993398 (Thread-1): Parsing macros/etc/datetime.sql
2021-01-01 15:33:07.001975 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-01-01 15:33:07.002961 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-01-01 15:33:07.004591 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-01-01 15:33:07.035450 (Thread-1): Parsing macros/logger/pretty_time.sql
2021-01-01 15:33:07.044401 (Thread-1): Parsing macros/logger/log_info.sql
2021-01-01 15:33:07.052750 (Thread-1): Parsing macros/logger/pretty_log_format.sql
2021-01-01 15:33:07.061381 (Thread-1): Parsing macros/sql/pivot.sql
2021-01-01 15:33:07.073088 (Thread-1): Parsing macros/sql/star.sql
2021-01-01 15:33:07.083497 (Thread-1): Parsing macros/sql/surrogate_key.sql
2021-01-01 15:33:07.095605 (Thread-1): Parsing macros/sql/get_query_results_as_dict.sql
2021-01-01 15:33:07.105932 (Thread-1): Parsing macros/sql/get_column_values.sql
2021-01-01 15:33:07.120385 (Thread-1): Parsing macros/sql/groupby.sql
2021-01-01 15:33:07.129807 (Thread-1): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-01-01 15:33:07.144292 (Thread-1): Parsing macros/sql/nullcheck_table.sql
2021-01-01 15:33:07.153620 (Thread-1): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-01-01 15:33:07.162283 (Thread-1): Parsing macros/sql/get_relations_by_pattern.sql
2021-01-01 15:33:07.173299 (Thread-1): Parsing macros/sql/get_relations_by_prefix.sql
2021-01-01 15:33:07.184113 (Thread-1): Parsing macros/sql/safe_add.sql
2021-01-01 15:33:07.193901 (Thread-1): Parsing macros/sql/unpivot.sql
2021-01-01 15:33:07.207758 (Thread-1): Parsing macros/sql/generate_series.sql
2021-01-01 15:33:07.219635 (Thread-1): Parsing macros/sql/nullcheck.sql
2021-01-01 15:33:07.228969 (Thread-1): Parsing macros/sql/union.sql
2021-01-01 15:33:07.245667 (Thread-1): Parsing macros/materializations/insert_by_period_materialization.sql
2021-01-01 15:33:07.276666 (Thread-1): Parsing macros/web/get_url_parameter.sql
2021-01-01 15:33:07.285460 (Thread-1): Parsing macros/web/get_url_path.sql
2021-01-01 15:33:07.295471 (Thread-1): Parsing macros/web/get_url_host.sql
2021-01-01 15:33:07.304028 (Thread-1): Parsing macros/datetime/date_spine.sql
2021-01-01 15:33:07.315513 (Thread-1): Parsing macros/schema_tests/expression_is_true.sql
2021-01-01 15:33:07.324214 (Thread-1): Parsing macros/schema_tests/not_constant.sql
2021-01-01 15:33:07.333149 (Thread-1): Parsing macros/schema_tests/at_least_one.sql
2021-01-01 15:33:07.342516 (Thread-1): Parsing macros/schema_tests/equality.sql
2021-01-01 15:33:07.353999 (Thread-1): Parsing macros/schema_tests/test_not_null_where.sql
2021-01-01 15:33:07.363293 (Thread-1): Parsing macros/schema_tests/equal_rowcount.sql
2021-01-01 15:33:07.372096 (Thread-1): Parsing macros/schema_tests/test_unique_where.sql
2021-01-01 15:33:07.381468 (Thread-1): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-01-01 15:33:07.394849 (Thread-1): Parsing macros/schema_tests/relationships_where.sql
2021-01-01 15:33:07.404953 (Thread-1): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-01-01 15:33:07.414745 (Thread-1): Parsing macros/schema_tests/recency.sql
2021-01-01 15:33:07.423207 (Thread-1): Parsing macros/schema_tests/cardinality_equality.sql
2021-01-01 15:33:07.432313 (Thread-1): Parsing macros/geo/haversine_distance.sql
2021-01-01 15:33:07.441852 (Thread-1): Parsing macros/cross_db_utils/split_part.sql
2021-01-01 15:33:07.452199 (Thread-1): Parsing macros/cross_db_utils/length.sql
2021-01-01 15:33:07.462067 (Thread-1): Parsing macros/cross_db_utils/current_timestamp.sql
2021-01-01 15:33:07.473116 (Thread-1): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-01-01 15:33:07.482641 (Thread-1): Parsing macros/cross_db_utils/right.sql
2021-01-01 15:33:07.493125 (Thread-1): Parsing macros/cross_db_utils/hash.sql
2021-01-01 15:33:07.502860 (Thread-1): Parsing macros/cross_db_utils/replace.sql
2021-01-01 15:33:07.511896 (Thread-1): Parsing macros/cross_db_utils/concat.sql
2021-01-01 15:33:07.521325 (Thread-1): Parsing macros/cross_db_utils/_is_relation.sql
2021-01-01 15:33:07.530438 (Thread-1): Parsing macros/cross_db_utils/identifier.sql
2021-01-01 15:33:07.540711 (Thread-1): Parsing macros/cross_db_utils/datediff.sql
2021-01-01 15:33:07.558671 (Thread-1): Parsing macros/cross_db_utils/dateadd.sql
2021-01-01 15:33:07.569569 (Thread-1): Parsing macros/cross_db_utils/datatypes.sql
2021-01-01 15:33:07.586329 (Thread-1): Parsing macros/cross_db_utils/position.sql
2021-01-01 15:33:07.595860 (Thread-1): Parsing macros/cross_db_utils/literal.sql
2021-01-01 15:33:07.604502 (Thread-1): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-01-01 15:33:07.614381 (Thread-1): Parsing macros/cross_db_utils/width_bucket.sql
2021-01-01 15:33:07.628155 (Thread-1): Parsing macros/cross_db_utils/date_trunc.sql
2021-01-01 15:33:07.638612 (Thread-1): Parsing macros/cross_db_utils/except.sql
2021-01-01 15:33:07.648331 (Thread-1): Parsing macros/cross_db_utils/safe_cast.sql
2021-01-01 15:33:07.658250 (Thread-1): Parsing macros/cross_db_utils/last_day.sql
2021-01-01 15:33:07.668723 (Thread-1): Parsing macros/cross_db_utils/intersect.sql
2021-01-01 15:33:07.683857 (Thread-1): Parsing macros/get_date_dimension.sql
2021-01-01 15:33:07.703547 (Thread-1): Parsing macros/get_base_dates.sql
2021-01-01 15:33:07.712786 (Thread-1): Parsing macros/calendar_date/n_weeks_ago.sql
2021-01-01 15:33:07.720856 (Thread-1): Parsing macros/calendar_date/to_unixtimestamp.sql
2021-01-01 15:33:07.730259 (Thread-1): Parsing macros/calendar_date/yesterday.sql
2021-01-01 15:33:07.738867 (Thread-1): Parsing macros/calendar_date/month_name.sql
2021-01-01 15:33:07.749275 (Thread-1): Parsing macros/calendar_date/day_name.sql
2021-01-01 15:33:07.759223 (Thread-1): Parsing macros/calendar_date/_get_utils_namespaces.sql
2021-01-01 15:33:07.767407 (Thread-1): Parsing macros/calendar_date/date_part.sql
2021-01-01 15:33:07.777028 (Thread-1): Parsing macros/calendar_date/n_days_ago.sql
2021-01-01 15:33:07.785225 (Thread-1): Parsing macros/calendar_date/now.sql
2021-01-01 15:33:07.794399 (Thread-1): Parsing macros/calendar_date/n_months_ago.sql
2021-01-01 15:33:07.804213 (Thread-1): Parsing macros/calendar_date/this_week.sql
2021-01-01 15:33:07.812698 (Thread-1): Parsing macros/calendar_date/convert_timezone.sql
2021-01-01 15:33:07.824876 (Thread-1): Parsing macros/calendar_date/periods_since.sql
2021-01-01 15:33:07.833394 (Thread-1): Parsing macros/calendar_date/n_months_away.sql
2021-01-01 15:33:07.842819 (Thread-1): Parsing macros/calendar_date/n_days_away.sql
2021-01-01 15:33:07.852634 (Thread-1): Parsing macros/calendar_date/last_week.sql
2021-01-01 15:33:07.861803 (Thread-1): Parsing macros/calendar_date/n_weeks_away.sql
2021-01-01 15:33:07.871841 (Thread-1): Parsing macros/calendar_date/tomorrow.sql
2021-01-01 15:33:07.881503 (Thread-1): Parsing macros/calendar_date/today.sql
2021-01-01 15:33:07.890308 (Thread-1): Parsing macros/fiscal_date/get_fiscal_periods.sql
2021-01-01 15:33:07.899860 (Thread-1): Parsing macros/fiscal_date/get_fiscal_year_dates.sql
2021-01-01 15:33:08.109041 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Entity".
2021-01-01 15:33:08.142681 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics".
2021-01-01 15:33:08.166573 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2021-01-01 15:33:08.188500 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Address".
2021-01-01 15:33:08.208945 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Lead".
2021-01-01 15:33:08.228287 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_TimeFrame".
2021-01-01 15:33:08.248059 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2021-01-01 15:33:08.268259 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Campaign".
2021-01-01 15:33:08.289793 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Employee".
2021-01-01 15:33:08.309212 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Contact".
2021-01-01 15:33:08.329349 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity".
2021-01-01 15:33:08.349826 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Account".
2021-01-01 15:33:08.369970 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Product".
2021-01-01 15:33:08.381250 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Product model triggered this warning. 
2021-01-01 15:33:08.413139 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test_metrics".
2021-01-01 15:33:08.432568 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity".
2021-01-01 15:33:08.440534 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity model triggered this warning. 
2021-01-01 15:33:08.457913 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Account".
2021-01-01 15:33:08.465945 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Account model triggered this warning. 
2021-01-01 15:33:08.479659 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_History".
2021-01-01 15:33:08.494303 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Calc".
2021-01-01 15:33:08.513087 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2021-01-01 15:33:08.550939 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2021-01-01 15:33:08.569255 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test".
2021-01-01 15:33:08.603061 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2021-01-01 15:33:08.627847 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Calendar".
2021-01-01 15:33:08.699857 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Lead".
2021-01-01 15:33:08.706292 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Lead model triggered this warning. 
2021-01-01 15:33:08.724372 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Address".
2021-01-01 15:33:08.731613 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2021-01-01 15:33:08.733141 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2021-01-01 15:33:08.746170 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales".
2021-01-01 15:33:08.763894 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Contact".
2021-01-01 15:33:08.771561 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Contact model triggered this warning. 
2021-01-01 15:33:08.789799 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee".
2021-01-01 15:33:08.797107 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Employee model triggered this warning. 
2021-01-01 15:33:08.814805 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2021-01-01 15:33:08.821650 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity_Stage model triggered this warning. 
2021-01-01 15:33:08.838949 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Campaign".
2021-01-01 15:33:08.845912 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Campaign model triggered this warning. 
2021-01-01 15:33:08.859794 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2021-01-01 15:33:08.997421 (Thread-3): handling status request
2021-01-01 15:33:09.001117 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a49dd352-1c53-4c2e-ae0d-116fa19ddf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5beef6e20>]}
2021-01-01 15:33:09.001902 (Thread-3): sending response (<Response 184 bytes [200 OK]>) to 10.0.18.95
2021-01-01 15:33:09.082693 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dim_date_fiscal".
2021-01-01 15:33:09.122124 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dim_date".
2021-01-01 15:33:09.153865 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dates".
2021-01-01 15:33:09.475661 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2021-01-01 15:33:10.981882 (Thread-4): handling status request
2021-01-01 15:33:10.982341 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'a49dd352-1c53-4c2e-ae0d-116fa19ddf76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c422eca0>]}
2021-01-01 15:33:10.994915 (Thread-4): sending response (<Response 47192 bytes [200 OK]>) to 10.0.14.128
2021-01-02 05:35:17.435218 (MainThread): Running with dbt=0.18.1
2021-01-02 05:35:17.723921 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-01-02 05:35:17.736742 (MainThread): Tracking: tracking
2021-01-02 05:35:17.736952 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb75aedc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7580849a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb758077cd0>]}
2021-01-02 05:35:17.737991 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=13
2021-01-02 05:35:17.748140 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-01-02 05:35:17.748425 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-01-02 05:35:17.836075 (Thread-1): Parsing macros/Segmented_Calc.sql
2021-01-02 05:35:17.839752 (Thread-1): Parsing macros/NS_History_Calc.sql
2021-01-02 05:35:17.842943 (Thread-1): Parsing macros/NS_Calc.sql
2021-01-02 05:35:17.846454 (Thread-1): Parsing macros/Segmented_History_Calc.sql
2021-01-02 05:35:17.847215 (Thread-1): Parsing macros/adapters.sql
2021-01-02 05:35:17.878753 (Thread-1): Parsing macros/catalog.sql
2021-01-02 05:35:17.881773 (Thread-1): Parsing macros/materializations/table.sql
2021-01-02 05:35:17.885932 (Thread-1): Parsing macros/materializations/merge.sql
2021-01-02 05:35:17.888229 (Thread-1): Parsing macros/materializations/view.sql
2021-01-02 05:35:17.891019 (Thread-1): Parsing macros/materializations/incremental.sql
2021-01-02 05:35:17.901945 (Thread-1): Parsing macros/core.sql
2021-01-02 05:35:17.905674 (Thread-1): Parsing macros/adapters/common.sql
2021-01-02 05:35:17.950659 (Thread-1): Parsing macros/materializations/helpers.sql
2021-01-02 05:35:17.960110 (Thread-1): Parsing macros/materializations/table/table.sql
2021-01-02 05:35:17.967396 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-01-02 05:35:17.988375 (Thread-1): Parsing macros/materializations/view/view.sql
2021-01-02 05:35:17.994738 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-02 05:35:17.999917 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-01-02 05:35:18.001695 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-01-02 05:35:18.008033 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-01-02 05:35:18.022329 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-01-02 05:35:18.039456 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-02 05:35:18.041180 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-02 05:35:18.070307 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-01-02 05:35:18.072561 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-01-02 05:35:18.074448 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-01-02 05:35:18.076132 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-01-02 05:35:18.079164 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-01-02 05:35:18.081148 (Thread-1): Parsing macros/etc/query.sql
2021-01-02 05:35:18.082206 (Thread-1): Parsing macros/etc/datetime.sql
2021-01-02 05:35:18.091036 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-01-02 05:35:18.091979 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-01-02 05:35:18.093543 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-01-02 05:35:18.117023 (Thread-1): Parsing macros/logger/pretty_time.sql
2021-01-02 05:35:18.122902 (Thread-1): Parsing macros/logger/log_info.sql
2021-01-02 05:35:18.128690 (Thread-1): Parsing macros/logger/pretty_log_format.sql
2021-01-02 05:35:18.134461 (Thread-1): Parsing macros/sql/pivot.sql
2021-01-02 05:35:18.142500 (Thread-1): Parsing macros/sql/star.sql
2021-01-02 05:35:18.150073 (Thread-1): Parsing macros/sql/surrogate_key.sql
2021-01-02 05:35:18.158279 (Thread-1): Parsing macros/sql/get_query_results_as_dict.sql
2021-01-02 05:35:18.166110 (Thread-1): Parsing macros/sql/get_column_values.sql
2021-01-02 05:35:18.175214 (Thread-1): Parsing macros/sql/groupby.sql
2021-01-02 05:35:18.181075 (Thread-1): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-01-02 05:35:18.193756 (Thread-1): Parsing macros/sql/nullcheck_table.sql
2021-01-02 05:35:18.200526 (Thread-1): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-01-02 05:35:18.206737 (Thread-1): Parsing macros/sql/get_relations_by_pattern.sql
2021-01-02 05:35:18.214846 (Thread-1): Parsing macros/sql/get_relations_by_prefix.sql
2021-01-02 05:35:18.222221 (Thread-1): Parsing macros/sql/safe_add.sql
2021-01-02 05:35:18.228711 (Thread-1): Parsing macros/sql/unpivot.sql
2021-01-02 05:35:18.240002 (Thread-1): Parsing macros/sql/generate_series.sql
2021-01-02 05:35:18.248644 (Thread-1): Parsing macros/sql/nullcheck.sql
2021-01-02 05:35:18.255919 (Thread-1): Parsing macros/sql/union.sql
2021-01-02 05:35:18.272901 (Thread-1): Parsing macros/materializations/insert_by_period_materialization.sql
2021-01-02 05:35:18.304930 (Thread-1): Parsing macros/web/get_url_parameter.sql
2021-01-02 05:35:18.311388 (Thread-1): Parsing macros/web/get_url_path.sql
2021-01-02 05:35:18.319683 (Thread-1): Parsing macros/web/get_url_host.sql
2021-01-02 05:35:18.326591 (Thread-1): Parsing macros/datetime/date_spine.sql
2021-01-02 05:35:18.337777 (Thread-1): Parsing macros/schema_tests/expression_is_true.sql
2021-01-02 05:35:18.344525 (Thread-1): Parsing macros/schema_tests/not_constant.sql
2021-01-02 05:35:18.350700 (Thread-1): Parsing macros/schema_tests/at_least_one.sql
2021-01-02 05:35:18.356895 (Thread-1): Parsing macros/schema_tests/equality.sql
2021-01-02 05:35:18.366066 (Thread-1): Parsing macros/schema_tests/test_not_null_where.sql
2021-01-02 05:35:18.373456 (Thread-1): Parsing macros/schema_tests/equal_rowcount.sql
2021-01-02 05:35:18.381038 (Thread-1): Parsing macros/schema_tests/test_unique_where.sql
2021-01-02 05:35:18.388260 (Thread-1): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-01-02 05:35:18.399159 (Thread-1): Parsing macros/schema_tests/relationships_where.sql
2021-01-02 05:35:18.408585 (Thread-1): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-01-02 05:35:18.416670 (Thread-1): Parsing macros/schema_tests/recency.sql
2021-01-02 05:35:18.423227 (Thread-1): Parsing macros/schema_tests/cardinality_equality.sql
2021-01-02 05:35:18.430206 (Thread-1): Parsing macros/geo/haversine_distance.sql
2021-01-02 05:35:18.436957 (Thread-1): Parsing macros/cross_db_utils/split_part.sql
2021-01-02 05:35:18.445888 (Thread-1): Parsing macros/cross_db_utils/length.sql
2021-01-02 05:35:18.453610 (Thread-1): Parsing macros/cross_db_utils/current_timestamp.sql
2021-01-02 05:35:18.462137 (Thread-1): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-01-02 05:35:18.468105 (Thread-1): Parsing macros/cross_db_utils/right.sql
2021-01-02 05:35:18.475995 (Thread-1): Parsing macros/cross_db_utils/hash.sql
2021-01-02 05:35:18.483305 (Thread-1): Parsing macros/cross_db_utils/replace.sql
2021-01-02 05:35:18.490101 (Thread-1): Parsing macros/cross_db_utils/concat.sql
2021-01-02 05:35:18.498135 (Thread-1): Parsing macros/cross_db_utils/_is_relation.sql
2021-01-02 05:35:18.504929 (Thread-1): Parsing macros/cross_db_utils/identifier.sql
2021-01-02 05:35:18.512078 (Thread-1): Parsing macros/cross_db_utils/datediff.sql
2021-01-02 05:35:18.527019 (Thread-1): Parsing macros/cross_db_utils/dateadd.sql
2021-01-02 05:35:18.534797 (Thread-1): Parsing macros/cross_db_utils/datatypes.sql
2021-01-02 05:35:18.548616 (Thread-1): Parsing macros/cross_db_utils/position.sql
2021-01-02 05:35:18.555983 (Thread-1): Parsing macros/cross_db_utils/literal.sql
2021-01-02 05:35:18.562881 (Thread-1): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-01-02 05:35:18.569942 (Thread-1): Parsing macros/cross_db_utils/width_bucket.sql
2021-01-02 05:35:18.583175 (Thread-1): Parsing macros/cross_db_utils/date_trunc.sql
2021-01-02 05:35:18.590589 (Thread-1): Parsing macros/cross_db_utils/except.sql
2021-01-02 05:35:18.596696 (Thread-1): Parsing macros/cross_db_utils/safe_cast.sql
2021-01-02 05:35:18.604870 (Thread-1): Parsing macros/cross_db_utils/last_day.sql
2021-01-02 05:35:18.613533 (Thread-1): Parsing macros/cross_db_utils/intersect.sql
2021-01-02 05:35:18.625214 (Thread-1): Parsing macros/get_date_dimension.sql
2021-01-02 05:35:18.641357 (Thread-1): Parsing macros/get_base_dates.sql
2021-01-02 05:35:18.649435 (Thread-1): Parsing macros/calendar_date/n_weeks_ago.sql
2021-01-02 05:35:18.655647 (Thread-1): Parsing macros/calendar_date/to_unixtimestamp.sql
2021-01-02 05:35:18.664919 (Thread-1): Parsing macros/calendar_date/yesterday.sql
2021-01-02 05:35:18.671344 (Thread-1): Parsing macros/calendar_date/month_name.sql
2021-01-02 05:35:18.679380 (Thread-1): Parsing macros/calendar_date/day_name.sql
2021-01-02 05:35:18.686544 (Thread-1): Parsing macros/calendar_date/_get_utils_namespaces.sql
2021-01-02 05:35:18.692634 (Thread-1): Parsing macros/calendar_date/date_part.sql
2021-01-02 05:35:18.699826 (Thread-1): Parsing macros/calendar_date/n_days_ago.sql
2021-01-02 05:35:18.706742 (Thread-1): Parsing macros/calendar_date/now.sql
2021-01-02 05:35:18.712779 (Thread-1): Parsing macros/calendar_date/n_months_ago.sql
2021-01-02 05:35:18.719571 (Thread-1): Parsing macros/calendar_date/this_week.sql
2021-01-02 05:35:18.725629 (Thread-1): Parsing macros/calendar_date/convert_timezone.sql
2021-01-02 05:35:18.734043 (Thread-1): Parsing macros/calendar_date/periods_since.sql
2021-01-02 05:35:18.740240 (Thread-1): Parsing macros/calendar_date/n_months_away.sql
2021-01-02 05:35:18.746876 (Thread-1): Parsing macros/calendar_date/n_days_away.sql
2021-01-02 05:35:18.753016 (Thread-1): Parsing macros/calendar_date/last_week.sql
2021-01-02 05:35:18.758780 (Thread-1): Parsing macros/calendar_date/n_weeks_away.sql
2021-01-02 05:35:18.765782 (Thread-1): Parsing macros/calendar_date/tomorrow.sql
2021-01-02 05:35:18.772140 (Thread-1): Parsing macros/calendar_date/today.sql
2021-01-02 05:35:18.778168 (Thread-1): Parsing macros/fiscal_date/get_fiscal_periods.sql
2021-01-02 05:35:18.785286 (Thread-1): Parsing macros/fiscal_date/get_fiscal_year_dates.sql
2021-01-02 05:35:18.980399 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Entity".
2021-01-02 05:35:19.014327 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics".
2021-01-02 05:35:19.036280 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2021-01-02 05:35:19.053527 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Address".
2021-01-02 05:35:19.069500 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Lead".
2021-01-02 05:35:19.085433 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_TimeFrame".
2021-01-02 05:35:19.102533 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2021-01-02 05:35:19.118981 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Campaign".
2021-01-02 05:35:19.134722 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Employee".
2021-01-02 05:35:19.149945 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Contact".
2021-01-02 05:35:19.168672 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity".
2021-01-02 05:35:19.184405 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Account".
2021-01-02 05:35:19.200908 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Product".
2021-01-02 05:35:19.211939 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Product model triggered this warning. 
2021-01-02 05:35:19.241311 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test_metrics".
2021-01-02 05:35:19.255925 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity".
2021-01-02 05:35:19.262238 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity model triggered this warning. 
2021-01-02 05:35:19.276244 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Account".
2021-01-02 05:35:19.282971 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Account model triggered this warning. 
2021-01-02 05:35:19.294328 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_History".
2021-01-02 05:35:19.307061 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Calc".
2021-01-02 05:35:19.320767 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2021-01-02 05:35:19.353084 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2021-01-02 05:35:19.366930 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test".
2021-01-02 05:35:19.392735 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2021-01-02 05:35:19.412038 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Calendar".
2021-01-02 05:35:19.481947 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Lead".
2021-01-02 05:35:19.487523 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Lead model triggered this warning. 
2021-01-02 05:35:19.504304 (Thread-2): handling status request
2021-01-02 05:35:19.504628 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '63c51fce-f867-4b16-8c98-155a3c363a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7535f8520>]}
2021-01-02 05:35:19.506078 (Thread-2): sending response (<Response 184 bytes [200 OK]>) to 10.0.6.38
2021-01-02 05:35:19.510013 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Address".
2021-01-02 05:35:19.516933 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2021-01-02 05:35:19.518278 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2021-01-02 05:35:19.529936 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales".
2021-01-02 05:35:19.544781 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Contact".
2021-01-02 05:35:19.550380 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Contact model triggered this warning. 
2021-01-02 05:35:19.564882 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee".
2021-01-02 05:35:19.570790 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Employee model triggered this warning. 
2021-01-02 05:35:19.584094 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2021-01-02 05:35:19.589566 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity_Stage model triggered this warning. 
2021-01-02 05:35:19.603619 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Campaign".
2021-01-02 05:35:19.609744 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Campaign model triggered this warning. 
2021-01-02 05:35:19.624374 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2021-01-02 05:35:19.806918 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dim_date_fiscal".
2021-01-02 05:35:19.833994 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dim_date".
2021-01-02 05:35:19.850836 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dates".
2021-01-02 05:35:20.014452 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Views
- models.sales_dataflo.Tables
- seeds.sales_dataflo

2021-01-02 05:35:21.907727 (Thread-3): handling status request
2021-01-02 05:35:21.908141 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '63c51fce-f867-4b16-8c98-155a3c363a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb75358d340>]}
2021-01-02 05:35:21.919856 (Thread-3): sending response (<Response 47192 bytes [200 OK]>) to 10.0.9.208
2021-01-03 02:27:45.405966 (MainThread): Running with dbt=0.18.1
2021-01-03 02:27:45.690601 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-01-03 02:27:45.702129 (MainThread): Tracking: tracking
2021-01-03 02:27:45.702318 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28fbacfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e4e75b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e4e12f10>]}
2021-01-03 02:27:45.702658 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=13
2021-01-03 02:27:45.711199 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-01-03 02:27:45.711441 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-01-03 02:27:45.795478 (Thread-1): Parsing macros/Segmented_Calc.sql
2021-01-03 02:27:45.799254 (Thread-1): Parsing macros/NS_History_Calc.sql
2021-01-03 02:27:45.802425 (Thread-1): Parsing macros/NS_Calc.sql
2021-01-03 02:27:45.805651 (Thread-1): Parsing macros/Segmented_History_Calc.sql
2021-01-03 02:27:45.806130 (Thread-1): Parsing macros/adapters.sql
2021-01-03 02:27:45.834108 (Thread-1): Parsing macros/catalog.sql
2021-01-03 02:27:45.836062 (Thread-1): Parsing macros/materializations/table.sql
2021-01-03 02:27:45.839743 (Thread-1): Parsing macros/materializations/merge.sql
2021-01-03 02:27:45.841629 (Thread-1): Parsing macros/materializations/view.sql
2021-01-03 02:27:45.843089 (Thread-1): Parsing macros/materializations/incremental.sql
2021-01-03 02:27:45.852649 (Thread-1): Parsing macros/core.sql
2021-01-03 02:27:45.856152 (Thread-1): Parsing macros/adapters/common.sql
2021-01-03 02:27:45.897612 (Thread-1): Parsing macros/materializations/helpers.sql
2021-01-03 02:27:45.905993 (Thread-1): Parsing macros/materializations/table/table.sql
2021-01-03 02:27:45.912331 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-01-03 02:27:45.931873 (Thread-1): Parsing macros/materializations/view/view.sql
2021-01-03 02:27:45.937769 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-03 02:27:45.942471 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-01-03 02:27:45.944242 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-01-03 02:27:45.950093 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-01-03 02:27:45.963395 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-01-03 02:27:45.979118 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-03 02:27:45.980823 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-03 02:27:46.007681 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-01-03 02:27:46.009498 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-01-03 02:27:46.010987 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-01-03 02:27:46.012634 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-01-03 02:27:46.015219 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-01-03 02:27:46.016813 (Thread-1): Parsing macros/etc/query.sql
2021-01-03 02:27:46.017841 (Thread-1): Parsing macros/etc/datetime.sql
2021-01-03 02:27:46.026281 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-01-03 02:27:46.027246 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-01-03 02:27:46.028797 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-01-03 02:27:46.054434 (Thread-1): Parsing macros/logger/pretty_time.sql
2021-01-03 02:27:46.062452 (Thread-1): Parsing macros/logger/log_info.sql
2021-01-03 02:27:46.069218 (Thread-1): Parsing macros/logger/pretty_log_format.sql
2021-01-03 02:27:46.076481 (Thread-1): Parsing macros/sql/pivot.sql
2021-01-03 02:27:46.085579 (Thread-1): Parsing macros/sql/star.sql
2021-01-03 02:27:46.094882 (Thread-1): Parsing macros/sql/surrogate_key.sql
2021-01-03 02:27:46.105170 (Thread-1): Parsing macros/sql/get_query_results_as_dict.sql
2021-01-03 02:27:46.114749 (Thread-1): Parsing macros/sql/get_column_values.sql
2021-01-03 02:27:46.125226 (Thread-1): Parsing macros/sql/groupby.sql
2021-01-03 02:27:46.133645 (Thread-1): Parsing macros/sql/get_tables_by_pattern_sql.sql
2021-01-03 02:27:46.145476 (Thread-1): Parsing macros/sql/nullcheck_table.sql
2021-01-03 02:27:46.154283 (Thread-1): Parsing macros/sql/get_tables_by_prefix_sql.sql
2021-01-03 02:27:46.159961 (Thread-1): Parsing macros/sql/get_relations_by_pattern.sql
2021-01-03 02:27:46.169101 (Thread-1): Parsing macros/sql/get_relations_by_prefix.sql
2021-01-03 02:27:46.177556 (Thread-1): Parsing macros/sql/safe_add.sql
2021-01-03 02:27:46.183878 (Thread-2): handling status request
2021-01-03 02:27:46.184231 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bd0bf58b-a630-41e8-a2c0-a281407ba522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e7f7b2b0>]}
2021-01-03 02:27:46.185910 (Thread-2): sending response (<Response 184 bytes [200 OK]>) to 10.0.3.20
2021-01-03 02:27:46.186808 (Thread-1): Parsing macros/sql/unpivot.sql
2021-01-03 02:27:46.199582 (Thread-1): Parsing macros/sql/generate_series.sql
2021-01-03 02:27:46.207903 (Thread-1): Parsing macros/sql/nullcheck.sql
2021-01-03 02:27:46.215474 (Thread-1): Parsing macros/sql/union.sql
2021-01-03 02:27:46.230655 (Thread-1): Parsing macros/materializations/insert_by_period_materialization.sql
2021-01-03 02:27:46.258874 (Thread-1): Parsing macros/web/get_url_parameter.sql
2021-01-03 02:27:46.266329 (Thread-1): Parsing macros/web/get_url_path.sql
2021-01-03 02:27:46.274195 (Thread-1): Parsing macros/web/get_url_host.sql
2021-01-03 02:27:46.282857 (Thread-1): Parsing macros/datetime/date_spine.sql
2021-01-03 02:27:46.292238 (Thread-1): Parsing macros/schema_tests/expression_is_true.sql
2021-01-03 02:27:46.301594 (Thread-1): Parsing macros/schema_tests/not_constant.sql
2021-01-03 02:27:46.309816 (Thread-1): Parsing macros/schema_tests/at_least_one.sql
2021-01-03 02:27:46.318175 (Thread-1): Parsing macros/schema_tests/equality.sql
2021-01-03 02:27:46.327852 (Thread-1): Parsing macros/schema_tests/test_not_null_where.sql
2021-01-03 02:27:46.336422 (Thread-1): Parsing macros/schema_tests/equal_rowcount.sql
2021-01-03 02:27:46.347463 (Thread-1): Parsing macros/schema_tests/test_unique_where.sql
2021-01-03 02:27:46.356190 (Thread-1): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2021-01-03 02:27:46.368040 (Thread-1): Parsing macros/schema_tests/relationships_where.sql
2021-01-03 02:27:46.376862 (Thread-1): Parsing macros/schema_tests/unique_combination_of_columns.sql
2021-01-03 02:27:46.385677 (Thread-1): Parsing macros/schema_tests/recency.sql
2021-01-03 02:27:46.393790 (Thread-1): Parsing macros/schema_tests/cardinality_equality.sql
2021-01-03 02:27:46.400856 (Thread-1): Parsing macros/geo/haversine_distance.sql
2021-01-03 02:27:46.409065 (Thread-1): Parsing macros/cross_db_utils/split_part.sql
2021-01-03 02:27:46.417606 (Thread-1): Parsing macros/cross_db_utils/length.sql
2021-01-03 02:27:46.424519 (Thread-1): Parsing macros/cross_db_utils/current_timestamp.sql
2021-01-03 02:27:46.434861 (Thread-1): Parsing macros/cross_db_utils/_get_utils_namespaces.sql
2021-01-03 02:27:46.442906 (Thread-1): Parsing macros/cross_db_utils/right.sql
2021-01-03 02:27:46.452639 (Thread-1): Parsing macros/cross_db_utils/hash.sql
2021-01-03 02:27:46.460942 (Thread-1): Parsing macros/cross_db_utils/replace.sql
2021-01-03 02:27:46.468487 (Thread-1): Parsing macros/cross_db_utils/concat.sql
2021-01-03 02:27:46.478444 (Thread-1): Parsing macros/cross_db_utils/_is_relation.sql
2021-01-03 02:27:46.486844 (Thread-1): Parsing macros/cross_db_utils/identifier.sql
2021-01-03 02:27:46.494844 (Thread-1): Parsing macros/cross_db_utils/datediff.sql
2021-01-03 02:27:46.511656 (Thread-1): Parsing macros/cross_db_utils/dateadd.sql
2021-01-03 02:27:46.520609 (Thread-1): Parsing macros/cross_db_utils/datatypes.sql
2021-01-03 02:27:46.532870 (Thread-1): Parsing macros/cross_db_utils/position.sql
2021-01-03 02:27:46.540816 (Thread-1): Parsing macros/cross_db_utils/literal.sql
2021-01-03 02:27:46.547692 (Thread-1): Parsing macros/cross_db_utils/_is_ephemeral.sql
2021-01-03 02:27:46.555992 (Thread-1): Parsing macros/cross_db_utils/width_bucket.sql
2021-01-03 02:27:46.569096 (Thread-1): Parsing macros/cross_db_utils/date_trunc.sql
2021-01-03 02:27:46.577605 (Thread-1): Parsing macros/cross_db_utils/except.sql
2021-01-03 02:27:46.586468 (Thread-1): Parsing macros/cross_db_utils/safe_cast.sql
2021-01-03 02:27:46.595000 (Thread-1): Parsing macros/cross_db_utils/last_day.sql
2021-01-03 02:27:46.603593 (Thread-1): Parsing macros/cross_db_utils/intersect.sql
2021-01-03 02:27:46.614516 (Thread-1): Parsing macros/get_date_dimension.sql
2021-01-03 02:27:46.632837 (Thread-1): Parsing macros/get_base_dates.sql
2021-01-03 02:27:46.640527 (Thread-1): Parsing macros/calendar_date/n_weeks_ago.sql
2021-01-03 02:27:46.648073 (Thread-1): Parsing macros/calendar_date/to_unixtimestamp.sql
2021-01-03 02:27:46.656495 (Thread-1): Parsing macros/calendar_date/yesterday.sql
2021-01-03 02:27:46.665206 (Thread-1): Parsing macros/calendar_date/month_name.sql
2021-01-03 02:27:46.674226 (Thread-1): Parsing macros/calendar_date/day_name.sql
2021-01-03 02:27:46.682557 (Thread-1): Parsing macros/calendar_date/_get_utils_namespaces.sql
2021-01-03 02:27:46.689781 (Thread-1): Parsing macros/calendar_date/date_part.sql
2021-01-03 02:27:46.696095 (Thread-1): Parsing macros/calendar_date/n_days_ago.sql
2021-01-03 02:27:46.703330 (Thread-1): Parsing macros/calendar_date/now.sql
2021-01-03 02:27:46.710081 (Thread-1): Parsing macros/calendar_date/n_months_ago.sql
2021-01-03 02:27:46.718973 (Thread-1): Parsing macros/calendar_date/this_week.sql
2021-01-03 02:27:46.725685 (Thread-1): Parsing macros/calendar_date/convert_timezone.sql
2021-01-03 02:27:46.735138 (Thread-1): Parsing macros/calendar_date/periods_since.sql
2021-01-03 02:27:46.741394 (Thread-1): Parsing macros/calendar_date/n_months_away.sql
2021-01-03 02:27:46.748690 (Thread-1): Parsing macros/calendar_date/n_days_away.sql
2021-01-03 02:27:46.755601 (Thread-1): Parsing macros/calendar_date/last_week.sql
2021-01-03 02:27:46.763591 (Thread-1): Parsing macros/calendar_date/n_weeks_away.sql
2021-01-03 02:27:46.772007 (Thread-1): Parsing macros/calendar_date/tomorrow.sql
2021-01-03 02:27:46.780667 (Thread-1): Parsing macros/calendar_date/today.sql
2021-01-03 02:27:46.787383 (Thread-1): Parsing macros/fiscal_date/get_fiscal_periods.sql
2021-01-03 02:27:46.797393 (Thread-1): Parsing macros/fiscal_date/get_fiscal_year_dates.sql
2021-01-03 02:27:46.983547 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Entity".
2021-01-03 02:27:47.014537 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics".
2021-01-03 02:27:47.034162 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Metrics_Category".
2021-01-03 02:27:47.053413 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Address".
2021-01-03 02:27:47.070021 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Lead".
2021-01-03 02:27:47.087397 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_TimeFrame".
2021-01-03 02:27:47.105074 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity_Stage".
2021-01-03 02:27:47.121730 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Campaign".
2021-01-03 02:27:47.139329 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Employee".
2021-01-03 02:27:47.156500 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Contact".
2021-01-03 02:27:47.173345 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Opportunity".
2021-01-03 02:27:47.187874 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.VW_Account".
2021-01-03 02:27:47.204160 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Product".
2021-01-03 02:27:47.214893 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Product model triggered this warning. 
2021-01-03 02:27:47.244095 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test_metrics".
2021-01-03 02:27:47.260801 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity".
2021-01-03 02:27:47.267306 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity model triggered this warning. 
2021-01-03 02:27:47.283859 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Account".
2021-01-03 02:27:47.289053 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Account model triggered this warning. 
2021-01-03 02:27:47.300354 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_History".
2021-01-03 02:27:47.311829 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Calc".
2021-01-03 02:27:47.329581 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee_Hier".
2021-01-03 02:27:47.362761 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented".
2021-01-03 02:27:47.377233 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.test".
2021-01-03 02:27:47.405421 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_TimeFrame".
2021-01-03 02:27:47.426954 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Calendar".
2021-01-03 02:27:47.493395 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Lead".
2021-01-03 02:27:47.498857 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Lead model triggered this warning. 
2021-01-03 02:27:47.514268 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Address".
2021-01-03 02:27:47.520201 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2021-01-03 02:27:47.521385 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Address model triggered this warning. 
2021-01-03 02:27:47.532521 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales".
2021-01-03 02:27:47.547271 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Contact".
2021-01-03 02:27:47.552384 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Contact model triggered this warning. 
2021-01-03 02:27:47.567441 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Employee".
2021-01-03 02:27:47.577896 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Employee model triggered this warning. 
2021-01-03 02:27:47.592730 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Opportunity_Stage".
2021-01-03 02:27:47.597858 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Opportunity_Stage model triggered this warning. 
2021-01-03 02:27:47.612000 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Dim_Campaign".
2021-01-03 02:27:47.617118 (Thread-1): 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The sales_dataflo.Dim_Campaign model triggered this warning. 
2021-01-03 02:27:47.628189 (Thread-1): Acquiring new snowflake connection "model.sales_dataflo.Fact_Sales_Segmented_History".
2021-01-03 02:27:47.763193 (Thread-3): handling status request
2021-01-03 02:27:47.763645 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bd0bf58b-a630-41e8-a2c0-a281407ba522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28df4cdbb0>]}
2021-01-03 02:27:47.764323 (Thread-3): sending response (<Response 184 bytes [200 OK]>) to 10.0.42.133
2021-01-03 02:27:47.810969 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dim_date_fiscal".
2021-01-03 02:27:47.836992 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dim_date".
2021-01-03 02:27:47.853370 (Thread-1): Acquiring new snowflake connection "model.dbt_date.dates".
2021-01-03 02:27:48.019672 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales_dataflo.Tables
- models.sales_dataflo.Views
- seeds.sales_dataflo

2021-01-03 02:27:49.289727 (Thread-4): handling status request
2021-01-03 02:27:49.290163 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bd0bf58b-a630-41e8-a2c0-a281407ba522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e40abb50>]}
2021-01-03 02:27:49.302218 (Thread-4): sending response (<Response 47192 bytes [200 OK]>) to 10.0.16.77
2021-01-03 02:48:07.475501 (Thread-5): handling status request
2021-01-03 02:48:07.477532 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bd0bf58b-a630-41e8-a2c0-a281407ba522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e4020b80>]}
2021-01-03 02:48:07.491849 (Thread-5): sending response (<Response 47192 bytes [200 OK]>) to 10.0.32.212
