
    delete from DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Deal
    where (DEAL_ID) in (
        select (DEAL_ID)
        from DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Deal__dbt_tmp
    );
    

    insert into DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Deal ("DEAL_ID", "SOURCE_DEAL_ID", "PORTAL_ID", "IS_DELETED", "_FIVETRAN_SYNCED", "PROPERTY_HS_DEAL_STAGE_PROBABILITY", "PROPERTY_HS_CLOSED_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_HS_LASTMODIFIEDDATE", "PROPERTY_HS_CLOSED_AMOUNT", "PROPERTY_HS_TIME_IN_APPOINTMENTSCHEDULED", "PROPERTY_HS_IS_CLOSED", "PROPERTY_DAYS_TO_CLOSE", "PROPERTY_HS_DATE_ENTERED_APPOINTMENTSCHEDULED", "PROPERTY_HS_PROJECTED_AMOUNT", "PROPERTY_HS_PROJECTED_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_HS_DATE_EXITED_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_ENTERED_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_EXITED_CONTRACTSENT", "PROPERTY_HS_DATE_EXITED_APPOINTMENTSCHEDULED", "PROPERTY_HS_DATE_ENTERED_PRESENTATIONSCHEDULED", "PROPERTY_HS_TIME_IN_QUALIFIEDTOBUY", "PROPERTY_HS_TIME_IN_CLOSEDWON", "PROPERTY_HS_TIME_IN_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_EXITED_PRESENTATIONSCHEDULED", "PROPERTY_HS_DATE_ENTERED_QUALIFIEDTOBUY", "PROPERTY_HS_DATE_EXITED_QUALIFIEDTOBUY", "PROPERTY_HS_DATE_ENTERED_CONTRACTSENT", "PROPERTY_HS_TIME_IN_PRESENTATIONSCHEDULED", "PROPERTY_HS_DATE_ENTERED_CLOSEDWON", "PROPERTY_HS_TIME_IN_CONTRACTSENT", "PROPERTY_DEALNAME", "PROPERTY_CLOSEDATE", "PROPERTY_CREATEDATE", "DEAL_PIPELINE_STAGE_ID", "OWNER_ID", "PROPERTY_HS_CREATEDATE", "PROPERTY_HS_ALL_OWNER_IDS", "DEAL_PIPELINE_ID", "PROPERTY_HUBSPOT_OWNER_ASSIGNEDDATE", "PROPERTY_AMOUNT", "CUSTOMER_TEXT_1", "CUSTOMER_TEXT_2", "CUSTOMER_TEXT_3", "CUSTOMER_TEXT_4", "CUSTOMER_TEXT_5", "CUSTOMER_TEXT_6", "CUSTOMER_NUMBER_1", "CUSTOMER_NUMBER_2", "CUSTOMER_NUMBER_3", "CUSTOMER_DATE_1", "CUSTOMER_DATE_2", "CUSTOMER_DATE_3", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    (
        select "DEAL_ID", "SOURCE_DEAL_ID", "PORTAL_ID", "IS_DELETED", "_FIVETRAN_SYNCED", "PROPERTY_HS_DEAL_STAGE_PROBABILITY", "PROPERTY_HS_CLOSED_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_HS_LASTMODIFIEDDATE", "PROPERTY_HS_CLOSED_AMOUNT", "PROPERTY_HS_TIME_IN_APPOINTMENTSCHEDULED", "PROPERTY_HS_IS_CLOSED", "PROPERTY_DAYS_TO_CLOSE", "PROPERTY_HS_DATE_ENTERED_APPOINTMENTSCHEDULED", "PROPERTY_HS_PROJECTED_AMOUNT", "PROPERTY_HS_PROJECTED_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_HS_DATE_EXITED_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_ENTERED_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_EXITED_CONTRACTSENT", "PROPERTY_HS_DATE_EXITED_APPOINTMENTSCHEDULED", "PROPERTY_HS_DATE_ENTERED_PRESENTATIONSCHEDULED", "PROPERTY_HS_TIME_IN_QUALIFIEDTOBUY", "PROPERTY_HS_TIME_IN_CLOSEDWON", "PROPERTY_HS_TIME_IN_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_EXITED_PRESENTATIONSCHEDULED", "PROPERTY_HS_DATE_ENTERED_QUALIFIEDTOBUY", "PROPERTY_HS_DATE_EXITED_QUALIFIEDTOBUY", "PROPERTY_HS_DATE_ENTERED_CONTRACTSENT", "PROPERTY_HS_TIME_IN_PRESENTATIONSCHEDULED", "PROPERTY_HS_DATE_ENTERED_CLOSEDWON", "PROPERTY_HS_TIME_IN_CONTRACTSENT", "PROPERTY_DEALNAME", "PROPERTY_CLOSEDATE", "PROPERTY_CREATEDATE", "DEAL_PIPELINE_STAGE_ID", "OWNER_ID", "PROPERTY_HS_CREATEDATE", "PROPERTY_HS_ALL_OWNER_IDS", "DEAL_PIPELINE_ID", "PROPERTY_HUBSPOT_OWNER_ASSIGNEDDATE", "PROPERTY_AMOUNT", "CUSTOMER_TEXT_1", "CUSTOMER_TEXT_2", "CUSTOMER_TEXT_3", "CUSTOMER_TEXT_4", "CUSTOMER_TEXT_5", "CUSTOMER_TEXT_6", "CUSTOMER_NUMBER_1", "CUSTOMER_NUMBER_2", "CUSTOMER_NUMBER_3", "CUSTOMER_DATE_1", "CUSTOMER_DATE_2", "CUSTOMER_DATE_3", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS"
        from DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Deal__dbt_tmp
    );
