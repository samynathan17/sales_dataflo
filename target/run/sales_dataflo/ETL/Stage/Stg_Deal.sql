
        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Deal as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Deal__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.DEAL_ID = DBT_INTERNAL_DEST.DEAL_ID
        

    
    when matched then update set
        "DEAL_ID" = DBT_INTERNAL_SOURCE."DEAL_ID","SOURCE_DEAL_ID" = DBT_INTERNAL_SOURCE."SOURCE_DEAL_ID","PORTAL_ID" = DBT_INTERNAL_SOURCE."PORTAL_ID","IS_DELETED" = DBT_INTERNAL_SOURCE."IS_DELETED","_FIVETRAN_SYNCED" = DBT_INTERNAL_SOURCE."_FIVETRAN_SYNCED","PROPERTY_HS_DEAL_STAGE_PROBABILITY" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DEAL_STAGE_PROBABILITY","PROPERTY_HS_CLOSED_AMOUNT_IN_HOME_CURRENCY" = DBT_INTERNAL_SOURCE."PROPERTY_HS_CLOSED_AMOUNT_IN_HOME_CURRENCY","PROPERTY_HS_LASTMODIFIEDDATE" = DBT_INTERNAL_SOURCE."PROPERTY_HS_LASTMODIFIEDDATE","PROPERTY_HS_CLOSED_AMOUNT" = DBT_INTERNAL_SOURCE."PROPERTY_HS_CLOSED_AMOUNT","PROPERTY_HS_TIME_IN_APPOINTMENTSCHEDULED" = DBT_INTERNAL_SOURCE."PROPERTY_HS_TIME_IN_APPOINTMENTSCHEDULED","PROPERTY_HS_IS_CLOSED" = DBT_INTERNAL_SOURCE."PROPERTY_HS_IS_CLOSED","PROPERTY_HS_CREATED_BY_USER_ID" = DBT_INTERNAL_SOURCE."PROPERTY_HS_CREATED_BY_USER_ID","PROPERTY_DAYS_TO_CLOSE" = DBT_INTERNAL_SOURCE."PROPERTY_DAYS_TO_CLOSE","PROPERTY_HS_DATE_ENTERED_APPOINTMENTSCHEDULED" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_ENTERED_APPOINTMENTSCHEDULED","PROPERTY_HS_PROJECTED_AMOUNT" = DBT_INTERNAL_SOURCE."PROPERTY_HS_PROJECTED_AMOUNT","PROPERTY_HS_PROJECTED_AMOUNT_IN_HOME_CURRENCY" = DBT_INTERNAL_SOURCE."PROPERTY_HS_PROJECTED_AMOUNT_IN_HOME_CURRENCY","PROPERTY_AMOUNT_IN_HOME_CURRENCY" = DBT_INTERNAL_SOURCE."PROPERTY_AMOUNT_IN_HOME_CURRENCY","PROPERTY_HS_DATE_EXITED_DECISIONMAKERBOUGHTIN" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_EXITED_DECISIONMAKERBOUGHTIN","PROPERTY_HS_DATE_ENTERED_DECISIONMAKERBOUGHTIN" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_ENTERED_DECISIONMAKERBOUGHTIN","PROPERTY_HS_DATE_EXITED_CONTRACTSENT" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_EXITED_CONTRACTSENT","PROPERTY_HS_DATE_EXITED_APPOINTMENTSCHEDULED" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_EXITED_APPOINTMENTSCHEDULED","PROPERTY_HS_DATE_ENTERED_PRESENTATIONSCHEDULED" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_ENTERED_PRESENTATIONSCHEDULED","PROPERTY_HS_TIME_IN_QUALIFIEDTOBUY" = DBT_INTERNAL_SOURCE."PROPERTY_HS_TIME_IN_QUALIFIEDTOBUY","PROPERTY_HS_TIME_IN_CLOSEDWON" = DBT_INTERNAL_SOURCE."PROPERTY_HS_TIME_IN_CLOSEDWON","PROPERTY_HS_TIME_IN_DECISIONMAKERBOUGHTIN" = DBT_INTERNAL_SOURCE."PROPERTY_HS_TIME_IN_DECISIONMAKERBOUGHTIN","PROPERTY_HS_DATE_EXITED_PRESENTATIONSCHEDULED" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_EXITED_PRESENTATIONSCHEDULED","PROPERTY_HS_DATE_ENTERED_QUALIFIEDTOBUY" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_ENTERED_QUALIFIEDTOBUY","PROPERTY_HS_DATE_EXITED_QUALIFIEDTOBUY" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_EXITED_QUALIFIEDTOBUY","PROPERTY_HS_DATE_ENTERED_CONTRACTSENT" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_ENTERED_CONTRACTSENT","PROPERTY_HS_TIME_IN_PRESENTATIONSCHEDULED" = DBT_INTERNAL_SOURCE."PROPERTY_HS_TIME_IN_PRESENTATIONSCHEDULED","PROPERTY_HS_DATE_ENTERED_CLOSEDWON" = DBT_INTERNAL_SOURCE."PROPERTY_HS_DATE_ENTERED_CLOSEDWON","PROPERTY_HS_TIME_IN_CONTRACTSENT" = DBT_INTERNAL_SOURCE."PROPERTY_HS_TIME_IN_CONTRACTSENT","PROPERTY_HS_NEXT_STEP" = DBT_INTERNAL_SOURCE."PROPERTY_HS_NEXT_STEP","PROPERTY_HS_MANUAL_FORECAST_CATEGORY" = DBT_INTERNAL_SOURCE."PROPERTY_HS_MANUAL_FORECAST_CATEGORY","PROPERTY_DEALNAME" = DBT_INTERNAL_SOURCE."PROPERTY_DEALNAME","PROPERTY_CLOSEDATE" = DBT_INTERNAL_SOURCE."PROPERTY_CLOSEDATE","PROPERTY_CREATEDATE" = DBT_INTERNAL_SOURCE."PROPERTY_CREATEDATE","DEAL_PIPELINE_STAGE_ID" = DBT_INTERNAL_SOURCE."DEAL_PIPELINE_STAGE_ID","OWNER_ID" = DBT_INTERNAL_SOURCE."OWNER_ID","PROPERTY_HS_UPDATED_BY_USER_ID" = DBT_INTERNAL_SOURCE."PROPERTY_HS_UPDATED_BY_USER_ID","PROPERTY_HS_CREATEDATE" = DBT_INTERNAL_SOURCE."PROPERTY_HS_CREATEDATE","PROPERTY_HS_USER_IDS_OF_ALL_OWNERS" = DBT_INTERNAL_SOURCE."PROPERTY_HS_USER_IDS_OF_ALL_OWNERS","PROPERTY_HS_ALL_OWNER_IDS" = DBT_INTERNAL_SOURCE."PROPERTY_HS_ALL_OWNER_IDS","DEAL_PIPELINE_ID" = DBT_INTERNAL_SOURCE."DEAL_PIPELINE_ID","PROPERTY_HUBSPOT_OWNER_ASSIGNEDDATE" = DBT_INTERNAL_SOURCE."PROPERTY_HUBSPOT_OWNER_ASSIGNEDDATE","PROPERTY_PRODUCT_OF_INTEREST" = DBT_INTERNAL_SOURCE."PROPERTY_PRODUCT_OF_INTEREST","PROPERTY_AMOUNT" = DBT_INTERNAL_SOURCE."PROPERTY_AMOUNT","PROPERTY_POINT_OF_CONTACT" = DBT_INTERNAL_SOURCE."PROPERTY_POINT_OF_CONTACT","PROPERTY_DEALTYPE" = DBT_INTERNAL_SOURCE."PROPERTY_DEALTYPE","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("DEAL_ID", "SOURCE_DEAL_ID", "PORTAL_ID", "IS_DELETED", "_FIVETRAN_SYNCED", "PROPERTY_HS_DEAL_STAGE_PROBABILITY", "PROPERTY_HS_CLOSED_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_HS_LASTMODIFIEDDATE", "PROPERTY_HS_CLOSED_AMOUNT", "PROPERTY_HS_TIME_IN_APPOINTMENTSCHEDULED", "PROPERTY_HS_IS_CLOSED", "PROPERTY_HS_CREATED_BY_USER_ID", "PROPERTY_DAYS_TO_CLOSE", "PROPERTY_HS_DATE_ENTERED_APPOINTMENTSCHEDULED", "PROPERTY_HS_PROJECTED_AMOUNT", "PROPERTY_HS_PROJECTED_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_HS_DATE_EXITED_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_ENTERED_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_EXITED_CONTRACTSENT", "PROPERTY_HS_DATE_EXITED_APPOINTMENTSCHEDULED", "PROPERTY_HS_DATE_ENTERED_PRESENTATIONSCHEDULED", "PROPERTY_HS_TIME_IN_QUALIFIEDTOBUY", "PROPERTY_HS_TIME_IN_CLOSEDWON", "PROPERTY_HS_TIME_IN_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_EXITED_PRESENTATIONSCHEDULED", "PROPERTY_HS_DATE_ENTERED_QUALIFIEDTOBUY", "PROPERTY_HS_DATE_EXITED_QUALIFIEDTOBUY", "PROPERTY_HS_DATE_ENTERED_CONTRACTSENT", "PROPERTY_HS_TIME_IN_PRESENTATIONSCHEDULED", "PROPERTY_HS_DATE_ENTERED_CLOSEDWON", "PROPERTY_HS_TIME_IN_CONTRACTSENT", "PROPERTY_HS_NEXT_STEP", "PROPERTY_HS_MANUAL_FORECAST_CATEGORY", "PROPERTY_DEALNAME", "PROPERTY_CLOSEDATE", "PROPERTY_CREATEDATE", "DEAL_PIPELINE_STAGE_ID", "OWNER_ID", "PROPERTY_HS_UPDATED_BY_USER_ID", "PROPERTY_HS_CREATEDATE", "PROPERTY_HS_USER_IDS_OF_ALL_OWNERS", "PROPERTY_HS_ALL_OWNER_IDS", "DEAL_PIPELINE_ID", "PROPERTY_HUBSPOT_OWNER_ASSIGNEDDATE", "PROPERTY_PRODUCT_OF_INTEREST", "PROPERTY_AMOUNT", "PROPERTY_POINT_OF_CONTACT", "PROPERTY_DEALTYPE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("DEAL_ID", "SOURCE_DEAL_ID", "PORTAL_ID", "IS_DELETED", "_FIVETRAN_SYNCED", "PROPERTY_HS_DEAL_STAGE_PROBABILITY", "PROPERTY_HS_CLOSED_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_HS_LASTMODIFIEDDATE", "PROPERTY_HS_CLOSED_AMOUNT", "PROPERTY_HS_TIME_IN_APPOINTMENTSCHEDULED", "PROPERTY_HS_IS_CLOSED", "PROPERTY_HS_CREATED_BY_USER_ID", "PROPERTY_DAYS_TO_CLOSE", "PROPERTY_HS_DATE_ENTERED_APPOINTMENTSCHEDULED", "PROPERTY_HS_PROJECTED_AMOUNT", "PROPERTY_HS_PROJECTED_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_AMOUNT_IN_HOME_CURRENCY", "PROPERTY_HS_DATE_EXITED_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_ENTERED_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_EXITED_CONTRACTSENT", "PROPERTY_HS_DATE_EXITED_APPOINTMENTSCHEDULED", "PROPERTY_HS_DATE_ENTERED_PRESENTATIONSCHEDULED", "PROPERTY_HS_TIME_IN_QUALIFIEDTOBUY", "PROPERTY_HS_TIME_IN_CLOSEDWON", "PROPERTY_HS_TIME_IN_DECISIONMAKERBOUGHTIN", "PROPERTY_HS_DATE_EXITED_PRESENTATIONSCHEDULED", "PROPERTY_HS_DATE_ENTERED_QUALIFIEDTOBUY", "PROPERTY_HS_DATE_EXITED_QUALIFIEDTOBUY", "PROPERTY_HS_DATE_ENTERED_CONTRACTSENT", "PROPERTY_HS_TIME_IN_PRESENTATIONSCHEDULED", "PROPERTY_HS_DATE_ENTERED_CLOSEDWON", "PROPERTY_HS_TIME_IN_CONTRACTSENT", "PROPERTY_HS_NEXT_STEP", "PROPERTY_HS_MANUAL_FORECAST_CATEGORY", "PROPERTY_DEALNAME", "PROPERTY_CLOSEDATE", "PROPERTY_CREATEDATE", "DEAL_PIPELINE_STAGE_ID", "OWNER_ID", "PROPERTY_HS_UPDATED_BY_USER_ID", "PROPERTY_HS_CREATEDATE", "PROPERTY_HS_USER_IDS_OF_ALL_OWNERS", "PROPERTY_HS_ALL_OWNER_IDS", "DEAL_PIPELINE_ID", "PROPERTY_HUBSPOT_OWNER_ASSIGNEDDATE", "PROPERTY_PRODUCT_OF_INTEREST", "PROPERTY_AMOUNT", "PROPERTY_POINT_OF_CONTACT", "PROPERTY_DEALTYPE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")

