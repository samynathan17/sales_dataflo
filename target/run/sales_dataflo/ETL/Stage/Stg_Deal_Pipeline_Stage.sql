
        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Deal_Pipeline_Stage as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Deal_Pipeline_Stage__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.PIPELINE_STAGE_ID = DBT_INTERNAL_DEST.PIPELINE_STAGE_ID
        

    
    when matched then update set
        "PIPELINE_STAGE_ID" = DBT_INTERNAL_SOURCE."PIPELINE_STAGE_ID","SOURCE_STAGE_ID" = DBT_INTERNAL_SOURCE."SOURCE_STAGE_ID","PIPELINE_ID" = DBT_INTERNAL_SOURCE."PIPELINE_ID","LABEL" = DBT_INTERNAL_SOURCE."LABEL","PROBABILITY" = DBT_INTERNAL_SOURCE."PROBABILITY","ACTIVE" = DBT_INTERNAL_SOURCE."ACTIVE","DISPLAY_ORDER" = DBT_INTERNAL_SOURCE."DISPLAY_ORDER","CLOSED_WON" = DBT_INTERNAL_SOURCE."CLOSED_WON","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("PIPELINE_STAGE_ID", "SOURCE_STAGE_ID", "PIPELINE_ID", "LABEL", "PROBABILITY", "ACTIVE", "DISPLAY_ORDER", "CLOSED_WON", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("PIPELINE_STAGE_ID", "SOURCE_STAGE_ID", "PIPELINE_ID", "LABEL", "PROBABILITY", "ACTIVE", "DISPLAY_ORDER", "CLOSED_WON", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")

