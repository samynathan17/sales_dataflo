
        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Opportunity as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Opportunity__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.opportunity_id = DBT_INTERNAL_DEST.opportunity_id
        

    
    when matched then update set
        "OPPORTUNITY_ID" = DBT_INTERNAL_SOURCE."OPPORTUNITY_ID","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","IS_DELETED" = DBT_INTERNAL_SOURCE."IS_DELETED","ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","NAME" = DBT_INTERNAL_SOURCE."NAME","DESCRIPTION" = DBT_INTERNAL_SOURCE."DESCRIPTION","STAGE_NAME" = DBT_INTERNAL_SOURCE."STAGE_NAME","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","CLOSE_DATE" = DBT_INTERNAL_SOURCE."CLOSE_DATE","TYPE" = DBT_INTERNAL_SOURCE."TYPE","NEXT_STEP" = DBT_INTERNAL_SOURCE."NEXT_STEP","LEAD_SOURCE" = DBT_INTERNAL_SOURCE."LEAD_SOURCE","IS_CLOSED" = DBT_INTERNAL_SOURCE."IS_CLOSED","IS_WON" = DBT_INTERNAL_SOURCE."IS_WON","FORECAST_CATEGORY" = DBT_INTERNAL_SOURCE."FORECAST_CATEGORY","FORECAST_CATEGORY_NAME" = DBT_INTERNAL_SOURCE."FORECAST_CATEGORY_NAME","HAS_OPPORTUNITY_LINE_ITEM" = DBT_INTERNAL_SOURCE."HAS_OPPORTUNITY_LINE_ITEM","OWNER_ID" = DBT_INTERNAL_SOURCE."OWNER_ID","CREATED_DATE" = DBT_INTERNAL_SOURCE."CREATED_DATE","CREATED_BY_ID" = DBT_INTERNAL_SOURCE."CREATED_BY_ID","LAST_MODIFIED_DATE" = DBT_INTERNAL_SOURCE."LAST_MODIFIED_DATE","LAST_MODIFIED_BY_ID" = DBT_INTERNAL_SOURCE."LAST_MODIFIED_BY_ID","SYSTEM_MODSTAMP" = DBT_INTERNAL_SOURCE."SYSTEM_MODSTAMP","LAST_ACTIVITY_DATE" = DBT_INTERNAL_SOURCE."LAST_ACTIVITY_DATE","FISCAL_QUARTER" = DBT_INTERNAL_SOURCE."FISCAL_QUARTER","FISCAL_YEAR" = DBT_INTERNAL_SOURCE."FISCAL_YEAR","FISCAL" = DBT_INTERNAL_SOURCE."FISCAL","LAST_VIEWED_DATE" = DBT_INTERNAL_SOURCE."LAST_VIEWED_DATE","LAST_REFERENCED_DATE" = DBT_INTERNAL_SOURCE."LAST_REFERENCED_DATE","HAS_OPEN_ACTIVITY" = DBT_INTERNAL_SOURCE."HAS_OPEN_ACTIVITY","HAS_OVERDUE_TASK" = DBT_INTERNAL_SOURCE."HAS_OVERDUE_TASK","CONTACT_ID" = DBT_INTERNAL_SOURCE."CONTACT_ID","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("OPPORTUNITY_ID", "SOURCE_ID", "IS_DELETED", "ACCOUNT_ID", "NAME", "DESCRIPTION", "STAGE_NAME", "AMOUNT", "CLOSE_DATE", "TYPE", "NEXT_STEP", "LEAD_SOURCE", "IS_CLOSED", "IS_WON", "FORECAST_CATEGORY", "FORECAST_CATEGORY_NAME", "HAS_OPPORTUNITY_LINE_ITEM", "OWNER_ID", "CREATED_DATE", "CREATED_BY_ID", "LAST_MODIFIED_DATE", "LAST_MODIFIED_BY_ID", "SYSTEM_MODSTAMP", "LAST_ACTIVITY_DATE", "FISCAL_QUARTER", "FISCAL_YEAR", "FISCAL", "LAST_VIEWED_DATE", "LAST_REFERENCED_DATE", "HAS_OPEN_ACTIVITY", "HAS_OVERDUE_TASK", "CONTACT_ID", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("OPPORTUNITY_ID", "SOURCE_ID", "IS_DELETED", "ACCOUNT_ID", "NAME", "DESCRIPTION", "STAGE_NAME", "AMOUNT", "CLOSE_DATE", "TYPE", "NEXT_STEP", "LEAD_SOURCE", "IS_CLOSED", "IS_WON", "FORECAST_CATEGORY", "FORECAST_CATEGORY_NAME", "HAS_OPPORTUNITY_LINE_ITEM", "OWNER_ID", "CREATED_DATE", "CREATED_BY_ID", "LAST_MODIFIED_DATE", "LAST_MODIFIED_BY_ID", "SYSTEM_MODSTAMP", "LAST_ACTIVITY_DATE", "FISCAL_QUARTER", "FISCAL_YEAR", "FISCAL", "LAST_VIEWED_DATE", "LAST_REFERENCED_DATE", "HAS_OPEN_ACTIVITY", "HAS_OVERDUE_TASK", "CONTACT_ID", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")

