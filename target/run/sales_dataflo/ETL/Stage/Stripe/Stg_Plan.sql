
    delete from DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Plan
    where (PLAN_ID) in (
        select (PLAN_ID)
        from DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Plan__dbt_tmp
    );
    

    insert into DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Plan ("PLAN_ID", "SOURCE_ID", "ACTIVE", "AGGREGATE_USAGE", "AMOUNT", "BILLING_SCHEME", "CREATED", "CURRENCY", "INTERVAL", "INTERVAL_COUNT", "LIVEMODE", "NICKNAME", "TIERS_MODE", "TRANSFORM_USAGE_DIVIDE_BY", "TRANSFORM_USAGE_ROUND", "TRIAL_PERIOD_DAYS", "USAGE_TYPE", "IS_DELETED", "METADATA", "PRODUCT_ID", "_FIVETRAN_SYNCED", "ENTITY_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    (
        select "PLAN_ID", "SOURCE_ID", "ACTIVE", "AGGREGATE_USAGE", "AMOUNT", "BILLING_SCHEME", "CREATED", "CURRENCY", "INTERVAL", "INTERVAL_COUNT", "LIVEMODE", "NICKNAME", "TIERS_MODE", "TRANSFORM_USAGE_DIVIDE_BY", "TRANSFORM_USAGE_ROUND", "TRIAL_PERIOD_DAYS", "USAGE_TYPE", "IS_DELETED", "METADATA", "PRODUCT_ID", "_FIVETRAN_SYNCED", "ENTITY_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS"
        from DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Plan__dbt_tmp
    );
