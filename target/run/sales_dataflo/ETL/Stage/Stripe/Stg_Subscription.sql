
    delete from DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Subscription
    where (SUBSCRIPTION_ID) in (
        select (SUBSCRIPTION_ID)
        from DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Subscription__dbt_tmp
    );
    

    insert into DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Subscription ("SUBSCRIPTION_ID", "SOURCE_ID", "APPLICATION_FEE_PERCENT", "BILLING", "BILLING_CYCLE_ANCHOR", "BILLING_THRESHOLD_RESET_BILLING_CYCLE_ANCHOR", "BILLING_THRESHOLD_AMOUNT_GTE", "CANCEL_AT", "CANCEL_AT_PERIOD_END", "CANCELED_AT", "CREATED", "CURRENT_PERIOD_END", "CURRENT_PERIOD_START", "DAYS_UNTIL_DUE", "ENDED_AT", "LIVEMODE", "QUANTITY", "START_DATE", "STATUS", "TAX_PERCENT", "TRIAL_START", "TRIAL_END", "CUSTOMER_ID", "DEFAULT_SOURCE_ID", "METADATA", "_FIVETRAN_SYNCED", "ENTITY_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    (
        select "SUBSCRIPTION_ID", "SOURCE_ID", "APPLICATION_FEE_PERCENT", "BILLING", "BILLING_CYCLE_ANCHOR", "BILLING_THRESHOLD_RESET_BILLING_CYCLE_ANCHOR", "BILLING_THRESHOLD_AMOUNT_GTE", "CANCEL_AT", "CANCEL_AT_PERIOD_END", "CANCELED_AT", "CREATED", "CURRENT_PERIOD_END", "CURRENT_PERIOD_START", "DAYS_UNTIL_DUE", "ENDED_AT", "LIVEMODE", "QUANTITY", "START_DATE", "STATUS", "TAX_PERCENT", "TRIAL_START", "TRIAL_END", "CUSTOMER_ID", "DEFAULT_SOURCE_ID", "METADATA", "_FIVETRAN_SYNCED", "ENTITY_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS"
        from DATAFLOTEST_DATABASE.dbt_salesdataflo.Stg_Subscription__dbt_tmp
    );
