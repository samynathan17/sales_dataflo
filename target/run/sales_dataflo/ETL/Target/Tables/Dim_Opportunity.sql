
        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.opportunity_id = DBT_INTERNAL_DEST.opportunity_id
        

    
    when matched then update set
        "OPPORTUNITY_ID" = DBT_INTERNAL_SOURCE."OPPORTUNITY_ID","OPPORTUNITY_NAME" = DBT_INTERNAL_SOURCE."OPPORTUNITY_NAME","OPPORTUNITY_TYPE" = DBT_INTERNAL_SOURCE."OPPORTUNITY_TYPE","ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","EMPLOYEE_ID" = DBT_INTERNAL_SOURCE."EMPLOYEE_ID","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","STAGE_ID" = DBT_INTERNAL_SOURCE."STAGE_ID","IS_WON" = DBT_INTERNAL_SOURCE."IS_WON","IS_CLOSED" = DBT_INTERNAL_SOURCE."IS_CLOSED","STAGE_NAME" = DBT_INTERNAL_SOURCE."STAGE_NAME","FORECAST_CATEGORY" = DBT_INTERNAL_SOURCE."FORECAST_CATEGORY","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT","AMOUNT_WITHOUT_DISC" = DBT_INTERNAL_SOURCE."AMOUNT_WITHOUT_DISC","EXPECTD_CLOUSER_DT" = DBT_INTERNAL_SOURCE."EXPECTD_CLOUSER_DT","CONTACT_ID" = DBT_INTERNAL_SOURCE."CONTACT_ID","CONTACT_NAME" = DBT_INTERNAL_SOURCE."CONTACT_NAME","CONTACT_NUMBER" = DBT_INTERNAL_SOURCE."CONTACT_NUMBER","CONTACT_EMAIL" = DBT_INTERNAL_SOURCE."CONTACT_EMAIL","CONTACT_ADDRESS" = DBT_INTERNAL_SOURCE."CONTACT_ADDRESS","INITIAL_CREATE_DT" = DBT_INTERNAL_SOURCE."INITIAL_CREATE_DT","LAST_UPDATED_DT" = DBT_INTERNAL_SOURCE."LAST_UPDATED_DT","CLOSE_DATE" = DBT_INTERNAL_SOURCE."CLOSE_DATE","PROSPECT_DT" = DBT_INTERNAL_SOURCE."PROSPECT_DT","STAGE_CALC_ID" = DBT_INTERNAL_SOURCE."STAGE_CALC_ID","STAGE_START_DT" = DBT_INTERNAL_SOURCE."STAGE_START_DT","STAGE_END_DT" = DBT_INTERNAL_SOURCE."STAGE_END_DT","LEAD_LOST_REASON" = DBT_INTERNAL_SOURCE."LEAD_LOST_REASON","COMPETITOR" = DBT_INTERNAL_SOURCE."COMPETITOR","ON_HOLD_FLAG" = DBT_INTERNAL_SOURCE."ON_HOLD_FLAG","SUB_PRODUCT_ID" = DBT_INTERNAL_SOURCE."SUB_PRODUCT_ID","SUB_PRODUCT_NAME" = DBT_INTERNAL_SOURCE."SUB_PRODUCT_NAME","PRD_AMOUNT_WITHOUT_DISC" = DBT_INTERNAL_SOURCE."PRD_AMOUNT_WITHOUT_DISC","PRD_DISCOUNT" = DBT_INTERNAL_SOURCE."PRD_DISCOUNT","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","DW_CURR_FLG" = DBT_INTERNAL_SOURCE."DW_CURR_FLG","EFFCT_START_DATE" = DBT_INTERNAL_SOURCE."EFFCT_START_DATE","EFFCT_END_DATE" = DBT_INTERNAL_SOURCE."EFFCT_END_DATE","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("OPPORTUNITY_ID", "OPPORTUNITY_NAME", "OPPORTUNITY_TYPE", "ACCOUNT_ID", "EMPLOYEE_ID", "SOURCE_ID", "STAGE_ID", "IS_WON", "IS_CLOSED", "STAGE_NAME", "FORECAST_CATEGORY", "AMOUNT", "AMOUNT_WITHOUT_DISC", "EXPECTD_CLOUSER_DT", "CONTACT_ID", "CONTACT_NAME", "CONTACT_NUMBER", "CONTACT_EMAIL", "CONTACT_ADDRESS", "INITIAL_CREATE_DT", "LAST_UPDATED_DT", "CLOSE_DATE", "PROSPECT_DT", "STAGE_CALC_ID", "STAGE_START_DT", "STAGE_END_DT", "LEAD_LOST_REASON", "COMPETITOR", "ON_HOLD_FLAG", "SUB_PRODUCT_ID", "SUB_PRODUCT_NAME", "PRD_AMOUNT_WITHOUT_DISC", "PRD_DISCOUNT", "ACTIVE_FLAG", "DW_CURR_FLG", "EFFCT_START_DATE", "EFFCT_END_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("OPPORTUNITY_ID", "OPPORTUNITY_NAME", "OPPORTUNITY_TYPE", "ACCOUNT_ID", "EMPLOYEE_ID", "SOURCE_ID", "STAGE_ID", "IS_WON", "IS_CLOSED", "STAGE_NAME", "FORECAST_CATEGORY", "AMOUNT", "AMOUNT_WITHOUT_DISC", "EXPECTD_CLOUSER_DT", "CONTACT_ID", "CONTACT_NAME", "CONTACT_NUMBER", "CONTACT_EMAIL", "CONTACT_ADDRESS", "INITIAL_CREATE_DT", "LAST_UPDATED_DT", "CLOSE_DATE", "PROSPECT_DT", "STAGE_CALC_ID", "STAGE_START_DT", "STAGE_END_DT", "LEAD_LOST_REASON", "COMPETITOR", "ON_HOLD_FLAG", "SUB_PRODUCT_ID", "SUB_PRODUCT_NAME", "PRD_AMOUNT_WITHOUT_DISC", "PRD_DISCOUNT", "ACTIVE_FLAG", "DW_CURR_FLG", "EFFCT_START_DATE", "EFFCT_END_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")

