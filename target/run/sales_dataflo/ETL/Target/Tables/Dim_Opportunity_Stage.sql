
        
        
    

    

    merge into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage as DBT_INTERNAL_DEST
        using DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity_Stage__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.Stage_id = DBT_INTERNAL_DEST.Stage_id
        

    
    when matched then update set
        "STAGE_ID" = DBT_INTERNAL_SOURCE."STAGE_ID","STAGE_NAME" = DBT_INTERNAL_SOURCE."STAGE_NAME","STAGE_POSITION" = DBT_INTERNAL_SOURCE."STAGE_POSITION","ACCOUNT_ID" = DBT_INTERNAL_SOURCE."ACCOUNT_ID","ACTIVE_FLAG" = DBT_INTERNAL_SOURCE."ACTIVE_FLAG","SOURCE_ID" = DBT_INTERNAL_SOURCE."SOURCE_ID","FORECAST_CATEGORY" = DBT_INTERNAL_SOURCE."FORECAST_CATEGORY","LEAD_OPP_FLAG" = DBT_INTERNAL_SOURCE."LEAD_OPP_FLAG","IS_CLOSED" = DBT_INTERNAL_SOURCE."IS_CLOSED","IS_WON" = DBT_INTERNAL_SOURCE."IS_WON","OPPORTUNITY_STAGE" = DBT_INTERNAL_SOURCE."OPPORTUNITY_STAGE","SOURCE_TYPE" = DBT_INTERNAL_SOURCE."SOURCE_TYPE","DW_SESSION_NM" = DBT_INTERNAL_SOURCE."DW_SESSION_NM","DW_INS_UPD_DTS" = DBT_INTERNAL_SOURCE."DW_INS_UPD_DTS"
    

    when not matched then insert
        ("STAGE_ID", "STAGE_NAME", "STAGE_POSITION", "ACCOUNT_ID", "ACTIVE_FLAG", "SOURCE_ID", "FORECAST_CATEGORY", "LEAD_OPP_FLAG", "IS_CLOSED", "IS_WON", "OPPORTUNITY_STAGE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    values
        ("STAGE_ID", "STAGE_NAME", "STAGE_POSITION", "ACCOUNT_ID", "ACTIVE_FLAG", "SOURCE_ID", "FORECAST_CATEGORY", "LEAD_OPP_FLAG", "IS_CLOSED", "IS_WON", "OPPORTUNITY_STAGE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")

