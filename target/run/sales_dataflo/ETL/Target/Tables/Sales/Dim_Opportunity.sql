
    delete from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity
    where (opportunity_id) in (
        select (opportunity_id)
        from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity__dbt_tmp
    );
    

    insert into DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity ("OPPORTUNITY_ID", "OPPORTUNITY_NAME", "OPPORTUNITY_TYPE", "ACCOUNT_ID", "EMPLOYEE_ID", "SOURCE_ID", "STAGE_ID", "IS_WON", "IS_CLOSED", "STAGE_NAME", "FORECAST_CATEGORY", "AMOUNT", "TRANSACTIONAL_CURRENCY", "EXCH_RATE", "REPORTING_CURRENCY", "AMOUNT_WITHOUT_DISC", "EXPECTD_CLOUSER_DT", "CONTACT_ID", "CONTACT_NAME", "CONTACT_NUMBER", "CONTACT_EMAIL", "CONTACT_ADDRESS", "INITIAL_CREATE_DT", "LAST_UPDATED_DT", "CLOSE_DATE", "PROSPECT_DT", "STAGE_CALC_ID", "STAGE_START_DT", "STAGE_END_DT", "LEAD_LOST_REASON", "COMPETITOR", "ON_HOLD_FLAG", "SUB_PRODUCT_ID", "SUB_PRODUCT_NAME", "PRD_AMOUNT_WITHOUT_DISC", "PRD_DISCOUNT", "ACTIVE_FLAG", "DW_CURR_FLG", "EFFCT_START_DATE", "EFFCT_END_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS")
    (
        select "OPPORTUNITY_ID", "OPPORTUNITY_NAME", "OPPORTUNITY_TYPE", "ACCOUNT_ID", "EMPLOYEE_ID", "SOURCE_ID", "STAGE_ID", "IS_WON", "IS_CLOSED", "STAGE_NAME", "FORECAST_CATEGORY", "AMOUNT", "TRANSACTIONAL_CURRENCY", "EXCH_RATE", "REPORTING_CURRENCY", "AMOUNT_WITHOUT_DISC", "EXPECTD_CLOUSER_DT", "CONTACT_ID", "CONTACT_NAME", "CONTACT_NUMBER", "CONTACT_EMAIL", "CONTACT_ADDRESS", "INITIAL_CREATE_DT", "LAST_UPDATED_DT", "CLOSE_DATE", "PROSPECT_DT", "STAGE_CALC_ID", "STAGE_START_DT", "STAGE_END_DT", "LEAD_LOST_REASON", "COMPETITOR", "ON_HOLD_FLAG", "SUB_PRODUCT_ID", "SUB_PRODUCT_NAME", "PRD_AMOUNT_WITHOUT_DISC", "PRD_DISCOUNT", "ACTIVE_FLAG", "DW_CURR_FLG", "EFFCT_START_DATE", "EFFCT_END_DATE", "SOURCE_TYPE", "DW_SESSION_NM", "DW_INS_UPD_DTS"
        from DATAFLOTEST_DATABASE.dbt_salesdataflo.Dim_Opportunity__dbt_tmp
    );
